## 矩阵分解

**矩阵的满秩分解**

设 $A\in \mathbb {C}_r^{m\times n}$，则存在 $B\in \mathbb {C}_r^{m\times r}, C\in \mathbb {C}_r^{r\times n}$，满足

$$
A = BC
$$

> $\mathbb {C}_r$ 表示矩阵的秩为 $r$

实际上上述定理用文字描述就是，一个亏秩的矩阵可以分解成一个列满秩与行满秩矩阵的乘积

**证明：**因为 $\mathrm {rank}(A)=r$，所以一定可以找到与 $A$ 相似的一个矩阵

$$
A \simeq \begin{bmatrix}E_r&0_{r\times (n-r)}\\0_{(m-r)\times r}&0_{(m-r)\times (n-r)}\end{bmatrix}=\begin{bmatrix}E_r\\0_{(m-r)\times r}\end{bmatrix}\begin{bmatrix}E_r&0_{r\times (n-r)}\end{bmatrix}
$$

因此存在两个可逆矩阵 $P,Q$，使 $PAQ=\begin {bmatrix} E_r&0\\0&0\end {bmatrix}$，则

$$
\begin{aligned}
A &= P^{-1}\begin{bmatrix}E_r\\0\end{bmatrix}\begin{bmatrix}E_r&0\end{bmatrix}Q^{-1}\\
&\triangleq BC
\end{aligned}
$$

因为 $P^{-1}$ 是可逆矩阵，$\begin {bmatrix} E_r\\0\end {bmatrix}$ 是一个列满秩矩阵，所以 $B=P^{-1}\begin {bmatrix} E_r\\0\end {bmatrix}$ 仍是一个列满秩矩阵；同理，$C=\begin {bmatrix} E_r&0\end {bmatrix} Q^{-1}$ 是一个行满秩矩阵

**矩阵满秩分解的计算**

如何在给定矩阵 $A$ 的情况下，求出矩阵 $B,C$ 呢？

设

$$
A = [\alpha_1,\alpha_2,...,\alpha_n]\\
B = [\beta_1,\beta_2,...,\beta_r], 其中 \beta_1,...,\beta_r 线性无关
$$

所以

$$
\begin{aligned}
&A=BC\\
&\Rightarrow[\alpha_1,\alpha_2,...,\alpha_n]=[\beta_1,...,\beta_r]\begin{bmatrix}c_{11}&\cdots &c_{1n}\\\vdots &\ddots&\vdots\\c_{r1}&\cdots &c_{rn}\end{bmatrix}
\end{aligned}
$$

实际上我们可以取 $\beta_1,...,\beta_r$ 为 $\alpha_1,...,\alpha_n$ 的一个极大线性无关组，因此 $B$ 就是矩阵 $A$ 列向量组的一个极大线性无关组，$C$ 就是用该线性无关组去表示 $A$ 时的系数

___

例 1

求矩阵 $A=\begin {bmatrix} 1&4&-1&5&6\\2&0&0&0&-14\\-1&2&-4&0&1\\2&6&-5&5&-7\end {bmatrix}$ 的满秩分解

**解：**对矩阵 $A$ 只作初等行变换

$$
A=\begin{bmatrix}1&4&-1&5&6\\2&0&0&0&-14\\-1&2&-4&0&1\\2&6&-5&5&-7\end{bmatrix}\to ···\to\begin{bmatrix}1&0&0&0&-7\\0&1&0&\frac{10}{7}&\frac{29}{7}\\0&0&1&\frac{5}{7}&\frac{25}{7}\\0&0&0&0&0\end{bmatrix}
$$

$A$ 的秩为 3，且前三个列向量线性无关，故

$$
B = \begin{bmatrix}1&4&-1\\2&0&0\\-1&2&-4\\2&6&-5\end{bmatrix}，C=\begin{bmatrix}1&0&0&0&-7\\0&1&0&\frac{10}{7}&\frac{29}{7}\\0&0&1&\frac{5}{7}&\frac{25}{7}\end{bmatrix}
$$

___

例 2

求矩阵 $A=\begin {bmatrix} 2&1&-2&3&1\\2&5&-1&4&1\\1&3&-1&2&1\end {bmatrix}$ 的满秩分解

**解：**对矩阵 $A$ 只作初等行变换

$$
A=\begin{bmatrix}2&1&-2&3&1\\2&5&-1&4&1\\1&3&-1&2&1\end{bmatrix}\to ···\to \begin{bmatrix}1&0&0&\frac{8}{5}&-\frac{2}{5}\\0&1&0&\frac{1}{5}&\frac{1}{5}\\0&0&1&\frac{1}{5}&-\frac{4}{5}\end{bmatrix}
$$

$A$ 的秩为 3，且前三个列向量线性无关，故

$$
B = \begin{bmatrix}2&1&-2\\2&5&-1\\1&3&-1\end{bmatrix},C = \begin{bmatrix}1&0&0&\frac{8}{5}&-\frac{2}{5}\\0&1&0&\frac{1}{5}&\frac{1}{5}\\0&0&1&\frac{1}{5}&-\frac{4}{5}\end{bmatrix}
$$

___

**QR 分解的应用**

QR 分解的内容请看[酉矩阵、正交矩阵](#酉矩阵、正交矩阵)

请用 $QR$ 分解的方法解方程组 $Ax=b$，实际上 $A$ 可逆的情况下，$x=A^{-1} b$，但是由于直接求 $A^{-1}$ 过于复杂或者当 $A$ 不可逆时，我们可以利用 QR 分解，将其转换为求 $QRx=b$，于是就是求

$$
\begin{cases}
Qy=b\\
Rx=y
\end{cases}
$$

因为 $Q$ 是酉矩阵，所以 $Q^{-1}=Q^H$，因此 $y=Q^Hb$

由于 $R$ 是正线上三角矩阵，不妨设 $R = \begin {bmatrix} r_{11}&\cdots \\&r_{22}&\cdots \\&&\ddots\\&&&r_{nn}\end {bmatrix}$，则有

$$
\begin{bmatrix}r_{11}&\cdots \\&r_{22}&\cdots \\&&\ddots\\&&&r_{nn}\end{bmatrix}\begin{bmatrix}x_1\\\vdots \\x_n\end{bmatrix}=\begin{bmatrix}y_1\\\vdots \\y_n\end{bmatrix}\\
\Rightarrow \begin{cases}x_n=\frac{y_n}{r_{nn}}\\x_{n-1}=\frac{y_{n-1}-r_{nn}x_n}{r_{n-1,n-1}}\\\vdots\end{cases}
$$

___

例 3

用 $QR$ 分解的方法解方程组 $Ax=b$，其中 $A=\begin {bmatrix}-3&1&2\\1&1&1\\1&-1&0\\1&-1&1\end {bmatrix},b=\begin {bmatrix} 1\\0\\-2\\1\end {bmatrix}$

**解：**将 $A=(\alpha_1,\alpha_2,\alpha_3)$ 的列向量 $\alpha_1,\alpha_2,\alpha_3$ 用 Schmidt 方法标准正交化得

$$
\begin{aligned}
v_1 &= (-\frac{3}{\sqrt{12}},\frac{1}{\sqrt{12}},\frac{1}{\sqrt{12}},\frac{1}{\sqrt{12}})^T\\
v_2&=(0,\frac{2}{\sqrt{6}},-\frac{1}{\sqrt{6}},-\frac{1}{\sqrt{6}})^T\\
v_3&=(0,0,-\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}})^T
\end{aligned}
$$

令 $Q=(v_1,v_2,v_3)$，则

$$
\begin{aligned}
&R=Q^HA=\begin{bmatrix}2\sqrt{3}&-\frac{2}{3}&\frac{4}{\sqrt{3}}\\0&\frac{4}{\sqrt{6}}&\frac{1}{\sqrt{6}}\\0&0&\frac{1}{\sqrt{2}}\end{bmatrix}\\
&R^{-1}=\begin{bmatrix}\frac{\sqrt{3}}{6} & \frac{\sqrt{6}}{12} & -\frac{3 \sqrt{2}}{4} \\
0 & \frac{\sqrt{6}}{4} & -\frac{\sqrt{2}}{4} \\
0 & 0 & \sqrt{2}\end{bmatrix}
\end{aligned}
$$

所以

$$
x = R^{-1}Q^Hb=\begin{bmatrix}-\frac{1}{4} & \frac{1}{4} & \frac{3}{4} & -\frac{3}{4} \\
0 & \frac{1}{2} & 0 & -\frac{1}{2} \\
0 & 0 & -1 & 1\end{bmatrix}\begin{bmatrix}
1 \\
0 \\
-2 \\
1
\end{bmatrix}=\begin{bmatrix}
-\frac{5}{2} \\
-\frac{1}{2} \\
3
\end{bmatrix}
$$

___

**矩阵的 LU 分解**

LU 分解（LU Decomposition）是矩阵分解的一种，可以将一个矩阵分解为一个单位下三角矩阵和一个上三角矩阵的乘积，以四阶矩阵为例

$$
L = \begin{bmatrix}1&0&0&0\\*&1&0&0\\*&*&1&0\\*&*&*&1\end{bmatrix}, U=\begin{bmatrix}*&*&*&*\\0&*&*&*\\0&0&*&*\\0&0&0&*\end{bmatrix}
$$

LU 矩阵是否一定存在？答案是否，具体看下面的例子

设 $\begin {bmatrix} 0&1\\1&0\end {bmatrix}=\begin {bmatrix} a&0\\b&c\end {bmatrix}\begin {bmatrix} l&m\\0&n\end {bmatrix}$，则应该满足如下 4 个式子

$$
\begin{cases}
al=0\\
am=1\\
bl=1\\
bm+cn=0
\end{cases}
$$

由 $al=0$ 得 $a=0$ 或 $l=0$，但实际上这两种情况带入上面的式子都会推出矛盾，因此不是所有情况 LU 分解都存在

**LU 分解定理：**设 $A\in \mathbb {C}_n^{n\times n}$，$A$ 有唯一的 LU 分解 $\Leftrightarrow A$ 的各阶顺序主子式 $\Delta k \neq 0,\ k=1,2...,n$

> $k$ 阶顺序主子式指的是矩阵左上角 $k\times k$ 个元素组成的行列式

将矩阵 $A$ 分解为 $L$ 和 $U$ 之后，解方程组 $Ax=b$ 就变得简单了，因为 $A=LU$，所以 $(LU) x=b\Rightarrow L (Ux)=b\Rightarrow \begin {cases} Ly=b\\Ux=y\end {cases}$

所以 $x=U^{-1} y=U^{-1} L^{-1} b$

**LU 矩阵的求法**

实际上 LU 矩阵有非常多的求法，这里我举一种比较简单的待定系数法

设 $A = \begin {bmatrix} 2&3&4\\1&1&9\\1&2&-6\end {bmatrix}$，求矩阵 $A$ 的 LU 分解矩阵 $L$ 和 $U$

**解：**令

$$
L=\begin{bmatrix}1&0&0\\l_1&1&0\\l_2&l_3&1\end{bmatrix},U = \begin{bmatrix}u_1&u_2&u_3\\0&u_4&u_5\\0&0&u_6\end{bmatrix}
$$

由于 $A=LU$，所以有

$$
\begin{cases}
u_1=2\\
u_2=3\\
u_3=4\\
l_1u_1=1\\
l_1u_2+u_4=1\\
l_1u_3+u_5=9\\
l_2u_1=1\\
l_2u_2+l_3u_4=2\\
l_2u_3+l_3u_5+u_6=-6
\end{cases}
$$

上面的方程组非常容易解，最后求出

$$
L = \begin{bmatrix}1&0&0\\\frac{1}{2}&1&0\\\frac{1}{2}&-1&1\end{bmatrix},U=\begin{bmatrix}2&3&4\\0&-\frac{1}{2}&7\\0&0&-1\end{bmatrix}
$$

___

**矩阵的 SVD 分解**

**SVD 分解定理：**设 $A\in \mathbb {C}_r^{m\times n}$，则

1.  对 $\mathrm {rank}(A)=r$ 的矩阵 $A$，矩阵 $A^HA$ 的**非零特征值**有 $\lambda_1 \geqslant \lambda_2 \geqslant・・・\geqslant \lambda_r >0$，则称**正数** $\sigma_i = \sqrt {\lambda_i}$ 为矩阵 $A$ 的奇异值
2.  存在酉矩阵 $U,V$ 使 $U^{-1} AV = \Sigma = \left [ \begin {array}{c c c|c} \sigma_1\\ &\ddots \\&& \sigma_n& 0 \\ \hline  0&&& 0 \end {array} \right]_{m\times n}$，其中 $\sigma_1≥\sigma_2≥・・・≥\sigma_r>0$

**SVD 分解的求法**

1.  由特征多项式 $|\lambda E - A^HA| = 0$ 求得特征值 $\lambda_1 \geqslant \lambda_2 \geqslant .. \geqslant \lambda_n$（**务必按照从大到小排列**），以及每个特征值对应的特征向量 $(\alpha_1, \alpha_2, ..., \alpha_n)$

-   对特征向量进行施密特正交化和单位化，得到单位正交向量组 $V = (v_1, v_2, ..,v_n)$
-   对于非零特征值 $\lambda_1, ..., \lambda_r$ 对应奇异值 $\sigma_1, ... , \sigma_r$，于是有 **${\color{red} {u_i = \frac{1}{\sigma_i}Av_i}}$**，这样得到了 $r$ 个列向量，剩余的 $u_{r+1},...,u_{n}$ 通过方程 $u_i^T x = 0$ 求得（$u_i$ 必须是标准正交的）
-   于是得到 $A=U \Sigma V^H$

> 实际上 $A^HA$ 是一个**半正定矩阵**，其特征值一定**非负**

___

例 4

已知 $A = \begin {bmatrix} 1&2\\0&0\\0&0\end {bmatrix}$，求 $A$ 的奇异值

**解：**因为 $A^HA=\begin {bmatrix} 5&0&0\\0&0&0\\0&0&0\end {bmatrix}$，$A^HA$ 的特征值为 $5,0,0$，故 $A$ 的奇异值为 $\sqrt {5}$

___

例 5

已知 $A = \begin {bmatrix} 1&1\\0&0\\1&1\end {bmatrix}$，求 $A$ 的 SVD 分解矩阵 $U$ 和 $V$

**解：**$A^HA = \begin {bmatrix} 2&2\\2&2\end {bmatrix}$，求得 $A^HA$ 的特征值为 $\lambda_1=4,\lambda_2=0$，且对应的特征向量分别为 $\alpha_1=\begin {bmatrix} 1,1\end {bmatrix}^T,\alpha_2=[-1,1]^T$，将其单位正交化后得

$$
\begin{aligned}
v_1&=\begin{bmatrix}\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}\end{bmatrix}^T\\
v_2&=\begin{bmatrix}-\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}\end{bmatrix}^T
\end{aligned}
$$

于是有

$$
V = \begin{bmatrix}\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}}&\frac{1}{\sqrt{2}}\end{bmatrix}
$$

因为 $u_1=\frac {1}{2} Av_1=\begin {bmatrix}\frac {1}{\sqrt {2}}\\0\\\frac {1}{\sqrt {2}}\end {bmatrix}$，解方程组 $u_1^Tx=0$ 得

$$
\begin{aligned}
x_1 &= u_2 = \begin{bmatrix}\frac{1}{\sqrt{2}}\\0\\-\frac{1}{\sqrt{2}}\end{bmatrix}\\
x_2 &= u_3 = \begin{bmatrix}0\\1\\0\end{bmatrix}
\end{aligned}
$$

故

$$
U = \begin{bmatrix}\frac{1}{\sqrt{2}}&\frac{1}{\sqrt{2}}&0\\0&0&1\\\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{2}}&0\end{bmatrix}
$$

验算可得 $U^{-1} AV=\Sigma$

___

例 6

求 $A=\begin {bmatrix} 1&1&1\\1&1&1\end {bmatrix}$ 的奇异值分解

**解：**$A^HA = \begin {bmatrix} 2&2&2\\2&2&2\\2&2&2\end {bmatrix}$，求得 $A^HA$ 的特征值为 $\lambda_1=6,\lambda_2=\lambda_3=0$，且对应的特征向量分别为 $\alpha_1=\begin {bmatrix} 1,1,1\end {bmatrix}^T,\alpha_2=[1, 0,-1]^T,\alpha_3 = [0,1,-1]^T$，将其单位正交化后得

$$
\begin{aligned}
v_1&=\begin{bmatrix}\frac{1}{\sqrt{3}},\frac{1}{\sqrt{3}}, \frac{1}{\sqrt{3}}\end{bmatrix}^T\\
v_2&=\begin{bmatrix}\frac{1}{\sqrt{2}},0,-\frac{1}{\sqrt{2}}\end{bmatrix}^T\\
v_3&=\begin{bmatrix}-\frac{1}{\sqrt{6}}, \frac{\sqrt{6}}{3},-\frac{1}{\sqrt{6}}\end{bmatrix}^T
\end{aligned}
$$

于是有

$$
V = \begin{bmatrix}\frac{1}{\sqrt{3}}&\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{6}}\\\frac{1}{\sqrt{3}}&0&\frac{\sqrt{6}}{3}\\\frac{1}{\sqrt{3}}&-\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{6}}\end{bmatrix}
$$

因为 $u_1=\frac {1}{\sqrt {6}} Av_1=\begin {bmatrix}\frac {1}{\sqrt {2}}\\\frac {1}{\sqrt {2}}\end {bmatrix}$，解方程组 $u_1^Tx=0$ 得

$$
\begin{aligned}
x_1 &= u_2 = \begin{bmatrix}\frac{1}{\sqrt{2}}\\-\frac{1}{\sqrt{2}}\end{bmatrix}\\
\end{aligned}
$$

故

$$
U = \begin{bmatrix}\frac{1}{\sqrt{2}}&\frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{2}}\end{bmatrix}
$$

验算可得 $U^{-1} AV=\Sigma$

## 矩阵的广义逆

**矩阵的广义逆**

若 $A\in \mathbb {C}^{n\times n}$，且 $A$ 为可逆矩阵，则有

1.  $AA^{-1}A=A$
2.  $A^{-1}AA^{-1}=A^{-1}$
3.  $(AA^{-1})^H=AA^{-1}$
4.  $(A^{-1}A)^H=A^{-1}A$

若 $A\in \mathbb {C}^{m\times n}, X\in \mathbb {C}^{m\times m}$，以下矩阵方程称为 Penrose 方程

1.  $AXA=A$
2.  $XAX=X$
3.  $(AX)^H=AX$
4.  $(XA)^H=XA$

满足 Penrose 方程中一个或多个的 $X\in \mathbb {C}^{n\times m}$ 称为 $A$ 的**一种**广义逆矩阵。最广泛的广义逆矩阵有以下两个

-   仅满足条件 $1$ 的广义逆矩阵称为减号逆，记为 $A^{-}$
-   满足条件 $1,2,3,4$ 的广义逆矩阵称为加号逆，记为 $A^+$

___

**矩阵的减号逆**

**（减号逆存在性定理）**$A\in \mathbb {C}^{m\times n}$，矩阵方程 $AXA=A$ 恒有解，并且称 $X$ 是 $A$ 的一个减号逆

**证明：**设 $\mathrm {rank}(A)=r≤\min (m,n)$，存在可逆矩阵 $P,Q$ 使得

$$
A = P\begin{bmatrix}E_r&0\\0&0\end{bmatrix}Q
$$

取 $X = Q^{-1}\begin {bmatrix} E_r&B_{r\times (n-r)}\\C_{(m-r)\times r}&D_{(m-r)\times (n-r)}\end {bmatrix} P^{-1}$，$B,C,D$ 为**任意**的满足分块要求的矩阵，则

$$
\begin{aligned}
AX A &= P\begin{bmatrix}E_r&0\\0&0\end{bmatrix}QQ^{-1}\begin{bmatrix}E_r&B\\C&D\end{bmatrix}P^{-1}P\begin{bmatrix}E_r&0\\0&0\end{bmatrix}Q\\
&=P\begin{bmatrix}E_r&0\\0&0\end{bmatrix}Q\\
&=A
\end{aligned}
$$

很明显，减号逆是不唯一的

**$A^{-}$ 的求法**

对 $\mathrm {rank}(A)=r$ 的矩阵 $A$，做增广矩阵 $\begin {bmatrix} A & E_m\\ E_n & 0 \end {bmatrix}$ 进行初等变换将 $A$ 化为最简形，得到 $\left [\begin {array}{rr|rr} E_r& 0  & P  \\ 0 & 0 & \\ \hline \\ Q &  & 0 &\end {array}\right]$，则有 $X = Q\begin {bmatrix} E_r&B\\C&D\end {bmatrix} P$，其中 $B,C,D$ 是满足固定阶次的任意矩阵

___

例 1

求矩阵 $A= \begin {bmatrix} 0&-1&3&0\\2&-4&1&5\\-4&5&7&-10\end {bmatrix}$ 的减号逆

**解：**

$$
\begin{aligned}
\left[\begin{array}{c|c}
A & E_{m} \\ \hline
E_{n} & 0
\end{array}\right]&=\left[\begin{array}{rrrr|rrr}
0 & -1 & 3 & 0 & 1 & 0 & 0 \\ 
2 & -4 & 1 & 5 & 0 & 1 & 0 \\
-4 & 5 & 7 & -10 & 0 & 0 & 1 \\ \hline
1 & 0 & 0 & 0 & & \\
0 & 1 & 0 & 0 & & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 & &
\end{array}\right]\\
&\to \left[\begin{array}{cccc|ccc}
1 & 0 & 0 & 0 & -2 & \frac{1}{2} & 0 \\
0 & 1 & 0 & 0 & -1 & 0 & 0 \\
0 & 0 & 0 & 0 & -3 & 2 & 1 \\ \hline
1 & 0 & \frac{11}{2} & -\frac{5}{2} & & \\
0 & 1 & 3 & 0 & 0 & \\
0 & 0 & 1 & 0 & & \\
0 & 0 & 0 & 1 & &
\end{array}\right]
\end{aligned}
$$

于是

$$
{P}=\left[\begin{array}{ccc}
-2 & \frac{1}{2} & 0 \\
-1 & 0 & 0 \\
-3 & 2 & 1
\end{array}\right], \quad {Q}=\begin{bmatrix}
1 & 0 & \frac{11}{2} & -\frac{5}{2} \\
0 & 1 & 3 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

所以

$$
A^-=Q\begin{bmatrix}E_2&B\\C&D\end{bmatrix}P
$$

其中 $B\in \mathbb {C}^{2\times 1}, C\in \mathbb {C}^{2\times 2},D\in \mathbb {C}^{2\times 1}$

___

例 2

求矩阵 $A=\begin {bmatrix} 2\mathrm {i}&\mathrm {i}&0\\0&0&-3\\2&1&1\end {bmatrix}$ 的减号逆矩阵通式

**解：**

$$
\begin{aligned}
\left[\begin{array}{c|c}
A & E_{m} \\ \hline
E_{n} & 0
\end{array}\right]&=\left[\begin{array}{rrr|rrr}
2\mathrm{i} & \mathrm{i} & 0&1&0&0 \\ 
0&0&-3&0&1&0 \\
2&1&1 &0&0&1\\ \hline
1 & 0 & 0  & & \\
0 & 1 & 0 & & 0 \\
0 & 0 & 1
\end{array}\right]\\
&\to \left[\begin{array}{rrr|rrr}
1 & 0 & 0&1&0&0 \\ 
0&1&0&0&1&0 \\
0&0&0 &\mathrm{i}&\frac{1}{3}&1\\ \hline
-\frac{1}{2}\mathrm{i} & 0&-\frac{1}{2}  & & \\
0 & 0 & 1 & & 0 \\
0 & -\frac{1}{3} & 0
\end{array}\right]
\end{aligned}
$$

于是

$$
{P}=\left[\begin{array}{ccc}
1 & 0 & 0 \\
0 & 1 & 0 \\
\mathrm{i}&\frac{1}{3}&1
\end{array}\right], \quad {Q}=\begin{bmatrix}
-\frac{1}{2}\mathrm{i} & 0&-\frac{1}{2} \\
0 & 0 & 1 \\
0 & -\frac{1}{3} & 0
\end{bmatrix}
$$

所以

$$
A^-=Q\begin{bmatrix}E_2&B\\C&D\end{bmatrix}P
$$

其中 $B\in \mathbb {C}^{2\times 1}, C\in \mathbb {C}^{2\times 2},D\in \mathbb {C}^{2\times 1}$

___

**非齐次线性方程组的相容性**

**（定理）**$A\in \mathbb {C}^{n\times n},Ax=b$ 有解 $\Leftrightarrow b=AA^-b$

**非齐次线性方程组解的结构**

**（定理）**$A\in \mathbb {C}^{m\times n}$，若 $Ax=b$ 有解，则通解为

$$
x=A^{+}b+(E_n-A^+A)t
$$

其中 $t\in \mathbb {C}^{n}$。若相容，则上式为通解；若不相容，则上式为最小二乘的通解

___

**矩阵的左逆、右逆**

设 $A \in \mathbb {C}^{m \times n}, B \in \mathbb {C}^{n \times m}$，若有 $BA=E_n$，则称 $B$ 是 $A$ 的一个**左逆**，记为 $A_L^{-1}$

> 等价条件：

-   $A$ 的零空间 $N (A)={0}$
-   $m \geqslant n, \; \mathrm {rank}(A)= n$，即 $A$ 是**列满秩的**
-   $A^H A$ 可逆

设 $A \in \mathbb {C}^{m \times n}, C \in \mathbb {C}^{n \times m}$，有 $AC = E_m$，则称 $C$ 是 $A$ 的一个**右逆**，记为 $A_R^{-1}$

> 等价条件：

-   $A$ 的列空间 $R (A)=C^m$
-   $m \leqslant n, \; \mathrm {rank}(A)=m$，即 $A$ 是**行满秩的**
-   $AA^H$ 可逆

___

**矩阵的加号逆**

**定义：**对于矩阵 $A \in \mathbb {C}^{m \times n}$，$A=BC$ 是 $A$ 的一个**满秩分解**，则

$$
A^+ = \underbrace{C^H(CC^H)^{-1}}_{C_R^{-1}}\underbrace{(B^HB)^{-1}B^H}_{B_L^{-1}}
$$

是 $A$ 的加号逆，且加号逆唯一

**性质：**

-   $\mathrm{rank}(A) = \mathrm{rank}(A^+)$
-   $\mathrm{rank}(A^+A) = \mathrm{rank}(AA^+) = \mathrm{rank}(A)$

**$A^+$ 的求法**

实际上加号逆的定义就是一个求法，另外还可以通过 SVD 分解进行求解：

对矩阵 $A$ 进行**奇异值分解**，得到 $A = U \begin {bmatrix}\Delta &0 \\ 0 & 0\end {bmatrix} V^H$，则 **$\color{red}{A^+ = V \begin{bmatrix}\Delta^{-1} & 0\\ 0 & 0\end{bmatrix}U^H}$**

___

例 2

分别求矩阵 $A=\left [\begin {array}{lllll} 1 & 1 & 0 & 1 & 0 \\0 & 1 & 1 & 1 & 1 \\1 & 0 & 1 & 1 & 0\end {array}\right],B = \begin {bmatrix} 0&1&0&1\\0&1&0&1\\2&0&1&1\end {bmatrix}$ 的加号逆

**解：**

对矩阵 $A$ 只作初等行变换

$$
A=\left[\begin{array}{lllll}
1 & 1 & 0 & 1 & 0 \\
0 & 1 & 1 & 1 & 1 \\
1 & 0 & 1 & 1 & 0
\end{array}\right]\to ···\to \begin{bmatrix}1&0&0&\frac{1}{2}&-\frac{1}{2}\\0&1&0&\frac{1}{2}&\frac{1}{2}\\0&0&1&\frac{1}{2}&\frac{1}{2}\end{bmatrix}
$$

故可将 $A$ 进行满秩分解为 $A=CD$，且

$$
C = \begin{bmatrix}1&1&0\\0&1&1\\1&0&1\end{bmatrix},D = \begin{bmatrix}1&0&0&\frac{1}{2}&-\frac{1}{2}\\0&1&0&\frac{1}{2}&\frac{1}{2}\\0&0&1&\frac{1}{2}&\frac{1}{2}\end{bmatrix}
$$

则

$$
A^+=\begin{bmatrix}\frac{1}{3}&-\frac{1}{3}&\frac{1}{3}\\\frac{1}{2}&\frac{1}{4}&-\frac{1}{2}\\-\frac{1}{2}&\frac{1}{4}&\frac{1}{2}\\\frac{1}{6}&\frac{1}{12}&\frac{1}{6}\\-\frac{1}{6}&\frac{5}{12}&-\frac{1}{6}\end{bmatrix}
$$

对矩阵 $B$ 只作初等行变换

$$
B = \begin{bmatrix}0&1&0&1\\0&1&0&1\\2&0&1&1\end{bmatrix}\to ···\to \begin{bmatrix}1&0&\frac{1}{2}&\frac{1}{2}\\0&1&0&1\\0&0&0&0\end{bmatrix}
$$

故可将 $B$ 进行满秩分解为 $B=EF$，且

$$
E = \begin{bmatrix}0&1\\0&1\\2&0\end{bmatrix},F = \begin{bmatrix}1&0&\frac{1}{2}&\frac{1}{2}\\0&1&0&1\end{bmatrix}
$$

则

$$
B^+=\begin{bmatrix}-\frac{1}{11}&-\frac{1}{11}&\frac{4}{11}\\\frac{3}{11}&\frac{3}{11}&-\frac{1}{11}\\-\frac{1}{22}&-\frac{1}{22}&\frac{2}{11}\\\frac{5}{22}&\frac{5}{22}&\frac{1}{11}\end{bmatrix}
$$

## 复习

**线性空间**

设 $\alpha$ 为线性空间 $V (\mathbb {F})$ 中非零向量，若 $\mathbb {F}$ 中数 $k_1$ 与 $k_2$ 不相等，试证：$k_1\alpha\neq k_2\alpha$

**证：**假设 $k_1\alpha =k_2\alpha$，则

$$
\begin{aligned}
k_1\alpha-k_2\alpha=0 \\
\Rightarrow (k_1-k_2)\alpha=0
\end{aligned}
$$

因为 $\alpha \neq 0$，所以 $k_1-k_2=0$，则 $k_1=k_2$，这与题意矛盾，故 $k_1\alpha \neq k_2\alpha$

___

**线性空间基与维数**

求下列线性空间的维数及其一组基：

（1）$\mathbb {F}^{2\times 2}$ 中全体对称矩阵所构成的 $\mathbb {F}$ 上的线性空间

（2）$\mathbb {C}^{2\times 2}$ 中全体上三角矩阵所构成的 $\mathbb {C}$ 上的线性空间

（3）$V(\mathbb{F})=\{(x_1,x_2,...,x_{2n-1},x_{2n})\mid x_2=x_4=···=x_{2n}, \forall x_i\in \mathbb{F}\}$

（4）$A = \text {diag}(1, w, w^2)$，其中 $w^3=1$，但 $w \neq 1$，且 $V (\mathbb {R})=\{f (A)\mid \forall f (x) \in \mathbb {R}[x]\}$

**解：**

> 线性空间的一组基要满足：**线性无关**，**空间中任意一个向量都能由这组基表示**

（1）$\mathbb {F}^{2\times 2}$ 中矩阵的一般形式为 $\begin {bmatrix} x&z\\z&y\end {bmatrix}$，因此很容易得 $\mathbb {F}^{2\times 2}$ 中全体对称矩阵所构成的 $\mathbb {F}$ 上的线性空间的一组基为

$$
\begin{bmatrix}1&0\\0&0\end{bmatrix},\begin{bmatrix}0&0\\0&1\end{bmatrix},\begin{bmatrix}0&1\\1&0\end{bmatrix}
$$

维数为 3

（2）$\mathbb {C}^{2\times 2}$ 中上三角矩阵的一般形式为 $\begin {bmatrix} x&z\\0&y\end {bmatrix}$，因此很容易得其基为

$$
\begin{bmatrix}1&0\\0&0\end{bmatrix},\begin{bmatrix}0&1\\0&0\end{bmatrix},\begin{bmatrix}0&0\\0&1\end{bmatrix}
$$

维数为 3

（3）$V (\mathbb {F})$ 中向量的一般形式为 $(x_1, y,x_3,y,x_5, y,.....,x_{2n-1},y)$，因此很容易得其基为

$$
\begin{aligned}
&(1, 0,0,...,0)\\
&(0,0,1,...,0)\\
&\ \ \ \ \ \ \ \  \ \ \vdots\\
&(0,1,0,1,...,0,1)
\end{aligned}
$$

维数为 $n+1$

（4）因为 $f (A) = a_0E+a_1A+a_2A^2+・・・+a_nA^n$，又因为

$$
A = \begin{bmatrix}1&0&0\\0&w&0\\0&0&w^2\end{bmatrix}\\
A^2 = \begin{bmatrix}1&0&0\\0&w^2&0\\0&0&1\end{bmatrix}\\
A^3 = \begin{bmatrix}1&0&0\\0&1&0\\0&0&1\end{bmatrix}\\
A^4 = \begin{bmatrix}1&0&0\\0&w&0\\0&0&w^2\end{bmatrix}
$$

所以实际上 $f (A)=a_0E+a_1A+a_2A^2+a_3E+a_4A+a_5A^2+・・・+a_nA^n$，其中

$$
A^n=\begin{cases}E,\quad{n \%3=0}\\A,\quad{(n-1)\%3=0}\\A^2, \quad{(n+1)\%3=0}\end{cases}
$$

容易得 $E,A,A^2$ 就是该线性空间的一组基，维数为 3

___

**子空间**

设 $A\in \mathbb {C}^{n\times n}$

（1）$V = \{B\mid AB=BA, B\in \mathbb {C}^{n\times n}\}$，证明 $V$ 是 $\mathbb {C}^{n\times n}$ 的子空间

（2）若 $A=E$，求（1）中 $V$

（3）若 $A=\text {diag}(1, 2, ..., n)$，求（1）中 $V$

（4）若 $n=3,A=\begin {bmatrix} 3&0&0\\0&1&0\\0&1&2\end {bmatrix}$，求（1）中 $V$

**解：**

> 要验证某个线性空间是子空间，只需要判断其**加法**和**数乘**是否封闭

（1）首先验证对于加法是否封闭

$$
\forall B_1,B_2 \in V\\
\because A (B_1+B_2)=AB_1+AB_2\\
又 \because AB_1 = B_1A,AB_2=B_2A\\
\therefore AB_1+AB_2=B_1A+B_2A\Rightarrow A (B_1+B_2)=(B_1+B_2) A\\
\therefore B_1+B_2 \in V
$$

其次验证对于数乘是否封闭

$$
\forall B\in V, k\in \mathbb{C}\\
\because A(kB)=k(AB)=k(BA)=(kB)A\\
\therefore kB\in V
$$

所以 $V$ 是 $\mathbb {C}^{n\times n}$ 的子空间

（2）因为单位矩阵和任何矩阵相乘，都等于那个矩阵本身，所以 $V=\mathbb {C}^{n\times n}$

（3）设 $B=(a_{ij})_{n\times n}$，则

$$
AB = \begin{bmatrix}a_{11}\\&2a_{22}\\&&\ddots \\&&&na_{nn}\end{bmatrix}\\
BA = \begin{bmatrix}a_{11}&2a_{12}&\cdots & na_{1n}\\a_{21}&2a_{22}&\cdots &na_{2n}\\\vdots &&&\vdots\\a_{n1}&2a_{n2}&\cdots &na_{nn}\end{bmatrix}
$$

若要满足 $AB=BA$，则需要 $a_{12}=・・・a_{1n}=・・・a_{21}=・・・a_{nn-1}=0$，故此时 $V$ 是一个 $n\times n$ 的对角阵构成的集合

（4）设 $B=\begin {bmatrix} x_1&x_2&x_3\\y_1&y_2&y_3\\z_1&z_2&z_3\end {bmatrix}$，则

$$
\begin{aligned}
AB &= \begin{bmatrix}3x_1&3x_2&3x_3\\y_1&y_2&y_3\\y_1+2z_1&y_2+2z_3&y_3+2z_3\end{bmatrix}\\
BA &= \begin{bmatrix}3x_1&x_2+x_3&2x_3\\3y_1&y_2+y_3&2y_3\\3z_1&z_2+z_3&2z_3\end{bmatrix}
\end{aligned}
$$

由于 $AB=BA$，则有

$$
\begin{cases}
x_2=0\\
x_3=0\\
y_1=0\\
y_2=z_3\\
y_3=0\\
z_1=0\\
z_3=0
\end{cases}
$$

故 $B=\begin {bmatrix} x_1&0&0\\0&y_2&0\\0&z_2&y_2\end {bmatrix}$，其中 $x_1,y_2,z_2\in \mathbb {C}$

___

**和空间与交空间**

已知 $\alpha_1=(1, 2, 1,0), \alpha_2=(-1, 1, 1, 1), \beta_1=(2, -1, 0, 1), \beta_2=(1, -1, 3, 7)$，$V_1=\text {span}\{\alpha_1, \alpha_2\},V_2=\text {span}\{\beta_1,\beta_2\}$，分别求 $V_1+V_2,V_1\cap V_2$ 的一组基

**解：**

> $\color{red}{V_1+V_2=\text{span}\{\alpha_1,\alpha_2,\beta_1,\beta_2\}}$

因为

$$
\begin {aligned}
(\alpha_1^T,\alpha_2^T,\beta_1^T,\beta_2^T)&=\begin {bmatrix} 1&-1&2&1\\2&1&-1&-1\\1&1&0&3\\0&1&1&7\end {bmatrix}\\
&\stackrel {初等行变换}{\longrightarrow} \begin {bmatrix} 1&0&0&-1\\0&1&0&4\\0&0&1&3\\0&0&0&0\end {bmatrix}
\end {aligned}
$$

由于初等行变换后前三列为非零首元，所以在原矩阵中前三列是线性无关的，故列向量组 $(\alpha_1^T,\alpha_2^T,\beta_1^T,\beta_2^T)$ 的极大线性无关组为 $(\alpha_1^T,\alpha_2^T,\beta_1^T)$，所以 $V_1+V_2$ 的一组基是 $(\alpha_1,\alpha_2,\beta_1)$

> $$
> \color {red}
> {\begin {aligned}
> {\eta\in V_1\cap V_2}\Leftrightarrow &\exists k_1, k_2 使 \eta=k_1\alpha_1+k_2\alpha_2\\
> &\exists l_1,l_2 使 \eta=l_1\beta_1+l_2\beta_2
> \end {aligned}}
> $$

设 $k_1\alpha_1+k_1\alpha_2=l_1\beta_1+l_2\beta_2$，则 $k_1\alpha_1+k_1\alpha_2-l_1\beta_1-l_2\beta_2=0$，即

$$
\begin{cases}
k_1-k_2-2l_1-l_2=0\\
2k_1+k_2+l_1+l_2=0\\
k_1+k_2-3l_2=0\\
k_2-l_1-7l_2=0
\end{cases}
$$

解得

$$
\begin {cases}
k_1=-l_2\\
k_2=4l_2\\
l_1=-3l_2\\
l_2 自由
\end {cases}
$$

不妨令 $l_2=1$，则 $k_1=-1,k_2=4,l_1=-3$，于是 $V_1\cap V_2=\{k (-\alpha_1+4\alpha_2)\}$ 或 $V_1\cap V_2=\{l (-3\beta_1+\beta_2)\}$

故 $V_1\cap V_2$ 的一组基是 $-\alpha_1+4\alpha_2$（或 $-3\beta_1+\beta_2$）

> 上面带有 "或" 字样的，写一个即可，考试时并不需要全部写出来

___

**直和**

设 $V_1=\{A\mid A^T=A, A\in \mathbb {C}^{n\times n}\}, V_2=\{A\mid A^T=-A, A\in \mathbb {C}^{n\times n}\}$，试证：$\mathbb {C}^{n\times n}=V_1\oplus V_2$

**证：**

> 要证明某个线性空间 $V$ 是两个子空间 $V_1,V_2$ 的直和，需要证明以下两点：
>
> 1.  $V = V_1+V_2$，要证明相等，实际上就是证明左包含以及右包含
> 2.  $V_1+V_2$ 是直和

由 $V_1,V_2$ 的定义明显可得 $V_1+V_2\subseteq \mathbb {C}^{n\times n}$；要证明 $\mathbb {C}^{n\times n}\subseteq V_1+V_2$，实际上就是要证明

$$
\forall A\in \mathbb{C}^{n\times n} , A_1\in V_1, A_2\in V_2 \Rightarrow A = A_1+A_2
$$

因为 $\frac {1}{2}(A+A^T)\in V_1, \frac {1}{2}(A-A^T)\in V_2$，且 $A = \frac {1}{2}(A+A^T)+\frac {1}{2}(A-A^T)$，所以 $\mathbb {C}^{n\times n}\subseteq V_1+V_2$

综上所述 $\mathbb {C}^{n\times n}=V_1+V_2$

要证明 $V_1+V_2$ 是直和，只需要证明 $V_1 \cap V_2=\{0\}$。任取 $A\in V_1\cap V_2$，则有

$$
A = A^T （因为 A\in V_1）\\
A^T = -A （因为 A\in V_2）
$$

综上，$A\equiv 0$，所以 $V_1+V_2$ 是直和，即 $\mathbb {C}^{n\times n}=V_1\oplus V_2$

___

**直和**

设 $A, B\in \mathbb {F}^{n\times n}$，且 $AB=0, B^2=B$， $V_1=\{X\mid AX=0, X\in \mathbb {F}^n\}, V_2=\{X\mid BX=0, X\in \mathbb {F}^n\}$，证明：

（1）$\mathbb{F}^n=V_1+V_2$

（2）$\mathbb{F}^n=V_1\oplus V_2 \Leftrightarrow r(A)+r(B)=n$

**证：**

（1）由 $V_1,V_2$ 的定义明显可得 $V_1+V_2\subseteq \mathbb {F}^{n}$；要证明 $\mathbb {F}^{n}\subseteq V_1+V_2$，实际上就是要证明

$$
\forall X\in \mathbb{F}^{n} , X_1\in V_1, X_2\in V_2 \Rightarrow X = X_1+X_2
$$

因为 $X = BX+(X-BX)$，下判断 $BX\in V_1, (X-BX)\in V_2$

$$
\because A(BX)=(AB)X=0\\
\therefore BX\in V_1\\
\because B(X-BX)=BX-B^2X=BX-BX=0\\
\therefore (X-BX)\in V_2
$$

所以 $\mathbb {F}^{n}\subseteq V_1+V_2$，综上所述 $\mathbb {F}^{n}= V_1+V_2$

（2）将 $V_1,V_2$ 看做是齐次线性方程组的解空间，则有

$$
\dim (V_1)=n-r(A)\\
\dim (V_2)=n-r(B)
$$

要证明 $\mathbb {F}^{n}= V_1\oplus V_2$ 实际上就是要证 $\mathbb {F}^{n}= V_1+V_2$ 且 $V_1+V_2$ 是直和，第一问已经证明 $\mathbb {F}^{n}= V_1+V_2$，所以问题就转为证明

$$
V_1+V_2 是直和 \Leftrightarrow r (A)+r (B)=n
$$

因为

$$
\begin {aligned}
V_1+V_2 是直和 &\Leftrightarrow \dim (V_1+V_2)=\dim (V_1) + \dim (V_2)\\
&\Leftrightarrow \dim (\mathbb {F})=\dim (V_1)+\dim (V_2)\\
&\Leftrightarrow n = (n-r (A)) + (n-r (B))\\
&\Leftrightarrow r (A) + r (B) = n
\end {aligned}
$$

证毕

___

**线性变换**

在 $\mathbb {F}^{2\times 2}$ 中定义线性变换 $\mathscr {A}(X)=\begin {bmatrix} a&b\\c&d\end {bmatrix} X, \forall X\in \mathbb {F}^{2\times 2}$，分别求 $\mathscr {A}$ 在基 $E_{11}, E_{12}, E_{21}, E_{22}$ 与基 $E_{11}, E_{21}, E_{12}, E_{22}$ 下的矩阵

**解：**

> 对于基为矩阵的形式，可以将所有的矩阵转为列向量进行处理

根据定义有

$$
\begin{aligned}
&(\mathscr{A}(E_{11}), \mathscr{A}(E_{12}), \mathscr{A}(E_{21}), \mathscr{A}(E_{22}))=(E_{11}, E_{12}, E_{21}, E_{22})A\\
&\Rightarrow \begin{bmatrix}a&0&b&0\\0&a&0&b\\c&0&d&0\\0&c&0&d\end{bmatrix}=\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&0&1&0\\0&0&0&1\end{bmatrix}A\\
&\Rightarrow A = \begin{bmatrix}a&0&b&0\\0&a&0&b\\c&0&d&0\\0&c&0&d\end{bmatrix}
\end{aligned}
$$

同理

$$
\begin{aligned}
&(\mathscr{A}(E_{11}), \mathscr{A}(E_{21}), \mathscr{A}(E_{12}), \mathscr{A}(E_{22}))=(E_{11}, E_{21}, E_{12}, E_{22})B\\
&\Rightarrow \begin{bmatrix}a&b&0&0\\0&0&a&b\\c&d&0&0\\0&0&c&d\end{bmatrix}=\begin{bmatrix}1&0&0&0\\0&0&1&0\\0&1&0&0\\0&0&0&1\end{bmatrix}B\\
&\Rightarrow B = \begin{bmatrix}a&0&b&0\\0&a&0&b\\c&0&d&0\\0&c&0&d\end{bmatrix}
\end{aligned}
$$

___

**正交矩阵**

设 $A, B$ 都是正交阵，且 $|AB|=-1$，证明 $|A+B|=0$

**证：**

> 正交矩阵的性质：$\color {red} {A^T=A^{-1}}$

因为 $|AB|=-1$，所以 $|A|・|B|=-1$，又因为

$$
\begin{aligned}
A+B&=A(E+A^{-1}B)\\
&=A(E+A^TB)\\
&=A(B^T+A^T)B\\
&=A(A+B)^TB
\end{aligned}
$$

则有 $|A+B|=|A|・|(A+B)^T|・|B|=-|A+B|$，故 $|A+B|=0$

___

**Jordan 标准形（排除法）**

试求矩阵的 Jordan 标准形

（1）$A = \begin{bmatrix}3&0&8\\3&-1&6\\-2&0&-5\end{bmatrix}$

（2）$B = \begin{bmatrix}0&3&3\\-1&8&6\\2&-14&-10\end{bmatrix}$

**解：**

> 关于 Jordan 标准形的两种求法，请看本文最后附录

（1）容易求得 $|\lambda E -A| = (\lambda + 1)^3$，所以 $A$ 的 Jordan 标准形矩阵只可能是以下三种情况

$$
L=\begin{bmatrix}-1&0&0\\0&-1&0\\0&0&-1\end{bmatrix}\\
M=\begin{bmatrix}-1&0&0\\0&-1&1\\0&0&-1\end{bmatrix}\\
N=\begin{bmatrix}-1&1&0\\0&-1&1\\0&0&-1\end{bmatrix}
$$

因为 $A$ 与 Jordan 标准形 $J$ 相似，则 $\mathrm {rank}(A-(-1) E)=\mathrm {rank}(J-(-1) E)$，因为 $\mathrm {rank}(A-(-1) E)=1$，且

$$
\mathrm{rank}(L-(-1)E)=0\\
\mathrm{rank}(M-(-1)E)=1\\
\mathrm{rank}(N-(-1)E)=2
$$

所以 $A$ 的 Jordan 标准形为 $\begin {bmatrix}-1&0&0\\0&-1&1\\0&0&-1\end {bmatrix}$

（2）容易求得 $|\lambda E -B| = \lambda (\lambda + 1)^2$，所以 $B$ 的 Jordan 标准形矩阵只可能是以下两种情况

$$
L=\begin{bmatrix}0&0&0\\0&-1&0\\0&0&-1\end{bmatrix}\\
M=\begin{bmatrix}0&0&0\\0&-1&1\\0&0&-1\end{bmatrix}\\
$$

因为 $B$ 与 Jordan 标准形 $J$ 相似，则 $\mathrm {rank}(B-(-1) E)=\mathrm {rank}(J-(-1) E)$，因为 $\mathrm {rank}(B-(-1) E)=2$，且

$$
\mathrm{rank}(L-(-1)E)=1\\
\mathrm{rank}(M-(-1)E)=2\\
$$

所以 $B$ 的 Jordan 标准形为 $\begin {bmatrix} 0&0&0\\0&-1&1\\0&0&-1\end {bmatrix}$

___

**Jordan 标准形（推论）**

将矩阵

$$
\begin{align} 
A=\begin{bmatrix} 2 & 6 & -15 \\ 1 & 1 & -5 \\ 1 & 2 & -6 \end{bmatrix} 
\end{align}
$$

化为 Jordan 标准形

**解：**矩阵 $A$ 的特征多项式为

$$
\begin{align} 
\lvert \lambda E-A \rvert =\begin{bmatrix} \lambda-2 & -6 & 15 \\ -1 & \lambda-1 & 5 \\ -1 & -2 & \lambda+6 \end{bmatrix} =(\lambda+1)^3 
\end{align}
$$

所以它只有一个特征值 $\lambda_1=-1$，代数重数为 3

对 $\lambda=-1$，令

$$
\begin{align} 
B=A-\lambda_1 E = A+E &=\begin{bmatrix} 3 &  6 & -15 \\ 1 & 2 & -5 \\ 1 & 2 & -5 \end{bmatrix} \qquad  \mathrm{rank}(B)=1\\
B^2&=\begin{bmatrix}0&0&0\\0&0&0\\0&0&0\end{bmatrix} \qquad \mathrm{rank}(B^2)=0
\end{align}
$$

则以 $\lambda_1$ 为特征值且阶为 1 的 Jordan 块的个数为

$$
\begin{align} 
w_1(A,\lambda_1)-w_2(A,\lambda_1)=[n-r_1(A,\lambda_1)]  - [r_1(A,\lambda_1)-r_2(A,\lambda_1)]  = [3-1]-[1-0]=1 
\end{align}
$$

同理，以 $\lambda_1$ 为特征值且阶为 2 的 Jordan 块的个数为

$$
\begin{align} 
w_2(A,\lambda_1)-w_3(A,\lambda_1)=[r_1(A,\lambda_1)-r_2(A,\lambda_1)]  - [r_2(A,\lambda_1)-r_3(A,\lambda_1)]  = [1-0]-[0-0]=1 
\end{align}
$$

上面两个 Jordan 块阶数之和为 3，等于 $\lambda_1$ 的代数重数，因而不存在以 $\lambda_1$ 为特征值的其它 Jordan 块，且矩阵 $A$ 没有其它特征值，故 Jordan 块求解完毕，矩阵 $A$ 的 Jordan 标准形为

$$
\begin{align} 
J=\begin{bmatrix} -1 & 0 & 0 \\ 0 & -1 & 1 \\ 0 & 0 & -1\end{bmatrix} 
\end{align}
$$

___

**Jordan 标准形（推论）**

将矩阵

$$
\begin{align} 
A=\begin{bmatrix} 3 & -4 & 0 & 2 \\ 4 & -5 & -2 & 4 \\ 0 & 0 & 3 & -2 \\ 0 & 0 & 2 & -1  \end{bmatrix} 
\end{align}
$$

化为 Jordan 标准形

**解：**矩阵 $A$ 的特征多项式为

$$
\begin{align} 
\lvert \lambda E-A \rvert =\begin{bmatrix} \lambda-3 & 4 & 0 & -2 \\ -4 & \lambda+5 & 2 & -4 \\ 0 & 0 & \lambda-3 & 2 \\ 0 & 0 & -2 & \lambda+1  \end{bmatrix} =(\lambda+1)^2(\lambda-1)^2 
\end{align}
$$

所以它有两个特征值 $\lambda_1=-1,\lambda_2=1$，代数重数都为 2

对 $\lambda_1=-1$，令

$$
\begin{align} 
B_1=A-\lambda_1 E = A+E &=\begin{bmatrix} 4 & -4 & 0 & 2 \\ 4 & -4 & -2 & 4 \\ 0 & 0 & 4 & -2 \\ 0 & 0 & 2 & 0  \end{bmatrix}    \qquad \mathrm{rank}(B_1)=3   \\ 
B_1^2 &=\begin{bmatrix} 0 & 0 &12 & -8 \\ 0 & 0 & 8 & -4 \\ 0 & 0 & 12 & -8 \\ 0 & 0 & 8 & -4  \end{bmatrix} \qquad \mathrm{rank}(B_1^2)=2   \\ 
B_1^3 &=\begin{bmatrix} 0 & 0 & 32 & -24 \\ 0 & 0 & 24 & -16 \\ 0 & 0 & 32 & -24 \\ 0 & 0 & 24 & -16  \end{bmatrix} \qquad \mathrm{rank}(B_1^3)=2 
\end{align}
$$

则以 $\lambda_1$ 为特征值且阶为 1 的 Jordan 块的个数为

$$
\begin{align} 
w_1(A,\lambda_1)-w_2(A,\lambda_1)=[n-r_1(A,\lambda_1)]  - [r_1(A,\lambda_1)-r_2(A,\lambda_1)]  = [4-3]-[3-2]=0 
\end{align}
$$

以 $\lambda_1$ 为特征值且阶为 2 的 Jordan 块的个数为

$$
\begin{align} 
w_2(A,\lambda_1)-w_3(A,\lambda_1)=[r_1(A,\lambda_1)-r_2(A,\lambda_1)]  - [r_2(A,\lambda_1)-r_3(A,\lambda_1)]  = [3-2]-[2-2]=1 
\end{align}
$$

上面第二个 Jordan 块阶数为 2，等于 $\lambda_1$ 的代数重数，所以以 $\lambda_1$ 为特征值的 Jordan 块求解完毕

对 $\lambda_2=1$，令

$$
\begin{align} 
B_2=A-\lambda_2 E = A-E &=\begin{bmatrix} 2 & -4 & 0 & 2 \\ 4 & -6 & -2 & 4 \\ 0 & 0 & 2 & -2 \\ 0 & 0 & 2 & -2  \end{bmatrix}    \qquad \mathrm{rank}(B_2)=3   \\ 
B_2^2 &=\begin{bmatrix} -12 & 16 & 12 & -16 \\ -16 & 20 & 16 & -20 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0  \end{bmatrix} \qquad \mathrm{rank}(B_2^2)=2   \\ 
B_2^3 &=\begin{bmatrix} 40 & -48 & -40 & 48 \\ 48 & -56 & -48 & 56 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0  \end{bmatrix} \qquad \mathrm{rank}(B_2^3)=2 
\end{align}
$$

则以 $\lambda_2$ 为特征值且阶为 1 的 Jordan 块的个数为

$$
\begin{align} 
w_1(A,\lambda_2)-w_2(A,\lambda_2)=[n-r_1(A,\lambda_2)]  - [r_1(A,\lambda_2)-r_2(A,\lambda_2)]  = [4-3]-[3-2]=0 
\end{align}
$$

以 $\lambda_2$ 为特征值且阶为 2 的 Jordan 块的个数为

$$
\begin{align} 
w_2(A,\lambda_2)-w_3(A,\lambda_2)=[r_1(A,\lambda_2)-r_2(A,\lambda_2)]  - [r_2(A,\lambda_2)-r_3(A,\lambda_2)]  = [3-2]-[2-2]=1 
\end{align}
$$

上面第二个 Jordan 块阶数为 2，等于 $\lambda_2$ 的重数，所以以 $\lambda_2$ 为特征值的 Jordan 块求解完毕

以 $\lambda_1=-1$ 和 $\lambda_2=1$ 为特征值的 Jordan 块均是 2 阶的，所以矩阵 $A$ 的 Jordan 标准形为

$$
\begin{align} 
J=\begin{bmatrix} -1 & 1 & 0 & 0 \\ 0 & -1 & 0  & 0 \\ 0 & 0 & 1 & 1 \\ 0&0&0& 1\end{bmatrix} 
\end{align}
$$

___

**$A^n$**

已知 $A=\begin {bmatrix} 17&0&-25\\0&1&0\\9&0&-13\end {bmatrix}$，求 $A^{10}$

**解：**矩阵 $A$ 做不了相似对角化，但一定可以化为 Jordan 标准形（这里省略求 Jordan 标准形的步骤）

$$
J = \begin{bmatrix}1&0&0\\0&2&1\\0&0&2\end{bmatrix}
$$

设 $P=(X_1,X_2,X_3)$，由 $AP=PJ$ 得

$$
\begin{aligned}
&(AX_1, AX_2, AX_3)=(X_1, 2X_2, X_2+2X_3)\\
&\Rightarrow \begin{cases}(E-A)X_1 = 0\\(2E-A)X_2=0\\(2E-A)X_3=-X_2\end{cases}
\end{aligned}
$$

解得

$$
X_1 = \begin{bmatrix}0\\1\\0\end{bmatrix}, X_2 = \begin{bmatrix}5\\0\\3\end{bmatrix}, X_3 = \begin{bmatrix}2\\0\\1\end{bmatrix}
$$

所以 $P=\begin {bmatrix} 0&5&2\\1&0&0\\0&3&1\end {bmatrix}$，则

$$
\begin{aligned}
A^{10} &=\left(P J P^{-1}\right)^{10} \\
&=P J^{10} P^{-1} \\
&=\begin{bmatrix}
0 & 5 & 2 \\
1 & 0 & 0 \\
0 & 3 & 1
\end{bmatrix}\begin{bmatrix}
1 & 0 & 0 \\
0 & 2 & 1 \\
0 & 0 & 2
\end{bmatrix}^{10}\begin{bmatrix}
0 & 5 & 2 \\
1 & 0 & 0 \\
0 & 3 & 1
\end{bmatrix}^{-1} \\
&=\begin{bmatrix}
0 & 5 & 2 \\
1 & 0 & 0 \\
0 & 3 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 & 0 \\
0 & 2^{10} & 10 \cdot 2^{9} \\
0 & 0 & 2^{10}
\end{bmatrix}
\begin{bmatrix}
0 & 1 & 0 \\
-1 & 0 & 2 \\
3 & 0 & -5
\end{bmatrix} \\
&=\begin{bmatrix}
76·2^{10} & 0 & -125·2^{10} \\
 0 & 1 & 0 \\
 45 · 2^{10}& 0 & -74·2^{10}
\end{bmatrix}
\end{aligned}
$$

___

**矩阵广义逆**

设 $A\in \mathbb {C}^{s\times n}, r (A)=1$，试证：$A^+=(tr (A^HA))^{-1} A^H$

**证：**对 $A$ 进行满秩分解得 $A = B_{s\times 1} C_{1\times n}$，因为

$$
A^+ = C^H(CC^H)^{-1}(B^HB)^{-1}B^H
$$

又因为 $CC^H$ 和 $B^HB$ 都是数，所以

$$
\begin{aligned}
A^+ &= \frac{1}{(B^HB)(CC^H)}·C^HB^H\\
&=\frac{1}{(B^HB)(CC^H)}(BC)^H\\
&=\frac{1}{(B^HB)(CC^H)}A^H
\end{aligned}
$$

因为

$$
\begin {aligned}
A^HA &= (BC)^H (BC)\\
&=C^HB^HBC\\
&=(B^HB)(C^HC)\quad (因为 B^HB 是一个数)
\end {aligned}
$$

所以

$$
\begin{aligned}
tr(A^HA) &= B^HB·\text{tr}(C^HC)\\
&=B^HB · \text{tr}(CC^H)\\
&=B^HB·CC^H
\end{aligned}
$$

证毕

___

**矩阵广义逆**

用适当的方式求下列矩阵的广义逆

（1）$A = \begin {bmatrix} 0&c\\a&0\\b&0\end {bmatrix}$，其中复数 $a,b,c$ 满足 $c\neq 0, |a|^2+|b|^2\neq 0$

（2）$A = \begin{bmatrix}1&0&-1\\2&0&-2\end{bmatrix}$

**解：**

（1）实际上有分块广义逆的性质：$B = \begin {bmatrix} 0&M\\N&0\end {bmatrix}\Rightarrow B^+=\begin {bmatrix} 0&N^+\\M^+&0\end {bmatrix}$，于是将 $A$ 进行分块得

$$
A^+ = \left[\begin{array}{c|c}0 & \begin{bmatrix}a\\b\end{bmatrix}^+ \\ \hline \frac{1}{c} & 0\end{array}\right]
$$

对 $\begin {bmatrix} a\\b\end {bmatrix}^+$ 进行满秩分解得 $\begin {bmatrix} a\\b\end {bmatrix}=B_{2\times 1} C_{1\times 1}$，不妨令 $B=\begin {bmatrix} a\\b\end {bmatrix},C=1$，则

$$
\begin{bmatrix}a\\b\end{bmatrix}^+=(B^HB)^{-1}B^H=\frac{1}{|a|^2+|b|^2}·[\bar{a}, \bar{b}]
$$

所以

$$
A^{+}=\begin{bmatrix}0&\frac{\bar{a}}{|a|^2+|b|^2}&\frac{\bar{b}}{|a|^2+|b|^2}\\\frac{1}{c}&0&0\end{bmatrix}
$$

（2）对 $A$ 做初等行变换得 $A\to \begin {bmatrix} 1&0&-1\\0&0&0\end {bmatrix}$，所以满秩分解 $A=BC$，其中 $B=\begin {bmatrix} 1\\2\end {bmatrix},C=\begin {bmatrix} 1&0&-1\end {bmatrix}$，由 $A^{+} = C^H (CC^H)^{-1}(B^HB)^{-1} B^H$ 得

$$
A =\begin{bmatrix}\frac{1}{10}&\frac{1}{5}\\0&0\\-\frac{1}{10}&-\frac{1}{5}\end{bmatrix}
$$

___

### 附

**Jordan 标准形的两种求法**

**排除法（适用于低阶矩阵）**

1.  通过矩阵 $A$ 的特征多项式 $|\lambda E-A|$ 求得特征值 $\lambda_1,\lambda_2,...,\lambda_r$
2.  根据特征值列出所有可能的 Jordan 标准形矩阵 $J$
3.  由于矩阵 $A$ 与 Jordan 标准形 $J$ 相似，所以可通过 $\mathrm {rank}(A-\lambda_iE)=\mathrm {rank}(J-\lambda_iE)$ 进行排除，筛选出最终的 Jordan 标准形

**Jordan 标准形定理的推论**

首先定义

$$
\begin{align} 
r_k(A,\lambda)=\mathrm{rank} \, (A-\lambda E)^k, \quad r_0(A,\lambda)=n 
\end{align}
$$

又定义

$$
\begin{align} 
w_k(A,\lambda)=r_{k-1}(A,\lambda)-r_k(A,\lambda), \quad w_1(A,\lambda)=n-r_1(A,\lambda) 
\end{align}
$$

将矩阵化为 Jordan 标准形需要三步：

1.  求出矩阵 $A$ 所有**不同**的特征值 $\lambda_1,\lambda_2,...\lambda_t$
2.  Jordan 标准形定理的推论告诉我们：$w_k (A,\lambda)-w_{k+1}(A,\lambda)=m$ 表示以 $\lambda$ 为特征值且阶为 $k$ 的 Jordan 块有 $m$ 个。利用这个公式计算出以 $\lambda$ 为特征值，阶为 $l=1,2,...$ 的个数，直到以 $\lambda$ 为特征值的 Jordan 块阶数之和等于特征值 $\lambda$ 的代数重数
3.  将所获得的 Jordan 块按任意次序排列成 Jordan 矩阵

**$A^n$ 求法**

设矩阵 $A$ 的 Jordan 标准形为 $J$，且 $P=(X_1,X_2,X_3)$，由 $AP=PJ$ 求出 $P$，于是 $A^n=(PJP^{-1})^n=PJ^nP^{-1}$，其中

$$
J^n=\begin{bmatrix}J_1\\&J_2\\&&\ddots \\&&&J_m\end{bmatrix}^n=\begin{bmatrix}J_1^n\\&J_2^n\\&&\ddots \\&&&J_m^n\end{bmatrix}
$$

显然当其中某一个 Jordan 块 $J_i$ 阶数 $k$ 较大时，求幂次略显复杂

$$
\begin{bmatrix}\lambda &1\\&\lambda &1\\&&\lambda &\ddots  \\&&&\ddots&1\\&&&&\lambda\end{bmatrix}^n=\begin{bmatrix}\lambda^{n} & C_{n}^{1} \lambda^{n-1} & C_{n}^{2} \lambda^{n-2} & \cdots & C_{n}^{k-1} \lambda^{n-(k-1)} \\
& \lambda^{n} & C_{n}^{1} \lambda^{n-1} & \cdots & C_{n}^{k-2} \lambda^{n-(k-2)} \\
& & \lambda^{n} & \cdots & C_{n}^{k-3} \lambda^{n-(k-3)} \\
& & & \ddots & \vdots \\
& & & & \lambda^{n}\end{bmatrix}
$$

其中

$$
\begin{aligned}
C_n^{m}=\begin{cases}\frac{n!}{m!(n-m)!},&\quad {0≤m≤n}\\0, &\quad \text{others}\end{cases}
\end{aligned}
$$
