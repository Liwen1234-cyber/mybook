# 工程矩阵笔记

## 线性空间

#### 线性空间的定义

**线性空间**是定义在**数域 $\mathbb {F}$** 上满足某些运算规律的向量**集合**，而数域本身也是一种特殊的集合。所以我们先讲数域，再讲线性空间

什么是数域？数域是一种数集，元素的和、差、积、商仍在数集中（具有封闭性），称为数域。如有理数域 $\mathbb {Q}$，复数域 $\mathbb {C}$，实数域 $\mathbb {R}$

线性空间的定义：

> 设 $V$ 是以 $\alpha, \beta, \gamma,...$ 为元素的非空集合，$\mathbb {F}$ 是一个数域，定义**两种运算**：
>
> 1.  加法 $\forall \alpha , \beta \in V, \; \alpha + \beta \in V$
> 2.  数乘 $\forall k \in \mathbb {F}, \alpha \in V, k \alpha \in V$
>
> 满足 8 条：**加法交换律、加法结合律、数乘结合律、两个分配律，零元 (单位元) 存在，1 (幺) 元存在，负元存在。则称 $V$ 为数域 $\mathbb {F}$ 上的线性空间**

1.  交换律 $\alpha+\beta=\beta+\alpha$
2.  结合律 $\alpha+(\beta+\gamma)=(\alpha+\beta)+\gamma$
3.  零元素 在 $V$ 中有一元素 0（称作零元素，注：该 0 为向量），对于 $V$ 中任一元素 $\alpha$ 都有 $\alpha+0=\alpha$
4.  负元素 对于 $V$ 中每一个元素 $\alpha$，都有 $V$ 中的元素 $\beta$，使得 $\alpha+\beta=0$，其中，0 代表的是零元素，但不一定永远都是 0 这个数，视具体题目而定
5.  $\alpha・1=\alpha$，其中 $1$ 是数，不是向量
6.  $(\alpha l)k=\alpha (kl)$
7.  $\alpha (k+l)=\alpha k+\alpha l$
8.  $(\alpha+\beta)k=\alpha k+\beta k$

注：$\alpha,\beta,\gamma\in V\ \ 1,k,l\in \mathbb {F}$

简单点说，上述 8 条，只要有任意一条不满足，则 $V$ 就不是数域 $\mathbb {F}$ 上的线性空间（**线性空间中的元素叫向量**）

___

例 1

$V=\{0\}$，$\mathbb {F}$ 是数域，判断 $V$ 是否为数域 $\mathbb {F}$ 上的线性空间

解：判断是否线性空间，只需要证明集合 $V$ 在数域 $\mathbb {F}$ 上是否满足上述 8 条。这里明显满足条件，因此 $V$ 是数域 $\mathbb {F}$ 上的线性空间

___

#### 例 2

$R^+$ 表示所有正实数集合，在 $R^+$ 中定义加法 $\oplus$ 与数量乘法 $\odot$ 分别为

$$
\begin{align}
a\oplus b&=ab, & \forall a,b\in R^+\\
k\odot a&=a^k, & \forall a\in R^+, k\in \mathbb{R}
\end{align}
$$

判断 $R^+$ 是否构成实数域 $\mathbb {R}$ 上的线性空间

解：通过证明交换律，结合律，零元素，负元素，数乘结合律，两个分配律。因此 $R^+$ 是实数域 $\mathbb {R}$ 上的线性空间

-   交换律：$a\oplus b = ab = ba = b\oplus a$
-   结合律：$a\oplus (b\oplus c) = a (bc) = (ab) c = (a\oplus b) \oplus c$
-   零元素：这个比较复杂，我详细推导一下。原始定义中 $\alpha\oplus 0=\alpha$，因此 0 就是零元素。但是对于这道题，我们需要找到一个数 $x$，使得 $a\oplus x=ax=a$，显然，$x=1$。因此，$R^+$ 存在零元素，零元素是 1
-   负元素：其实和零元素同理，原始定义中 $\alpha \oplus \beta=0$，因此 $\beta$ 就是 $\alpha$ 的负元素。对于这道题，我们需要找到一个数 $y$，使得 $\alpha\oplus y=\alpha y=0$。**但是要注意，这里的 0 是零元素，而上面我们已经推出零元素是 1**。所以这里我们需要证明的式子应该是 $\alpha\oplus y=\alpha y=1$，显然，$y=\frac {1}{\alpha}$，并且 $\alpha$ 是正实数集合中的元素，因此 $\alpha\neq0$。因此 $R^+$ 存在负元素，负元素是 0
-   数乘结合律：$k\odot (l\odot \alpha)=k\odot (\alpha^l)=\alpha^{lk}=\alpha^{kl}=(kl)\odot \alpha$
-   分配律 1：$(k+l)\odot \alpha=\alpha^{k+l}=\alpha^k\alpha^l=\alpha^k\oplus\alpha^l=(k\odot\alpha)\oplus (l\odot \alpha)$
-   分配律 2：$k\odot (\alpha\oplus\beta)=(\alpha\beta)^{k}=\alpha^k\beta^k=(k\odot\alpha)\oplus (k\odot\beta)$

___

#### 例 3

设 $V$ 是由系数在实数域 $\mathbb {R}$ 上，次数为 $n$ 的 $n$ 次多项式 $f (x)$ 构成的集合，其加法运算与数乘运算按照通常规定，举例说明 $V$ 不是 $\mathbb {R}$ 上的线性空间

解：$V$ 是由次数为 $n$ 的 $n$ 次多项式 $f (x)$ 构成的集合，显然加法不封闭。例如 $x\in V$，则 $x+(-x)=0$，0 的次数不再是 $n$，次数下降，不再属于 $V$ 了。同理，数乘也不封闭。例如 $x\in V$，则 $x・0=0$，次数同样下降，不属于 $V$。因此 $V$ 不是 $\mathbb {R}$ 上的线性空间

___

#### 线性空间的性质

1.  加法零元 (单位元) 唯一
2.  加法负元唯一

证：设 $0_1,0_2$ 是两个零元，则 $0_1=0_1+0_2=0_2$

证：设 $\alpha$ 的负元为 $\beta_1,\beta_2$，则 $\beta_1=\beta_1+0=\beta_1+(\alpha+\beta_2)=(\beta_1+\alpha)+\beta_2=\beta_2$

> $\forall \alpha\in V, 0・\alpha=0$，其中，第一个 0 是数，第二个 0 是向量
>
> $\forall k\in \mathbb {F}, k・0=0$，其中的两个 0 是相同的，都是向量
>
> 若 $k\alpha=0$，则 $k=0$ 或 $\alpha=0$
>
> 若 $\alpha+\beta=\alpha+\gamma$，则 $\beta=\gamma$

___

#### 补充

以下内容来源哈工大严质彬老师课上讲解

**数乘中的数，最好放在向量的右边**

$$
\left(
  \begin{array}{c}
          \frac{1}{3} \\
          \frac{2}{5} \\
          \frac{1}{2}
 \end{array}
 \right)·2
$$

数字 2，可以看作是 1×1 的矩阵，而列向量是 3×1 的。将数放向量的右边，就满足了矩阵乘法的要求（第一个矩阵的列数必须等于第二个矩阵的行数）

## 极大线性无关组

#### 两个向量组之间的线性表示关系

设 $V$ 是 $\mathbb {F}$ 上的线性空间，$\alpha_1,\alpha_2,...,\alpha_p$ 和 $\beta_1,\beta_2,...,\beta_q$ 是 $V$ 中的两个向量组，$\beta\in V$

1.  如果存在 $p$ 个数 $k_i\in \mathbb {F},i=1,2,...,p$，使得 $\alpha_1k_1+\alpha_2k_2+・・・+\alpha_pk_p=\beta$，称向量 $\beta$ 可由向量组 $\alpha_1,\alpha_2,...,\alpha_p$ 线性表示
2.  如果每个 $\beta_j$ 都可以由向量组 $\alpha_1,\alpha_2,...,\alpha_p$ 线性表示，$j=1,2,...,q$。为了方便，$\beta_1,\beta_2,...,\beta_q$ 可由 $\alpha_1,\alpha_2,...,\alpha_p$ 线性表示，用符号记为 $\{\beta_1,\beta_2,...,\beta_q\}≤_{lin}\{\alpha_1,\alpha_2,...,\alpha_p\}$

___

#### 线性表示关系的传递性

设 $V$ 是 $\mathbb {F}$ 上的线性空间，$\alpha_1,\alpha_2,...,\alpha_p$；$\beta_1,\beta_2,...,\beta_q$；$\gamma_1,\gamma_2,...,\gamma_t$ 是 $V$ 中三个向量组。若

$$
\{\alpha_1,\alpha_2,...,\alpha_p\}≤_{lin}\{\beta_1,\beta_2,...,\beta_q\}\\
\{\beta_1,\beta_2,...,\beta_q\}≤_{lin}\{\gamma_1,\gamma_2,...,\gamma_t\}
$$

则 $\{\alpha_1,\alpha_2,...,\alpha_p\}≤_{lin}\{\gamma_1,\gamma_2,...,\gamma_t\}$

**证明：**我们利用线性表示关系的矩阵表达。由存在 $T\in \mathbb {F}^{q\times p},S\in \mathbb {F}^{t\times q}$ 满足

$$
[\alpha_1,\alpha_2,...,\alpha_p]=[\beta_1,\beta_2,...,\beta_q]T\\
[\beta_1, \beta_2,...,\beta_q]=[\gamma_1,\gamma_2,...,\gamma_t]S
$$

得 $[\alpha_1,\alpha_2,...,\alpha_p]=[\gamma_1,\gamma_2,...,\gamma_t](ST)$。由于 $ST\in \mathbb {F}^{t\times p}$ 得证

___

#### 扁（列 > 行）的齐次线性方程组必有非零解

设 $A\in \mathbb {F}^{m\times n},1≤m＜n$，则齐次线性方程组 $Ax=0$ 必有非零解

$$
x=\begin{bmatrix} c_1 \\ c_2 \\ \vdots \\ c_n\end{bmatrix}\in \mathbb{F}^n,\begin{bmatrix} c_1 \\ c_2 \\ \vdots \\ c_n\end{bmatrix}\neq0
$$

这里，$m<n$，也就是方程的个数少于未知数的个数（不定方程），系数矩阵呈扁形

**证明：**对 $m$ 用数学归纳法

1.  $m=1$ 时，$n≥2$。根据 $a_{11}$ 是否为 0 分两种情况
  
    1.  若 $a_{11}=0$，则取 $\begin {bmatrix} c_1 \\ c_2 \\ \vdots \\ c_n\end {bmatrix}=\begin {bmatrix} 1\\ 0\\ \vdots \\0\end {bmatrix}$，易知其为一非零解
    2.  若 $a_{11}\neq0$，由 $n≥2$，可取 $\begin {bmatrix} c_1 \\ c_2 \\ \vdots \\ c_n\end {bmatrix}=\begin {bmatrix}-\frac {a_{12}}{a_{11}}\\ 0\\ \vdots \\0\end {bmatrix}$，易知这样取得 $c$ 为一非零解
2.  假设 $m≤p$ 时命题成立，下面证明 $m=p+1$ 的情形，此时 $n≥p+2$，同样根据 $x_1$ 的系数，也就是系数矩阵 $A$ 的第一列 $\alpha_1=\begin {bmatrix} a_{11}\\a_{21}\\ \vdots  \\a_{p+1,1}\end {bmatrix}$ 是否为 0 分两种情况
  
    1.  若 $\alpha_1=0$，则取 $c=\begin {bmatrix} c_1\\ c_2 \\ \vdots \\ c_n\end {bmatrix}=\begin {bmatrix} 1\\ 0\\ \vdots \\ 0\end {bmatrix}$
    2.  若 $\alpha_1\neq0$，不妨设 $\alpha_{11}\neq0$，则有与 $Ax=0$ 同解的线性方程组 $\begin {bmatrix} a_{11} &a_{12}&\cdots &a_{1n} \\ 0 &0 & \cdots &0 \\ \vdots & \vdots & \vdots & \vdots \\ 0 & a_{p+1,2}-\frac {a_{p+1,1}}{a_{11}}・a_{12} & \cdots & a_{p+1, n}-\frac {a_{p+1,1}}{a_{11}}・a_{1n}\end {bmatrix}\begin {bmatrix} x_1\\ x_2 \\ \vdots \\ x_n\end {bmatrix}=0$，由归纳假设，如下 $p$ 个方程，$n-1 (≥p+1>p)$ 个未知数的线性方程组 $\begin {bmatrix} a_{22}-\frac {a_{21}}{a_{11}}・a_{12} & \cdots & a_{2n}-\frac {a_{21}}{a_{11}}・a_{1n} \\ \vdots & \vdots & \vdots \\ a_{p+1,2}-\frac {a_{p+1,1}}{a_{11}}・a_{12} & \cdots & a_{p+1,n}-\frac {a_{p+1,1}}{a_{11}}・a_{1n}\end {bmatrix}\begin {bmatrix} x_2 \\ \vdots \\ x_n\end {bmatrix}=0$ 有非零解 $\begin {bmatrix} x_2\\ \vdots \\ x_n\end {bmatrix}=\begin {bmatrix} c_2\\ \vdots \\ c_n\end {bmatrix}\neq 0$，再取 $x_1=c_1=-\frac {1}{a_{11}}(a_{12} c_2+・・・+a_{1n} c_n)$，易知 $\begin {bmatrix} x_1 \\ x_2\\ \vdots \\ x_n\end {bmatrix}=\begin {bmatrix} c_1  \\ c_2\\ \vdots \\ c_n\end {bmatrix}\neq 0$ 是方程组 $Ax=0$ 的非零解。证毕

___

#### 线性表示与线性无关性

设 $V$ 是 $\mathbb {F}$ 上的线性空间，$\alpha_1,\alpha_2,...,\alpha_p$ 和 $\beta_1, \beta_2,...,\beta_q$ 是 $V$ 中两个向量组。若 $\alpha_1,\alpha_2,...,\alpha_p$ 线性无关，且 $\{\alpha_1,\alpha_2,...,\alpha_p\}≤_{lin}\{\beta_1,\beta_2,...,\beta_q\}$，则 $p≤q$

**证明：**用反证法，假设 $p<q$，由线性表示关系的矩阵表达可知，存在矩阵 $T\in \mathbb {F}^{q\times p}$，使得

$$
\begin{bmatrix}\alpha_1 &\alpha_2 & \cdots & \alpha_p\end{bmatrix}=\begin{bmatrix}\beta_1 &\beta_2 & \cdots & \beta_q\end{bmatrix}T
$$

因为**扁的齐次方程组必有非零解**，所以存在 $c\in \mathbb {F}^p$ 非零，使得 $Tc=0$。上述等式两边右乘 $c$ 得

$$
\begin{bmatrix}\alpha_1 &\alpha_2 & \cdots & \alpha_p\end{bmatrix}c=\begin{bmatrix}\beta_1 &\beta_2 & \cdots & \beta_q\end{bmatrix}Tc=0
$$

因为 $c\in \mathbb {F}^p$ 非零，此结论与 $\alpha_1,\alpha_2,...,\alpha_p$ 线性无关矛盾，证毕

___

#### 以少表多，多必相关

$\alpha_1, \alpha_2,...,\alpha_r$ 与 $\beta_1, \beta_2,...,\beta_s$ 是线性空间 $V$ 中的两个向量组。若：

1.  $\alpha_1, \alpha_2,...,\alpha_r$ 可由 $\beta_1, \beta_2,...,\beta_s$ 线性表示
2.  $r>s$

则 $\alpha_1, \alpha_2,...,\alpha_r$ 线性相关

**证明：**因为 $\{\alpha_1,\alpha_2,...,\alpha_r\}≤_{lin}\{\beta_1,\beta_2,...,\beta_s\}$，所以 $\exists A\in \mathbb {F}^{s\times r}$，使得

$$
\begin{bmatrix}\alpha_1 & \alpha_2 & \cdots & \alpha_r\end{bmatrix} = \begin{bmatrix}\beta_1 & \beta_2 & \cdots & \beta_s\end{bmatrix}A
$$

于是有 $r (\begin {bmatrix}\alpha_1 & \alpha_2 & \cdots & \alpha_r\end {bmatrix})≤\min\{r (\begin {bmatrix}\beta_1 & \beta_2 & \cdots & \beta_s\end {bmatrix}), r (A)\}≤s<r$

即 $r (\begin {bmatrix}\alpha_1 & \alpha_2 & \cdots & \alpha_r\end {bmatrix})<r$，所以向量组 $\alpha_1, \alpha_2,...,\alpha_r$ 线性相关

**推论：**若 $\{\alpha_1,\alpha_2,...,\alpha_r\}≤_{lin}\{\beta_1,\beta_2,...,\beta_s\}$，且 $\alpha_1, \alpha_2,...,\alpha_r$ 线性无关，则 $r≤s$

## 基与坐标

设 $V$ 是 $\mathbb {F}$ 上的线性空间，若有正整数 $n$ 及 $V$ 中的向量组 $\alpha_1,\alpha_2,...,\alpha_n$ 使得

1.  $\alpha_1, \alpha_2,...,\alpha_n$ 线性无关
2.  任取向量 $\alpha \in V$ 均可由 $\alpha_1,\alpha_2,...,\alpha_n$ 线性表示

$$
\alpha=\alpha_1k_1+\alpha_2k_2+···+\alpha_nk_n \\ =\begin{bmatrix}\alpha_1 & \alpha_2 & \cdots & \alpha_n\end{bmatrix}\begin{bmatrix}k_1 \\ k_2 \\ \vdots \\ k_n\end{bmatrix} \\ =\begin{bmatrix}\alpha_1 & \alpha_2 & \cdots & \alpha_n\end{bmatrix}X
$$

则称 $V$ 是 $\mathbb {F}$ 上的有限维线性空间，向量组 $\alpha_1, \alpha_2,...,\alpha_n$ 称为 $V$ 的一个**基**，其中 $X$ 称为向量 $\alpha$ 在基 $\alpha_1,\alpha_2,...,\alpha_n$ 下对应的**坐标**，基向量组中向量的个数 $n$ 称为 $V$ 的维数，记为 $\dim (V)$

___

证明一组向量是线性空间的基，分两步

-   证明这组向量线性无关
-   证明线性空间任意向量可由这组向量表示

___

#### 是否任意一个线性空间都有维数？

答案是**否定**的，下面举一个**无限维线性空间**的例子

记 $\mathbb {R}[x]_n=\{f\mid f\in \mathcal {F}(\mathbb {R}, \mathbb {R}),\$  且 $f$ 可写成次数 $<n$ 的实系数多项式 $\}$，按照线性空间 $\mathcal {F}(\mathbb {R},\mathbb {R})$ 的加法和数乘，易知 $\mathbb {R}[x]_n$ 为 $n$ 维线性空间，而 $\mathbb {R}[x]$(全体多项式构成的线性空间) 是无限维的线性空间。下面针对 $\mathbb {R}[x]$ 是无限维进行证明

**分析：**要证明一个线性空间是无限维的，我们只要证明这个线性空间中**任意有限个向量都不构成基**。换句话说，只要能在线性空间中找到一个向量，无法由给定的有限个线性无关的向量线性表示，那么这个线性空间就是无限维的

**证明：**设 $f_1,f_2,...,f_n\in \mathbb {R}[x]$，且 $f_1,f_2,...,f_n$ 线性无关

记

$$
d_i=\partial(f_i), \ i=1,2,...,n
$$

其中 $\partial (f_i)$ 表示多项式 $f_i$ 的次数，且记 $d=\max\{d_1, d_2,...,d_n\}$

现在问题改为证明 $x^{d+1}\in \mathbb {R}[x]$ 不能由 $f_i$ 线性表示，设

$$
\begin{align*}
x^{d+1}&=a_1f_1(x)+···+a_nf_n(x)\\
&...\\
&=b_0x^0+b_1x^1+···+b_dx^d\\
&\Leftrightarrow b_0x^0+b_1x^1+···-x^{d+1}=0
\end{align*}
$$

上式明显不成立，因此有限个线性无关的向量 $f_1,f_2,...,f_n$ 无法线性表示 $x^{d+1}$，故线性空间 $\mathbb {R}[x]$ 是无限维的

___

举几个有限维线性空间维度的例子

#### 例 1

$V=\mathbb {R}, \mathbb {F}=\mathbb {R}$，求 $\dim (V)$

**解：**事实上，任何一个 $a\neq 0$ 的向量都能构成该线性空间的基，因为 $\forall x\in V, x = (\frac {x}{a})・a$，其中第一个 $a\in \mathbb {F}$，第二个 $a\in V$。因此 $\dim (V)=1$

这题有一个扩展的结论：$V=\mathbb {R}^n, \mathbb {F}=\mathbb {R}$，则 $\dim (V)=n$

___

#### 例 2

$V=\mathbb {C}, \mathbb {F}=\mathbb {R}$，求 $\dim (V)$

**解：**$V$ 中找一个基 $1$ 和 $\mathbb {i}$，首先证明 $1$ 和 $\mathbb {i}$ 线性无关，因为 $k_1・1+k_2・\mathbb {i}=0$ 仅有零解 $\begin {bmatrix} k_1 \\ k_2\end {bmatrix}=\begin {bmatrix} 0 \\ 0\end {bmatrix}$，所以 $1$ 和 $\mathbb {i}$ 线性无关。其次 $\forall x \in V, x = \text {real}(x)・1+ \text {img}(x)・\mathbb {i}$，其中 $\text {real}(x)$ 和 $\text {img}(x)$ 分别表示取 $x$ 的实部和虚部，并且它们都在数域 $\mathbb {F}$ 内，所以 $\dim (V)=2$

___

#### 例 3

$V=\mathbb {C}, \mathbb {F}=\mathbb {C}$，求 $\dim (V)$

**解：**事实上，任何一个 $a\neq 0$ 的向量都能构成该线性空间的基，因为 $\forall x\in V, x=(\frac {x}{a})・a$，所以 $\dim (V)=1$

___

#### 例 4

$V=\mathbb {R}, \mathbb {F}=\mathbb {Q}$，求 $\dim (V)$

**解：**这题非常复杂，先给出结论 $\dim (V)=\infty$

通过反证法来证明该结论。假设 $\dim (V)=n<\infty$，我们从 $V$ 中任取 $n+1$ 个向量必定是线性相关的

假设我们取 $n+1$ 个素数 $p_1, p_2, ..., p_{n+1}$，再将这些素数分别取 $\ln$，则变为 $\ln (p_1), \ln (p_2), ..., \ln (p_{n+1})$，于是问题就变为判断下面的齐次方程是否有非零解

$$
a_1·\ln(p_1)+a_2·\ln(p_2)+···+a_{n+1}·\ln(p_{n+1})=0
$$

其中 $a_i\in \mathbb {Q}, p_i\in V=\mathbb {R}$

由于公理**有理数一定可以表示为两个整数相除**，所以可以将 $a_i$ 看作 $\frac {j_i}{k_i}$，其中 $j_i,k_i \in \mathbb {Z}$，将上面的求和式子两边同乘 $k_1・k_2・・・k_{n+1}$ 得

$$
\begin{align*}
&(j_1·k_2·k_3···k_{n+1})·\ln(p_1)+(j_2·k_1·k_3···k_{n+1})·\ln(p_2)+\\
&(j_3·k_1·k_2·k_4···k_{n+1})·\ln(p_3)+···+(j_{n+1}·k_1·k_2···k_{n})·\ln(p_{n+1})=0
\end{align*}
$$

我们将其中的系数定义为 $b_i$，例如

$$
\begin{align*}
&j_1·k_2·k_3···k_{n+1}\triangleq b_1\\
&j_2·k_1·k_3···k_{n+1}\triangleq b_2\\
&······\\
&j_{n+1}·k_1·k_2···k_{n}\triangleq b_{n+1}
\end{align*}
$$

于是新的式子就变为

$$
\sum_{i=1}^{n+1}b_i·\ln(p_i)=0,\ b_i\in \mathbb{Z}
$$

两边同时取以 $e$ 为底

$$
\begin{align*}
\exp(\sum_{i=1}^{n+1}b_i·\ln (p_i))&=1\\
\Leftrightarrow \exp(\sum_{i=1}^{n+1}\ln(p_i^{b_i}))&=1\\
\Leftrightarrow \prod_{i=1}^{n+1} \exp(\ln(p_i^{b_i}))&=1\\
\Leftrightarrow \prod_{i=1}^{n+1} p_i^{b_i}&=1\\
\end{align*}
$$

底数 $p_i$ 都是大于 1 的，因此我们考虑 $b_i$ 的几种情况

1.  $b_i>0$，则 $\prod_{i=1}^{n+1} p_i^{b_i}>1$
2.  $b_i<0$，则 $\prod_{i=1}^{n+1} p_i^{b_i}<1$
3.  $b_i$ 既有大于 0，也有小于 0 的。不妨设 $b_1,b_2,...,b_k>0$，$b_{k+1},b_{k+2},...,b_{n+1}<0$，则上式变为 $\frac {\prod_{i=1}^{k} p_i^{b_i}}{\prod_{j=k+1}^{n+1} p_j^{-b_j}}$，要想该式等于 1，需要分子分母能消掉，但是由于所有的底数 $p$ 都是素数，因此该分数不可能为 1
4.  $b_i=0$

上面 4 种情况，只有 $b_i=0$ 满足等式。回过去看 $b_i=j_i・(k_1・・・k_{i-1}・k_{i+1}・・・k_{n+1})$，由于 $a_i=\frac {j_i}{k_i}$ 分母不为 0，所以只有 $j_i=0$，因此 $a_i=0,\ i=1,2,...,n+1$，所以齐次方程仅有零解，这 $n+1$ 个向量线性无关，与假设矛盾，因此 $\dim (V)=\infty$，证毕

___

#### 零维线性空间

规定仅含一个元素的线性空间（零线性空间）为**零维线性空间**，其维数规定为 0，零维线性空间也算作有限维线性空间

___

#### 例 5

试证：所有 $n$ 阶对称矩阵组成 $\frac {n (n+1)}{2}$ 维线性空间；所有的 $n$ 阶反对称矩阵组成 $\frac {n (n-1)}{2}$ 维线性空间

**解：**用 $E_{ii}$ 表示 $n$ 阶矩阵除第 $i$ 行，第 $i$ 列的元素为 1 外，其余元素全为 0 的矩阵。用 $E_{ij}(i < j,i=1,2,...,n-1)$ 表示 $n$ 阶矩阵中除第 $i$ 行第 $j$ 列元素与第 $j$ 行第 $i$ 列元素为 1 外，其余元素全为 0 的矩阵

显然 $E_{ii},E_{ij}$ 都是对称矩阵，$E_{ii}$ 有 $n$ 个，$E_{ij}$ 有 $\frac {n (n-1)}{2}$ 个。不难证明 $E_{ii},E {ij}$ 是线性无关的，且任何一个对称矩阵都可用这 $n+\frac {n (n-1)}{2}=\frac {n (n+1)}{2}$ 个矩阵线性表示，即 $n$ 阶对称矩阵组成 $\frac {n (n+1)}{2}$ 维线性空间

显然 $E_{ij}$ 是反对称矩阵，$E_{ij}$ 有 $\frac {n (n-1)}{2}$ 个，不难证明 $E_{ij}$ 是线性无关的，且任何一个反对称矩阵都可由这 $\frac {n (n-1)}{2}$ 个矩阵线性表示，即 $n$ 阶反对称矩阵组成 $\frac {n (n-1)}{2}$ 维线性空间

___

#### 例 6

在 $\mathbb {R}^4$ 中，求向量 $\alpha=(1, 2, 1, 1)^T$ 在基

$$
\begin{aligned}
&\alpha_1=(1,1,1,1)^T,\ \ \alpha_2=(1, 1, -1, -1)^T\\
&\alpha_3=(1, -1, 1, -1)^T, \ \ \alpha_4 = (1, -1, -1, 1)^T
\end{aligned}
$$

下的坐标

**解：**问题实际上可以转化为求方程 $\alpha=x_1\alpha_1+x_2\alpha_2+x_3\alpha_3+x_4\alpha_4$ 的解，即

$$
\begin{bmatrix}
1\\2\\1\\1
\end{bmatrix}=x_1\begin{bmatrix}
1\\1\\1\\1
\end{bmatrix}+x_2\begin{bmatrix}
1\\1\\-1\\-1
\end{bmatrix}+x_3\begin{bmatrix}
1\\-1\\1\\-1
\end{bmatrix}+x_4\begin{bmatrix}
1\\-1\\-1\\1
\end{bmatrix}\\
\Rightarrow
\left[ {\begin{array}{c:c}
\begin{matrix}
1 & 1 & 1 & 1 \\
1 & 1 & -1 & -1\\
1 & -1 & 1 & -1 \\
1 & -1 & -1 & 1\\
\end{matrix}&
\begin{matrix}
1 \\
2 \\
1 \\
1 \\
\end{matrix}
\end{array}} \right]
\Rightarrow
\left[ {\begin{array}{c:c}
\begin{matrix}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0\\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1\\
\end{matrix}&
\begin{matrix}
\frac{5}{4} \\
\frac{1}{4} \\
-\frac{1}{4} \\
-\frac{1}{4} \\
\end{matrix}
\end{array}} \right]
$$

求得 $[x_1,x_2,x_3,x_4]^T=[\frac {5}{4},\frac {1}{4},-\frac {1}{4},-\frac {1}{4}]^T$

___

#### 例 7

在 $\mathbb {R}^{2\times 2}$ 中求矩阵 $A=\begin {bmatrix} 1&2\\0&3\end {bmatrix}$ 在基

$$
E_1=\begin{bmatrix}1&1\\1&1\end{bmatrix},\ \ E_2=\begin{bmatrix}1&1\\1&0\end{bmatrix}\\
E_3=\begin{bmatrix}1&1\\0&0\end{bmatrix},\ \ 
E_4=\begin{bmatrix}1&0\\0&0\end{bmatrix}
$$

下的坐标

**解：**设 $A=x_1E_1+x_2E_2+x_3E_3+x_4E_4$，即

$$
\left[\begin{array}{ll}
1 & 2 \\
0 & 3
\end{array}\right]=x_{1}\left[\begin{array}{ll}
1 & 1 \\
1 & 1
\end{array}\right]+x_{2}\left[\begin{array}{ll}
1 & 1 \\
1 & 0
\end{array}\right]+x_{3}\left[\begin{array}{ll}
1 & 1 \\
0 & 0
\end{array}\right]+x_{4}\left[\begin{array}{ll}
1 & 0 \\
0 & 0
\end{array}\right]
$$

故

$$
\left[\begin{array}{ll}
1 & 2 \\
0 & 3
\end{array}\right]=\left[\begin{array}{cc}
x_{1}+x_{2}+x_{3}+x_{1} & x_{1}+x_{2}+x_{3} \\
x_{1}+x_{2} & x_{1}
\end{array}\right]
$$

于是

$$
\begin{cases}
x_1+x_2+x_3+x_4=1\\
x_1+x_2+x_3=2\\
x_1+x_2=0\\
x_1=3
\end{cases}
\Rightarrow \begin{cases}
x_1=3\\
x_2=-3\\
x_3=2\\
x_4=-1
\end{cases}
$$

即 $A$ 在 $E_1,E_2,E_3,E_4$ 下的坐标为 $(3,-3,2,-1)^T$

___

#### 例 8

试证：在 $\mathbb {R}^{2\times 2}$ 中矩阵

$$
\alpha_{1}=\left[\begin{array}{ll}
1 & 1 \\
1 & 1
\end{array}\right], \alpha_{2}=\left[\begin{array}{ll}
1 & 1 \\
0 & 1
\end{array}\right], \alpha_{3}=\left[\begin{array}{ll}
1 & 1 \\
1 & 0
\end{array}\right], \alpha_{4}=\left[\begin{array}{ll}
1 & 0 \\
1 & 1
\end{array}\right]
$$

线性无关，并求 $\alpha=\begin {bmatrix} a&b\\c&d\end {bmatrix}$ 在基 $\alpha_1,\alpha_2,\alpha_3,\alpha_4$ 下的坐标

**解：**设 $k_1\alpha_1+k_2\alpha_2+k_3\alpha_3+k_4\alpha_4=0$，即

$$
\begin{array}{r}
k_{1}\left[\begin{array}{ll}
1 & 1 \\
1 & 1
\end{array}\right]+k_{2}\left[\begin{array}{ll}
1 & 1 \\
0 & 1
\end{array}\right]+k_{3}\left[\begin{array}{ll}
1 & 1 \\
1 & 0
\end{array}\right]+k_{4}\left[\begin{array}{ll}
1 & 0 \\
1 & 1
\end{array}\right] \\
=\left[\begin{array}{cc}
k_{1}+k_{2}+k_{3}+k_{4} & k_{1}+k_{2}+k_{3} \\
k_{1}+k_{3}+k_{4} & k_{1}+k_{2}+k_{4}
\end{array}\right]=0
\end{array}
$$

于是

$$
\begin{cases}
k_1+k_2+k_3+k_4=0\\
k_1+k_2+k_3=0\\
k_1+k_3+k_4=0\\
k_1+k_2+k_4=0
\end{cases}\Rightarrow \begin{cases}
k_1=0\\
k_2=0\\
k_3=0\\
k_4=0
\end{cases}
$$

故 $\alpha_1,\alpha_2,\alpha_3,\alpha_4$ 线性无关

设

$$
\begin{aligned}
\left[\begin{array}{ll}
a & b \\
c & d
\end{array}\right] &=x_{1}\left[\begin{array}{ll}
1 & 1 \\
1 & 1
\end{array}\right]+x_{2}\left[\begin{array}{ll}
1 & 1 \\
0 & 1
\end{array}\right]+x_{3}\left[\begin{array}{ll}
1 & 1 \\
1 & 0
\end{array}\right]+x_{4}\left[\begin{array}{ll}
1 & 0 \\
1 & 1
\end{array}\right] \\
&=\left[\begin{array}{ll}
x_{1}+x_{2}+x_{3}+x_{4} & x_{1}+x_{2}+x_{3} \\
x_{1}+x_{3}+x_{1} & x_{1}+x_{2}+x_{4}
\end{array}\right]
\end{aligned}
$$

于是

$$
\begin{cases}
x_1+x_2+x_3+x_4=a\\
x_1+x_2+x_3=b\\
x_1+x_3+x_4=c\\
x_1+x_2+x_4=d
\end{cases}\Rightarrow \begin{cases}
x_1=b+c+d-4a\\
x_2=a-c\\
x_3=a-d\\
x_4=a-b
\end{cases}
$$

$x_1,x_2,x_3,x_4$ 即为所求之坐标

___

#### 例 9

设 $R [x]_4$ 是所有次数小于 4 的实系数多项式组成的线性空间，求多项式 $p (x)=1+2x^3$ 在基 $1,x-1,(x-1)^2,(x-1)^3$ 下的坐标

**解：方法一：**用线性空间理论计算

$$
p(x)=1+2x^3=[1, x, x^2, x^3]\begin{bmatrix}1\\ 0\\ 0\\ 2\end{bmatrix} \\
=[1, x - 1, (x-1)^2, (x-1)^3]\begin{bmatrix}y_1 \\ y_2\\ y_3\\ y_4 \end{bmatrix}
$$

又由于

$$
[1, x - 1, (x-1)^2, (x-1)^3]\\
=[1, x, x^2, x^3]\begin{bmatrix}1 & -1 & 1 &-1\\ 0 & 1 & -2 & 3\\ 0 & 0  & 1 & -3 \\ 0 & 0 & 0 & 1\end{bmatrix}
$$

于是 $p (x)$ 在基 $1, x-1,(x-1)^2, (x-1)^3$ 下的坐标为

$$
\begin{bmatrix}y_1 \\ y_2\\ y_3\\ y_4 \end{bmatrix}=\begin{bmatrix}1 & -1 & 1 &-1\\ 0 & 1 & -2 & 3\\ 0 & 0  & 1 & -3 \\ 0 & 0 & 0 & 1\end{bmatrix}^{-1}\begin{bmatrix}1 \\ 0 \\ 0 \\ 2\end{bmatrix} = \begin{bmatrix}3\\ 6\\ 6\\ 2\end{bmatrix}
$$

**方法二：**将 $p (x)=1+2x^3$ 根据幂级数公式按 $x-1$ 展开可得

$$
\begin{align}
p(x)&=1+2x^3\\
&=p(1)+p(1)(x-1)+\frac{p''(1)}{2!}(x-1)^2+\frac{p'''(1)}{3!}(x-1)^3\\
&=3+6(x-1)+6(x-1)^2+2(x-1)^3
\end{align}
$$

因此 $p (x)$ 在基 $1, x-1, (x-1)^2, (x-1)^3$ 下的坐标为 $[3, 6, 6, 2]^T$

___

#### 过渡矩阵

设 $(\alpha_1 \; \alpha_2 \; ... \; \alpha_n)$ 和 $(\beta_1 \; \beta_2 \; ... \; \beta_n)$ 是 $n$ 维线性空间 $V_n (F)$ 中的两个基，则有 $A\in F$

$$
(\beta_1 \; \beta_2 \; ... \; \beta_n) = (\alpha_1 \; \alpha_2 \; ... \; \alpha_n)A
$$

其中 $A$ 称为从基 $(\alpha_1 \; \alpha_2 \; ... \; \alpha_n)$ 到 $(\beta_1 \; \beta_2 \; ... \; \beta_n)$ 的**过渡矩阵**

___

几个过渡矩阵的定理：

1.  过渡矩阵可逆
2.  $\{\alpha_i\}$ 到 $\{\beta_j\}$ 的过渡矩阵是 $A$，则 $\{\beta_j\}$ 到 $\{\alpha_i\}$ 的过渡矩阵是 $A^{-1}$
3.  给定一个可逆矩阵 $A$，以及一个基 $(\alpha_1,\alpha_2,...,\alpha_n)$，就可以找到另一个基
4.  若从基 $\alpha_1,...,\alpha_n$ 到基 $\beta_1,...,\beta_n$ 的过渡矩阵是 $A$，从基 $\beta_1,...,\beta_n$ 到基 $\gamma_1,...,\gamma_n$ 的过渡矩阵是 $B$，则从基 $\alpha_1,...,\alpha_n$ 到基 $\gamma_1,...,\gamma_n$ 的过渡矩阵是 $AB$

> **重要推论：设向量 $\eta$ 在基 $\alpha_1,...,\alpha_n$ 与基 $\beta_1,...,\beta_n$ 下对应坐标分别是 $X$ 和 $Y$，且从基 $\alpha_1,...,\alpha_n$ 到基 $\beta_1,...,\beta_n$ 的过渡矩阵是 $A$，即**：

$$
\begin{aligned}
\eta &= (\alpha_1 \; \alpha_2 \; ... \; \alpha_n)X\\
\eta &= (\beta_1 \; \beta_2 \; ... \; \beta_n)Y\\
(\beta_1,...,\beta_n)&=(\alpha_1,...,\alpha_n)A
\end{aligned}
$$

> **显然有：$\color {red}{X = AY}$**

___

过渡矩阵可逆证明如下：

反证法：假设 $A$ 不可逆，则方程 $Ax=0$ 有非零解。因为

$$
(\beta_1 \; \beta_2 \; ... \; \beta_n) = (\alpha_1 \; \alpha_2 \; ... \; \alpha_n)A
$$

两边同乘 $x$ 得

$$
(\beta_1 \; \beta_2 \; ... \; \beta_n)x = (\alpha_1 \; \alpha_2 \; ... \; \alpha_n)Ax=0
$$

因为向量 $(\beta_1 \; \beta_2 \; ... \; \beta_n)$ 是线性空间的一组基，所以它们线性无关，所以

$$
(\beta_1 \; \beta_2 \; ... \; \beta_n)x=0
$$

仅有零解，与假设矛盾，故 $A$ 可逆，证毕

___

#### 例 10

已知 $\mathbb {R}^4$ 中的两组基

$$
\begin{array}{l}
\alpha_{1}=[1,-1,0,0]^{\mathrm{T}}, \alpha_{2}=[0,1,-1,0]^{\mathrm{T}}, \\
\alpha_{3}=[0,0,1,-1]^{\mathrm{T}}, \alpha_{4}=[1,0,0,1]^{\mathrm{T}}
\end{array}
$$

与

$$
\begin{array}{l}
\beta_{1}=[2,1,-1,1]^{\mathrm{T}}, \beta_{2}=[0,3,1,0]^{\mathrm{T}} \\
\beta_{3}=[5,3,2,1]^{\mathrm{T}}, \beta_{4}=[6,6,1,3]^{\mathrm{T}}
\end{array}
$$

求：由基 $\alpha_1,\alpha_2,\alpha_3,\alpha_4$ 到基 $\beta_1,\beta_2,\beta_3,\beta_4$ 的过渡矩阵，并求向量 $\xi=[x_1,x_2,x_3,x_4]^T$ 在基 $\beta_1,\beta_2,\beta_3,\beta_4$ 下的坐标

**解；**设

$$
[\beta_1,\beta_2,\beta_3,\beta_4]=[\alpha_1,\alpha_2,\alpha_3,\alpha_4]P
$$

将 $\alpha_1,\alpha_2,\alpha_4,\alpha_4$ 与 $\beta_1,\beta_2,\beta_3,\beta_4$ 代入上式得

$$
\left[\begin{array}{rrrr}
2 & 0 & 5 & 6 \\
1 & 3 & 3 & 6 \\
-1 & 1 & 2 & 1 \\
1 & 0 & 1 & 3
\end{array}\right]=\left[\begin{array}{rrrr}
1 & 0 & 0 & 1 \\
-1 & 1 & 0 & 0 \\
0 & -1 & 1 & 0 \\
0 & 0 & 1 & 1
\end{array}\right] \boldsymbol{P}
$$

故过渡矩阵

$$
\begin{aligned}
P &=\left[\begin{array}{rrrr}
1 & 0 & 0 & 1 \\
-1 & 1 & 0 & 0 \\
0 & -1 & 1 & 0 \\
0 & 0 & -1 & 1
\end{array}\right]^{-1}\left[\begin{array}{rrrr}
2 & 0 & 5 & 6 \\
1 & 3 & 3 & 6 \\
-1 & 1 & 2 & 1 \\
1 & 0 & 1 & 3
\end{array}\right] \\
&=\left[\begin{array}{llll}
\frac{1}{2} & -2 & -\frac{1}{2} & -2 \\
\frac{3}{2} & 1 & \frac{5}{2} & 4 \\
\frac{1}{2} & 2 & \frac{9}{2} & 5 \\
\frac{3}{2} & 2 & \frac{11}{2} & 8
\end{array}\right]
\end{aligned}
$$

设

$$
\begin{aligned}
\xi=\left[\begin{array}{l}
x_1 \\
x_2 \\
x_3 \\
x_4
\end{array}\right]=\left(\beta_{1}, \beta_{2}, \beta_{3}, \beta_{4}\right)\left[\begin{array}{l}
y_{1} \\
y_{2} \\
y_{3} \\
y_{4}
\end{array}\right]
\end{aligned}
$$

将 $\beta_1,\beta_2,\beta_3,\beta_4$ 坐标代入上式后整理得

$$
\begin{aligned}
\left[\begin{array}{l}
y_{1} \\
y_{2} \\
y_{3} \\
y_{4}
\end{array}\right]&=\left[\begin{array}{rrrr}
2 & 0 & 5 & 6 \\
1 & 3 & 3 & 6 \\
-1 & 1 & 2 & 1 \\
1 & 0 & 1 & 3
\end{array}\right]^{-1}\left[\begin{array}{l}
x_1 \\
x_2 \\
x_3 \\
x_4
\end{array}\right]\\
&=\left[\begin{array}{rrrr}
\frac{4}{9}x_1 + \frac{1}{3}x_2  -x_3  -\frac{11}{9}x_4 \\
\frac{1}{27}x_1 + \frac{4}{9}x_2 -\frac{1}{3} x_3 -\frac{23}{27}x_4 \\
\frac{1}{3}x_1 -\frac{2}{3}x_4 \\
-\frac{7}{27}x_1 -\frac{1}{9}x_2 + \frac{1}{3}x_3 + \frac{26}{27}x_4
\end{array}\right]
\end{aligned}
$$

## 子空间

#### 线性子空间概念

**定义：**设 $W$ 是 $\mathbb {F}$ 上线性空间 $V$ 的一个非空子集，若 $W$ 关于 $V$ 的**加法**和**数乘**运算也构成线性空间，则称 $W$ 是 $V$ 的一个**线性子空间**，简称**子空间**

**（线性子空间的判定定理）：**设 $W$ 是 $\mathbb {F}$ 上线性空间 $V$ 的一个非空子集，则 $W$ 是 $V$ 的子空间的充要条件是：

1.  若 $\alpha, \beta \in W$，则 $\alpha + \beta \in W$
2.  若 $\alpha \in W, k \in \mathbb {F}$，则 $k\alpha \in W$

也就是说，只需要验证对**加法和数乘封闭**即可

> $\{0\}$ 和 $V$ 本身均是 $V$ 的子空间，且这两个子空间称为**平凡子空间**

___

#### 例 1

设 $A$ 为实数（或复数）$m\times n$ 矩阵，证明：齐次线性方程组 $Ax=0$ 的所有解（包括零解）的集合构成实（或复）数域 $\mathbb {R}$（或 $\mathbb {C}$）上的线性空间 $N (A)$

**证明：**设 $x_1, x_2\in N (A)$ 是齐次方程组 $Ax=0$ 的两个解，下面证明 $x_1+x_2\in N (A)$ 以及 $\lambda x\in N (A)$

因为 $A (x_1+x_2)=Ax_1+Ax_2=0$，所以 $x_1+x_2 \in N (A)$

又因为 $\lambda \in \mathbb {F}$，且 $A (\lambda x) = \lambda (Ax)=0$，所以 $\lambda x\in N (A)$

则齐次线性方程 $Ax=0$ 的所有解的集合构成数域 $\mathbb {F}$ 上的线性空间 $N (A)$

___

#### 生成子空间

**定义：**设 $\alpha_1, \alpha_2,...,\alpha_s$ 是数域 $F$ 上的线性空间 $V$ 中的向量组，则该向量组所有可能的线性组合所构成的集合

$$
W=\{k_1\alpha_1+k_2\alpha_2+···+k_s\alpha_s \mid k_1, k_2,...,k_s \in \mathbb{F}\}
$$

是 $V$ 的线性子空间，称为 $V$ 的生成子空间，记作 $W=\text {span}\{\alpha_1, \alpha_2,...,\alpha_s\}$ 或 $W=L (\alpha_1,\alpha_2,...,\alpha_s)$

反之，给定 $V$ 的一个线性子空间 $W$，若能找到向量组 $\beta_1,\beta_2,...,\beta_r$ 使得恰有 $W=\text {span}\{\beta_1,\beta_2,...,\beta_r\}$，则称向量组 $\alpha_1,\alpha_2,...,\alpha_r$ 为子空间 $W$ 的一个生成向量组，简称生成组

#### 生成子空间的性质

1.  $W=\text {span}\{\alpha_1, \alpha_2,...,\alpha_s\}$，则 $\alpha_1,\alpha_2, ..., \alpha_s \in W$
2.  $\text {span}\{\alpha_1, \alpha_2,...,\alpha_s\}=\text {span}\{\beta_1, \beta_2,...,\beta_t\}\Leftrightarrow \alpha_1, \alpha_2,...,\alpha_s$ 与 $\beta_1,\beta_2,...,\beta_t$ 等价
3.  $\alpha_1,\alpha_2,...,\alpha_s$ 的极大线性无关组是 $\text {span}\{\alpha_1,\alpha_2,...,\alpha_s\}$ 的基，故 $\dim (\text {span}\{\alpha_1,\alpha_2,...,\alpha_s\})=\mathrm {rank}(\alpha_1,\alpha_2,...,\alpha_s)$

#### 基扩张定理

设 $\{\alpha_1,\alpha_2,...,\alpha_r\}$ 是 $V^n$ 中一组线性无关向量，则 $V^n$ 中存在 $n-r$ 个向量 $\alpha_{r+1},\alpha_{r+2},...,\alpha_n$，使得

$$
\{\alpha_1, \alpha_2,...,\alpha_r,\alpha_{r+1},\alpha_{r+2},...,\alpha_n\}
$$

构成 $V^n$ 的基

**证明：**若 $r=n$，则结论显然成立

若 $r<n$，下证必然存在一向量 $\alpha_{r+1}\in V^n$，使得 $\alpha_1, \alpha_2,...,\alpha_r,\alpha_{r+1}$ 线性无关

反证法：若对任意的非零向量 $\beta \in V^n$，$\alpha_1, \alpha_2,...,\alpha_r,\beta$ 线性相关，则存在不全为 0 的数 $k_1,k_2,...,k_r,k$，使得

$$
k_1\alpha_1+k_2\alpha_2+···+k_r\alpha_r+k\beta=0
$$

显然 $k\neq 0$，所以有

$$
\beta = -\frac{k_1}{k}\alpha_1-\frac{k_2}{k}\alpha_2-···-\frac{k_r}{k}\alpha_r
$$

由此得到，$V^n$ 任意向量均能被 $\alpha_1,\alpha_2,...,\alpha_r$ 线性表示，这与 $r<n$ 矛盾

故若 $r<n$，必存在一向量 $\alpha_{r+1}\in V^n$，使得 $\alpha_1,\alpha_2,...,\alpha_r,\alpha_{r+1}$ 线性无关

若 $r+1=n$，则证明完毕

若 $r+1<n$，则重复上面过程即可

___

#### 例 2

设 $\alpha_1=(1,2,-1,0)^T,\alpha_2=(0,1,2,3)^T,\alpha_3=(2,3,-4,-3)^T$，求 $\text {span}\{\alpha_1,\alpha_2,\alpha_3\}$ 的一组基与维数

**解：**

$$
\begin{align*}
A &= \begin{bmatrix}\alpha_1, \alpha_2, \alpha_3\end{bmatrix} \\
&=\begin{bmatrix}1 & 0 & 2\\2 & 1 & 3\\ -1 & 2 & -4\\ 0 & 3 & -3 \end{bmatrix} \\
&\to \begin{bmatrix}1 & 0 & 2\\0 & 1 & -1\\ 0 & 0 & 0\\ 0 & 0 & 0 \end{bmatrix}
\end{align*}
$$

因为 $\alpha_1,\alpha_2$ 是线性无关的，且 $\alpha_3=2\alpha_1-\alpha_2$

所以 $\alpha_1,\alpha_2$ 为 $\text {span}\{\alpha_1,\alpha_2,\alpha_3\}$ 的一组基，$\dim (\text {span}\{\alpha_1,\alpha_2,\alpha_3\})=2$

___

#### 例 3

在 $\mathbb {F}^{2\times 2}$ 中

$$
A = \begin{bmatrix}1&2\\2&1\end{bmatrix},B=\begin{bmatrix}2&1\\1&1\end{bmatrix},C=\begin{bmatrix}1&1\\1&1\end{bmatrix},D=\begin{bmatrix}-1&1\\-1&1\end{bmatrix}
$$

求 $W=L (A,B,C,D)$ 的一组基

**解：**

$$
\begin{aligned}
(A,B,C,D)&=\begin{bmatrix}1&2&1&-1\\2&1&1&1\\2&1&1&-1\\1&1&1&1\end{bmatrix}\\
&\to \begin{bmatrix}1&2&1&-1\\0&-3&-1&3\\0&0&\frac{1}{3}&1\\0&0&0&1\end{bmatrix}
\end{aligned}
$$

因为 $A,B,C,D$ 是线性无关的，所以 $A,B,C,D$ 为 $L (A,B,C,D)$ 的一组基，$\dim (L (A,B,C,D))=4$

___

#### 例 4

已知

$$
\begin{array}{ll}
\alpha_{1}=(1,2,1,0)^{\mathrm{T}}, & \alpha_{2}=(-1,1,1,1)^{\mathrm{T}} \\
\boldsymbol{\beta}_{1}=(2,-1,0,1)^{\mathrm{T}}, & \boldsymbol{\beta}_{2}=(1,-1,3,7)^{\mathrm{T}}
\end{array}
$$

求 $\text {span}\{\alpha_1,\alpha_2\}$ 与 $\text {span}\{\beta_1,\beta_2\}$ 的和与交的基和维数

**解：**因为 $\text {span}\{\alpha_1,\alpha_2\}+\text {span}\{\beta_1,\beta_2\}=\text {span}\{\alpha_1,\alpha_2,\beta_1,\beta_2\}$

由于秩 $\{\alpha_1,\alpha_2,\beta_1,\beta_2\}=3$，且 $\alpha_1,\alpha_2,\beta_1$ 是向量 $\alpha_1,\alpha_2,\beta_1,\beta_2$ 的一个极大线性无关组，所以和空间的维数是 3，基为 $\alpha_1,\alpha_2,\beta_1$

**方法一：**设 $\xi \in \text {span}\left\{\alpha_{1}, \alpha_{2}\right\} \cap \text {span}\left\{\beta_{1}, \beta_{2}\right\}$，由交空间定义可知

$$
\xi=k_{1} \alpha_{1}+k_{2} \alpha_{2}=k_{3} \beta_{1}+k_{4} \beta_{2}
$$

即

$$
k_{1}\left[\begin{array}{l}
1 \\
2 \\
1 \\
0
\end{array}\right]+k_{2}\left[\begin{array}{r}
-1 \\
1 \\
1 \\
1
\end{array}\right]+k_{3}\left[\begin{array}{r}
-2 \\
1 \\
0 \\
-1
\end{array}\right]+k_{4}\left[\begin{array}{r}
-1 \\
1 \\
-3 \\
-7
\end{array}\right]=0
$$

解得

$$
k_{1}=-k_{4}, k_{2}=4k_{4}, k_{3}=-3 k_{4}\left (k_{4} \text { 为任意数 }\right)
$$

于是

$$
\xi=k_1\alpha_1+k_2\alpha_2=k_4[-5,2,3,4]^T
$$

显然 $\xi=k_3\beta_1+k_4\beta_2$，所以交空间的维数为 1，基为 $[-5,2,3,4]^T$

**方法二：**不难知

$$
\text{span}\left\{\alpha_{1}, \alpha_{2}\right\}=\text{span}\left\{\alpha_{1}, \alpha_{2}^{\prime}\right\}, \text{span}\left\{\beta_{1}, \beta_{2}\right\}=\text{span}\left\{\beta_{1}, \beta_{2}^{\prime}\right\}
$$

其中 $\alpha^{\prime}=[-2,-2,0,1]^T,\beta^{\prime}=[-\frac {13}{3},2,1,0]^T$，又 $\text {span}\{\alpha_1,\alpha_2^{\prime}\}$ 也是线性方程组

$$
\left\{\begin{array}{l}
x_{1}=x_{3}-2 x_{4} \\
x_{2}=2 x_{1}-x_{4}
\end{array}\right.
$$

的解空间，$\text {span}\{\beta_1,\beta_{2}^{\prime}\}$ 是线性方程组

$$
\left\{\begin{array}{l}
x_{1}=-\frac{13}{3} x_{3}+2 x_{4} \\
x_{2}=2 x_{3}-x_{4}
\end{array}\right.
$$

的解空间，所以所求的交空间就是线性方程组

$$
\left\{\begin{array}{l}
x_{1}=  x_{3}-2 x_{4} \\
x_{2}=  2 x_{3}-x_{4} \\
x_{1}=-\frac{13}{3} x_{3}+2 x_{4} \\
x_{2}=  2 x_{3}-x_{4}
\end{array}\right.
$$

的解空间，容易求出其基础解系为 $[-5,2,3,4]^T$，所以交空间的维数为 1，基为 $[-5,2,3,4]^T$

___

#### 子空间的交与和

设 $U,W$ 是 $V$ 的子空间

1.  $U\cap W=\{\alpha\mid \alpha \in U\  \&\  \alpha \in W\}$ 也是 $V$ 的子空间，称为 $U,W$ 的交空间
2.  $U+W=\{\alpha_1+\alpha_2\mid \alpha_1\in U\ \& \ \alpha_2\in W\}$ 也是 $V$ 的子空间，称为 $U,W$ 的和空间

**定理：**设

$$
U=\text{span}\{\alpha_1,\alpha_2,...,\alpha_s\}\\
W=\text{span}\{\beta_1,\beta_2,...,\beta_t\}
$$

则 $U+W=\text {span}\{\alpha_1, ...,\alpha_s,\beta_1,...,\beta_t\}$

**定理（维数公式）：**设 $U$ 和 $W$ 是线性空间 $V$ 的两个子空间，则

$$
\begin{aligned}
&\dim(U)+\dim(W)=\dim(U+W)+\dim(U\cap W)\\
&\dim (U \cap W) \leqslant \dim(U) = \dim(W) \leqslant \dim(U + W) \leqslant \dim (V)
\end{aligned}
$$

___

#### 例 5

设 $\mathbb {F}^{2\times 2}$ 子空间

$$
V_1=\{\begin{bmatrix}x&x\\y&y\end{bmatrix}\mid x, y\in \mathbb{F}\}\\
V_2=\{\begin{bmatrix}x&y\\-y&-x\end{bmatrix}\mid x,y\in \mathbb{F}\}
$$

求 $V_1,V_2,V_1+V_2$ 及 $V_1\cap V_2$ 的基和维数

**解：**

很明显可知 $V_1$ 的一组基是 $A=\begin {bmatrix} 1&1\\0&0\end {bmatrix},B=\begin {bmatrix} 0&0\\1&1\end {bmatrix}$，则 $V_1=\text {span}\{A,B\}$

$V_2$ 的一组基是 $C=\begin {bmatrix} 1&0\\0&-1\end {bmatrix},D=\begin {bmatrix} 0&1\\-1&0\end {bmatrix}$，则 $V_2=\text {span}\{C,D\}$

因为 $V_1+V_2=\text {span}\{A,B,C,D\}$，所以 $V_1+V_2$ 的一组基就是 $(A,B,C,D)$ 的极大线性无关组

$$
\begin{aligned}
(A,B,C,D)&=\begin{bmatrix}1&0&1&0\\1&0&0&1\\0&1&0&-1\\0&1&-1&0\end{bmatrix}\\
&\to \begin{bmatrix}1&0&1&0\\0&1&0&-1\\0&0&1&-1\\0&0&0&0\end{bmatrix}
\end{aligned}
$$

故 $V_1+V_2$ 的一组基是 $(A,B,C)$，且 $\dim (V_1+V_2)=3$

根据维数定理 $\dim (V_1\cap V_2)=1$，由分析得 $V_1\cap V_2=\text {span}\{\begin {bmatrix} x&x\\-x&-x\end {bmatrix}\mid x\in \mathbb {F}\}$，

___

#### 例 6

设

$$
\alpha_1=(1,2,1,0)^T,\alpha_2=(-1,1,1,1)^T,\beta_1=(2, -1,0,1)^T,\beta_2=(1,-1,3,7)^T\\
V_1=\text{span}\{\alpha_1,\alpha_2\},V_2=\text{span}\{\beta_1,\beta_2\}
$$

求 $\mathbb {F}^{4}$ 的子空间 $V_1+V_2,V_1\cap V_2$ 的基与维数

**解：**因为 $V_1+V_2=\text {span}\{\alpha_1,\alpha_2,\beta_1,\beta_2\}$，所以 $V_1+V_2$ 的一组基就是 $(\alpha_1,\alpha_2,\beta_1,\beta_2)$ 的极大线性无关组

$$
\begin{aligned}
(\alpha_1,\alpha_2,\beta_1,\beta_2)&=\begin{bmatrix}1&-1&2&1\\2&1&-1&-1\\1&1&0&3\\0&1&1&7\end{bmatrix}\\
&\to\begin{bmatrix}1&-1&2&1\\0&3&-5&-3\\0&0&1&3\\0&0&0&0\end{bmatrix}
\end{aligned}
$$

故 $V_1+V_2$ 的一组基是 $(\alpha_1,\alpha_2,\beta_1)$，且 $\dim (V_1+V_2)=3$

设 $\xi \in V_1\cap V_2$，则 $\xi=k_1\alpha_1+k_2\alpha_2=k_3\beta_1+k_4\beta_2$，即

$$
\begin{bmatrix}1&-1&-2&-1\\2&1&1&1\\1&1&0&-3\\0&1&-1&-7\end{bmatrix}\begin{bmatrix}k_1\\k_2\\k_3\\k_4\end{bmatrix}=0\\
\Rightarrow \begin{cases}k_1=-k_4\\k_2=4k_4\\k_3=-3k_4\end{cases}
$$

故 $\xi=\alpha_1-4\alpha_2=3\beta_1-\beta_2$，所以 $V_1\cap V_2$ 的一组基为 $[5,-2,-3,-4]^T$，维数为 1

___

#### 例 7

已知

$$
A=\begin{bmatrix}1&1&1&1\\1&-1&2&2\\3&1&4&4\end{bmatrix},B=\begin{bmatrix}1&2&1&1\\2&1&2&2\end{bmatrix}\\
V_1=\{x\in \mathbb{F}^4\mid Ax=0\},V_2=\{x\in \mathbb{F}^4\mid Bx=0\}
$$

求 $V_1\cap V_2,V_1+V_2$ 的基与维数

**解：**

$V_1\cap V_2$ 的基就是线性方程组

$$
\begin{cases}
x_1+x_2+x_3+x_4=0\\
x_1-x_2+2x_3+2x_4=0\\
3x_1+x_2+4x_3+4x_4=0\\
x_1+2x_2+x_3+x_4=0\\
2x_1+x_2+2x_3+2x_4=0
\end{cases}
$$

的基础解系。解得其基础解系为 $\sigma=[0,0,-1,1]^T$，故 $V_1\cap V_2$ 的一组基为 $\sigma$，$\dim (V_1\cap V_2)=1$

$V_1$ 的基为 $Ax=0$ 的基础解系，即

$$
\begin{aligned}
\begin{bmatrix}1&1&1&1\\1&-1&2&2\\3&1&4&4\end{bmatrix}\begin{bmatrix}x_1\\x_2\\x_3\\x_4\end{bmatrix}=0\\
\Rightarrow \begin{cases}\eta_1=[-3,1, 2,0]^T\\\eta_2=[-3,1,0,2]^T\end{cases}
\end{aligned}
$$

$V_2$ 的基为 $Bx=0$ 的基础解系，即

$$
\begin{bmatrix}1&2&1&1\\2&1&2&2\end{bmatrix}\begin{bmatrix}x_1\\x_2\\x_3\\x_4\end{bmatrix}=0\\
\Rightarrow \begin{cases}\xi_1=[-1,0,0,1]^T\\\xi_2=[-1,0,1,0]\end{cases}
$$

$V_1+V_2=\text {span}\{\eta_1,\eta_2,\xi_1,\xi_2\}$，即对 $\{\eta_1,\eta_2,\xi_1,\xi_2\}$ 作初等行变换

$$
[\eta_1,\eta_2,\xi_1,\xi_2]=\begin{bmatrix}-3&-3&-1&-1\\1&1&0&0\\2&0&0&1\\0&2&1&0\end{bmatrix}\\
\to \begin{bmatrix}-3&-3&-1&-1\\0&-6&-2&1\\0&0&1&1\\0&0&0&0\end{bmatrix}
$$

故 $V_1+V_2$ 的基为 $\eta_1,\eta_2,\xi_1$，且 $\dim (V_1+V_2)=3$

___

#### 例 8

已知 $V_1$ 是齐次线性方程组

$$
\text { (I) }\left\{\begin{array}{l}
x_{1}-2 x_{2}-x_{3}-x_{4}=0 \\
5 x_{1}-10 x_{2}-6 x_{3}-4 x_{4}=0
\end{array}\right.
$$

的解空间，$V_2$ 是齐次线性方程组

$$
\text { (II) } x_{1}-x_{2}+x_{3}+2 x_{4}=0
$$

的解空间，试求

（1）$V_1$ 与 $V_2$ 的基与维数

（2）$V_1\cap V_2$ 的基与维数

（3）$V_1+V_2$ 的基与维数

**解：**

（1）线性方程组 $\text {(I) }$  的基础解系为

$$
\left\{\begin{array}{l}
\xi_1=[2, 1, 0, 0]^T\\
\xi_2=[2, 0, 1, 1]^T
\end{array}\right.
$$

故 $V_1$ 的基是 $\xi_1,\xi_2$，维数为 2

线性方程组 $\text {(II) }$  的基础解系（及基）为

$$
\left\{\begin{array}{l}
\eta_{1}=[1,1,0,0]^T \\
\eta_{2}=[-1,0,1,0]^T \\
\eta_{3}=[-2,0,0,1]^T
\end{array}\right.
$$

维数为 3

（2）设 $V_1\cap V_2$ 的基就是线性方程组

$$
\left\{\begin{array}{l}
x_{1}-2 x_{2}-x_{3}-x_{4}=0 \\
5 x_{1}-10 x_{2}-6 x_{3}-4 x_{4}=0\\
x_{1}-x_{2}+x_{3}+2 x_{4}=0
\end{array}\right.
$$

的基础解系。解得其基础解系为

$$
\sigma=[-8,-5,1,1]^T
$$

故 $V_1\cap V_2$ 的基为 $\sigma$，维数为 1

（3）$V_1+V_2=\text {span}\{\xi_1, \xi_2,\eta_1,\eta_2,\eta_3\}$，即对 $\{\xi_1,\xi_2,\eta_1,\eta_2,\eta_3\}$ 作初等行变换

$$
[\xi_1,\xi_2,\eta_1,\eta_2,\eta_3]=\begin{bmatrix}2&2&1&-1&-2\\1&0&1&0&0\\1&1&0&1&0\\0&1&0&0&1\end{bmatrix}\rightarrow\begin{bmatrix}1&0&0&0&0\\0&1&0&0&0\\0&0&1&0&0\\0&0&0&1&0\end{bmatrix}
$$

故 $V_1+V_2$ 的基为 $[1, 0, 0, 0]^T,[0, 1, 0, 0]^T,[0, 0,1, 0]^T,[0, 0, 0, 1]^T$，维数为 4

___

#### 例 9

已知 $V_1$ 是齐次线性方程组

$$
\left\{\begin{array}{l}
x_{1}-x_{2}+5 x_{3}-x_{4}=0 \\
x_{1}+x_{2}-2 x_{3}+3 x_{4}=0
\end{array}\right.
$$

的解空间，$V_2=\text {span}\{\alpha_1,\alpha_2,\alpha_3\}$，其中 $\alpha_{1}=(-3,-1,1,0)^{T},\alpha_{2}=(4,3,-1,-1)^{T},\alpha_{3}=(-2,1,1,-1)^{T}$，试求

（1）$V_1$ 与 $V_2$ 的基与维数

（2）$V_1\cap V_2$ 的基与维数

（3）$V_1+V_2$ 的基与维数

**解：**

（1）$V_1$ 的基即齐次线性方程组的基础解系

$$
\left\{\begin{array}{l}
\xi_1=[-3, 7, 2, 0]^T\\
\xi_2=[-1, -2, 0, 1]^T
\end{array}\right.
$$

故 $V_1$ 的基为 $\xi_1,\xi_2$，维数为 2

对 $(\alpha_1,\alpha_2,\alpha_3)$ 作初等行变换得

$$
\left[\begin{array}{ccc}
-3 & 4 & -2 \\
-1 & 3 & 1 \\
1 & -1 & 1 \\
0 & -1 & -1
\end{array}\right]\rightarrow\left[\begin{array}{ccc}
1 & 0 & 2 \\
0 & 1 & 1 \\
0 & 0 & 0 \\
0 & 0 & 0
\end{array}\right]
$$

即 $\alpha_1,\alpha_2$ 为 $V_2$ 的基，维数为 2

（2）设 $\xi\in V_1\cap V_2$，则 $\xi=k_1\xi_1+k_2\xi_2=k_3\alpha_1+k_4\alpha_2$，即

$$
\left[\begin{array}{cccc}
-3 & -1 & 3 & -4 \\
7 & -2 & 1 & -3 \\
2 & 0 & -1 & 1 \\
0 & 1 & 0 & 1    
\end{array}\right]\left[\begin{array}{c}
k_{1} \\
k_{2} \\
k_{3} \\
k_{4}
\end{array}\right]=0\\
\Rightarrow \left\{\begin{array}{l}
k_1=0\\
k_3=-k_2\\
k_4=-k_2\\
\end{array}\right.
$$

故 $\xi=-\xi_2=\alpha_1+\alpha_2$，所以 $V_1\cap V_2$ 的一组基为 $[1,-2,0,-1]^T$，维数为 1

（3）$V_1+V_2=\text {span}\{\xi_1,\xi_2,\alpha_1,\alpha_2\}$，即对 $\{\xi_1,\xi_2,\alpha_1,\alpha_2\}$ 作初等行变换

$$
(\xi_{1},\xi_{2}, \alpha_{1}, \alpha_{2})=\left[\begin{array}{ccc}
-3 & -1 & -3 & 4 \\
7 & -2 & -1 & 3 \\
2 & 0 & 1 & -1 \\
0 & 1 & 0 & -1    
\end{array}\right] \rightarrow\left[\begin{array}{cccc}
1 & 0 & 0 & 0 \\
0 & 1 & 0 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 0
\end{array}\right]
$$

故 $V_1+V_2$ 的基为 $\xi_1,\xi_2,\alpha_1$，维数为 3

___

#### 例 10

已知 $V_1=\text {span}\{\alpha_1,\alpha_2,\alpha_3\},V_2=\text {span}\{\beta_1,\beta_2\}$，其中

$$
\begin{array}{c}
\alpha_{1}=(1,2,1,0)^{T} \quad \alpha_{2}=(-1,1,0,1)^{T} \quad \alpha_{3}=(1,5,2,1)^{T} \\
\beta_{1}=(0,1,2,1)^{T} \quad \beta_{2}=(0,5,10,5)^{T}
\end{array}
$$

试求：

（1）$V_1$ 与 $V_2$ 的基与维数

（2）$V_1\cap V_2$ 的基与维数

（3）$V_1+V_2$ 的基与维数

**解：**

（1）对 $(\alpha_1,\alpha_2,\alpha_3)$ 作初等行变换得

$$
\left(\alpha_{1}, \alpha_{1}, \alpha_{3}\right)=\left[\begin{array}{ccc}
1 & -1 & 1 \\
2 & 1 & 5 \\
1 & 0 & 2 \\
0 & 1 & 1
\end{array}\right] \rightarrow\left[\begin{array}{lll}
1 & 0 & 2 \\
0 & 1 & 1 \\
0 & 0 & 0 \\
0 & 0 & 0
\end{array}\right]
$$

所以 $V_1$ 的基为 $\alpha_1,\alpha_2$，维数为 2

对 $(\beta_1,\beta_2)$ 作初等行变换得

$$
\left(p_{1}, \beta_{i}\right)=\left[\begin{array}{ll}
0 & 0 \\
1 & 5 \\
2 & 10 \\
1 & 5
\end{array}\right] \rightarrow\left[\begin{array}{ll}
1 & 5 \\
0 & 0 \\
0 & 0 \\
0 & 0
\end{array}\right]
$$

故 $V_2$ 的基为 $\beta_1$ 或 $\beta_2$，维数为 1

（2）设 $\xi\in V_1\cap V_2=\text {span}\{\alpha_1,\alpha_2\}\cap \text {span}\{\beta_1\}$，则

$$
\xi = k_1\alpha_1+k_2\alpha_2=k_3\beta_1
$$

即

$$
k_1\alpha_1+k_2\alpha_2-k_3\beta_1=0\\
\Rightarrow \left[\begin{array}{lll}
1 & -1 & 0 \\
2 & 1 & -1 \\
1 & 0 & -2 \\
0 & 1 & -1
\end{array}\right]\left[\begin{array}{lll}
k_1 \\
k_2 \\
k_3 \\
\end{array}\right]=0\\ \Rightarrow\left\{\begin{array}{l}
k_1=0\\
k_2=0\\
k_3=0
\end{array}\right.
$$

故 $V_1\cap V_2$ 是零空间，无基，0 维

（3）$V_1+V_2=\text {span}\{\alpha_1,\alpha_2,\beta_1\}$，即对 $(\alpha_1,\alpha_2,\beta_1)$ 作初等行变换

$$
(\alpha_1,\alpha_2,\beta_1)=\left[\begin{array}{ccc}
1 & -1 & 0 \\
2 & 1 & 1 \\
1 & 0 & 2 \\
0 & 1 & 1
\end{array}\right] \rightarrow\left[\begin{array}{lll}
1 & 0 & 0 \\
0 & 1 & 0 \\
0 & 0 & 1 \\
0 & 0 & 0
\end{array}\right]
$$

故 $V_1+V_2$ 的基为 $\alpha_1,\alpha_2,\beta_1$，维数为 3

___

#### 子空间的直和

设 $W_1+W_2$ 中的任一向量只能**唯一**地分解为 $W_1$ 中的一个向量与 $W_2$ 中的一个向量之和，则称 $W_1+W_2$ 为 $W_1$ 与 $W_2$ 的直和，记为 $W_1\oplus W_2$

#### 直和中元素的唯一分解性

设 $W_1\oplus W_2=W$，若 $w=w_1+w_2, w = w^{\prime}_1+w^{\prime}_2$，其中

$$
\begin{align*}
w&\in W\\
w_1, w^{\prime}_1&\in W_1\\
w_2, w^{\prime}_2&\in W_2
\end{align*}
$$

则必有 $w_1=w^{\prime}_1, w_2=w^{\prime}_2$

**证明：**由 $w=w_1+w_2, w=w^{\prime}_1+w^{\prime}_2$ 有 $w_1-w^{\prime}_1=w^{\prime}_2-w_2$

由 $w_1,w^{\prime}_1\in W_1$ 及 $w_2,w^{\prime}_2\in W_2$ 有 $w_1-w^{\prime}_1\in W_1$ 及 $w^{\prime}_2-w_2\in W_2$

因此 $w_1-w^{\prime}_1=w^{\prime}_2-w_2\in W_1\cap W_2$

从而由 $W_1\cap W_2 = \{0\}$ 知 $w_1=w^{\prime}_1,w_2=w^{\prime}_2$

#### 直和的性质

设 $W_1,W_2$ 是线性空间 $V$ 的两个子空间，则下列命题等价：

1.  $W_1+W_2$ 是直和
2.  $0$ 的分解唯一
3.  $W_1\cap W_2=\{0\}$
4.  $\dim (W_1+W_2)=\dim(W_1)+\dim(W_2)$
5.  $W_1,W_2$ 的基合在一起构成 $W_1+W_2$ 的基

#### \* 多个子空间的直和

设 $W_1,W_2,...,W_s$ 是 $W$ 的 $s$ 个子空间，若 $\forall \eta \in W_1+W_2+・・・+W_s$，且存在**唯一**的 $\eta_i\in W_i,i=1,2,...,s$，使得 $\eta=\sum_{i=1}^s\eta_i$，则称 $W_1+W_2+・・・+W_s$ 是直和，记为 $W_1\oplus W_2\oplus・・・\oplus W_s$

#### 多个子空间直和的性质

设 $W_1,...,W_s$ 是线性空间 $W$ 的 $s$ 个子空间，则下列命题等价

1.  $W_1+W_2+・・・+W_s$ 是直和
2.  $0$ 的分解唯一
3.  $V_j\cap \sum_{i\neq j}V_j =\{0\}$
4.  $\dim(\sum_{i=1}^sV_i)=\sum_{i=1}^s\dim(V_i)$
5.  将 $V_1,...,V_s$ 的基合在一起就是 $V_1+V_2+・・・+V_s$ 的基

> 第三条要注意下，$V_j\cap (V_1+V_2+・・・+V_{s-1}+V_{s+1}+・・・+V_s)={0}$

___

#### 例 11

已知 $\mathbb {F}^{n\times n}$ 的子空间 $V_1=\{A\mid A^T=A\},V_2=\{A\mid A^T=-A\}$

证明：$\mathbb {F}^{n\times n}=V_1\oplus V_2$

**解：**首先需要证明 $V_1+V_2$ 是直和，然后证明 $\mathbb {F}^{n\times n}=V_1+V_2$

设 $B\in V_1\cap V_2$，则 $B^T=B$，且 $B^T=-B$，因此 $B=-B\Rightarrow B=\mathbb {0}$，故 $V_1\cap V_2={0}$，则 $V_1+V_2$ 是直和

显然 $V_1+V_2\subseteq \mathbb {F}^{n\times n}$，因为两个 $n\times n$ 矩阵的和依然在 $\mathbb {F}^{n \times n}$ 中

现在要证 $\mathbb {F}^{n\times n}\subseteq V_1+V_2$，实际上就是要证明**任何一个矩阵都可以写成对称矩阵和反对称矩阵之和**

设 $C\in \mathbb {F}^{n\times n}$，因为 $(C+C^T)\in V_1$ 是对称矩阵，$(C-C^T)\in V_2$ 是反对称矩阵，且 $C=\frac {1}{2}(C+C^T)+\frac {1}{2}(C-C^T)$，所以 $\mathbb {F}^{n\times n}\subseteq V_1+V_2$

综上所述，$\mathbb {F}^{n\times n}=V_1\oplus V_2$

___

#### 例 12

设 $A\in \mathbb {F}^{n\times n}$，且 $A^2=A$，$V_1=\{x\in \mathbb {F}^{n}\mid Ax=0\}$，$V_2=\{x\in \mathbb {F}^n\mid Ax=x\}$

证明：$\mathbb {F}^n=V_1\oplus V_2$

**解：**

设 $x\in V_1\cap V_2$，则 $Ax=0$，且 $Ax=x$，因此 $x=0$，故 $V_1\cap V_2=0$，则 $V_1+V_2$ 是直和

显然 $V_1+V_2\subseteq \mathbb {F}^{n}$

设 $\eta \in \mathbb {F}^n$，则 $\eta -A\eta\in V_1$，因为 $A (\eta-A\eta)=A\eta-A^2\eta=0$

$A\eta \in V_2$，因为 $A (A\eta)=A^2\eta=A\eta$

又因为 $\eta=(\eta-A\eta)+A\eta$，所以 $\mathbb {F}^{n}\subseteq V_1+V_2$

综上所述，$\mathbb {F}^n=V_1\oplus V_2$

___

#### 例 13

设

$$
V_1 = \{\begin{bmatrix}x_1&x_2\\x_3&x_4\end{bmatrix}\in \mathbb{R}^{2\times 2}\mid 2x_1+3x_2-x_3=0, x_1+2x_2+3x_3-x_4=0\}\\
V_2 = \text{span}\{\begin{bmatrix}2&-1\\a+2&1\end{bmatrix},\begin{bmatrix}-1&2\\4&a+8\end{bmatrix}\}
$$

（1）求 $V_1$ 的一个基与维数

（2）当 $a$ 为何值时，$V_1+V_2$ 是直和？

**解：**

（1）解齐次线性方程组

$$
\begin{cases}
2x_1+3x_2-x_3=0\\
x_1+2x_2+3x_3-x_4=0
\end{cases}
$$

解得基础解系为 $[1, -1, -1, -4]^T, [-3, 2, 0, 1]^T$

所以 $\dim (V_1)=2$，其基是 $\begin {bmatrix} 1&-1\\-1&-4\end {bmatrix},\begin {bmatrix}-3&2\\0&1\end {bmatrix}$

（2）因为 $\dim (V_1)=2,\dim (V_2)=2$，由定理可知，若 $\dim (V_1+V_2)=4$，则 $V_1+V_2$ 是直和

而 $\dim (V_1+V_2)=4$ 的充要条件是

$$
\begin{bmatrix}1&-1\\-1&-4\end{bmatrix},\begin{bmatrix}-3&2\\0&1\end{bmatrix},\begin{bmatrix}2&-1\\a+2&1\end{bmatrix}\begin{bmatrix}-1&2\\4&a+8\end{bmatrix}
$$

线性无关，即矩阵 $\begin {bmatrix} 1&-3&2&-1\\-1&2&-1&2\\-1&0&a+2&4\\-4&1&1&a+8\end {bmatrix}$ 是满秩的

$$
\begin{bmatrix}1&-3&2&-1\\-1&2&-1&2\\-1&0&a+2&4\\-4&1&1&a+8\end{bmatrix}\to\begin{bmatrix}1&-3&2&-1\\0&-1&1&1\\0&0&a+1&0\\0&0&-2&a-7\end{bmatrix}
$$

所以当 $a\neq -1$ 且 $a\neq 7$ 时，$V_1+V_2$ 是直和

___

#### 补子空间

设 $V$ 是 $\mathbb {F}$ 上的线性空间，$V_1,V_2$ 是 $V$ 的子空间。若 $V_1\oplus V_2=V$，则称 $V_1,V_2$ 是互补的子空间，或 $V_2$ 是 $V_1$ 的补子空间

#### 任一子空间必有补子空间

设 $V$ 是 $\mathbb {F}$ 上的有限维线性空间，$V_1$ 是 $V$ 的子空间。则存在子空间 $V_2$，使得 $V_1\oplus V_2=V$，且 $V_2$ 不唯一

## 线性映射

#### 线性映射定义

设 $V_1,V_2$ 是数域 $\mathbb {F}$ 上两个线性空间，映射 $\mathscr {A}:V_1→V_2$，如果它保持加法和数乘法：

1.  $\forall \alpha_1, \alpha_2\in V_1$ 有 $\mathscr {A}(\alpha_1+\alpha_2)=\mathscr {A}(\alpha_1)+\mathscr {A}(\alpha_2)$
2.  $\forall \alpha \in V_1, k\in \mathbb {F}$ 有 $\mathscr {A}(\alpha・k)=\mathscr {A}(\alpha)・k$

则称 $\mathscr {A}$ 为从线性空间 $V_1$ 到 $V_2$ 的线性映射，如果 $V_1$ 和 $V_2$ 是同一个线性空间，则称 $\mathscr {A}$ 为**线性变换**。从 $V_1$ 到 $V_2$ 的所有线性映射构成的集合记为 $\mathscr {L}(V_1, V_2)$

例如，映射

$$
\mathscr{A}:\mathbb{R}^2→\mathbb{R}^2\\
\begin{bmatrix}
x_1\\ x_2
\end{bmatrix}\mapsto \begin{bmatrix}x_1+x_2 \\ x_1x_2\end{bmatrix}
$$

不是线性映射；映射

$$
\mathscr{B}:\mathbb{R}^3 \to \mathbb{R}^2\\

\begin{bmatrix}
x_1\\ x_2 \\ x_3
\end{bmatrix}\mapsto \begin{bmatrix}x_1+x_2-x_3 \\ 2x_1+3x_2\end{bmatrix}
$$

是线性映射

#### 线性映射的简单性质

1.  $\mathscr{A}(0)=0$
2.  $\mathscr {A}(\sum_{i=1}^sk_i\alpha_i)=\sum_{i=1}^sk_i\mathscr {A}(\alpha_i)$，其中 $\alpha_i \in V, k_i\in \mathbb {F}$
3.  设 $\alpha_1, \alpha_2,...,\alpha_s \in V_1 ,\alpha_1, \alpha_2,...,\alpha_s$ 线性相关，则 $\mathscr {A}(\alpha_1),\mathscr {A}(\alpha_2),...,\mathscr {A}(\alpha_s)$ 也线性相关
4.  若 $V=\text {span}\{\alpha_1,\alpha_2,...,\alpha_s\}$，则 $\mathscr {A}$ 的值域 $\mathscr {A}(V)=\text {span}\{\mathscr {A}(\alpha_1),...,\mathscr {A}(\alpha_s)\}$

现证明性质 (3)

事实上，由于 $\alpha_1,\alpha_2,...,\alpha_s$ 线性相关，不失一般性，不妨设

$$
\alpha_s = k_1\alpha_1 + k_2\alpha_2+···+k_{s-1}\alpha_{s-1}
$$

于是

$$
\mathscr{\alpha_s} = k_1\mathscr{\alpha_1}+k_2\mathscr{\alpha_2}+···+k_{s-1}\alpha_{\alpha_{s-1}}
$$

因此，$\mathscr {A}(\alpha_1), \mathscr {A}(\alpha_2),...,\mathscr {A}(\alpha_s)$ 线性相关

**特别要注意，若 $\alpha_1, \alpha_2, ..., \alpha_s \in V_1$ 线性无关，则 $\mathscr {A}(\alpha_1), \mathscr {A}(\alpha_2), ..., \mathscr {A}(\alpha_s)$ 不一定线性无关**

#### 线性变换的简单性质

设 $\mathscr {A,B,C}\in \mathscr {L}(V,V)$，且 $x\in V$，则

1.  （乘法的可结合性）$((\mathscr {A}\mathscr {B})\mathscr {C})(x)=(\mathscr {A}(\mathscr {B}\mathscr {C}))(x)$
2.  （线性映射的左分配律）$\mathscr {A}(\mathscr {B}+\mathscr {C})=\mathscr {A}\mathscr {B}+\mathscr {A}\mathscr {C}$
3.  （线性映射的右分配律）$(\mathscr {A}+\mathscr {B})\mathscr {C}=\mathscr {A}\mathscr {C}+\mathscr {B}\mathscr {C}$

> 线性映射的乘法一般是不满足交换律的

现证明性质 (1)

$$
\because ((\mathscr{A}\mathscr{B})\mathscr{C})(x)=(\mathscr{A}\mathscr{B})(\mathscr{C}(x))=\mathscr{A}(\mathscr{B}(\mathscr{C}(x)))
$$

又

$$
\because (\mathscr{A}(\mathscr{B}\mathscr{C}))(x)=\mathscr{A}((\mathscr{B}\mathscr{C})(x))=\mathscr{A}(\mathscr{B}(\mathscr{C}(x)))
$$

所以

$$
((\mathscr{A}\mathscr{B})\mathscr{C})(x)=(\mathscr{A}(\mathscr{B}\mathscr{C}))(x)
$$

___

#### 线性映射的矩阵表示

给定 $\mathbb {F}$ 上的线性空间 $V_1, V_2$，及线性映射 $\mathscr {A}:V_1\to V_2$。设 $\dim (V_1)=n, \dim (V_2)=m$，并设 $\varepsilon_1,\varepsilon_2,...,\varepsilon_n$ 为 $V_1$ 的一个基（称为入口基）；$\eta_1, \eta_2,...,\eta_m$ 为 $V_2$ 的一个基（称为出口基）。记第 $j$ 个入口基向量 $\varepsilon_j \in V_1$ 在 $\mathscr {A}$ 下的像 $\mathscr {A}(\varepsilon_j)\in V_2$ 在出口基 $\eta_1, \eta_2,...,\eta_n$ 下的坐标为

$$
a_j = \begin{bmatrix}a_{1j} \\ a_{2j}\\ \vdots \\ a_{mj}\end{bmatrix}\in \mathbb{F}^m
$$

即

$$
\mathscr{A}(\varepsilon_j)=\begin{bmatrix}\eta_1 & \eta_2 & \cdots & \eta_m\end{bmatrix}\begin{bmatrix}a_{1j}\\ a_{2j}\\ \vdots \\ a_{mj}\end{bmatrix},\ j=1,2,...,n
$$

则由 $\mathbb {F}^m$ 中的向量组 $a_1, a_2,...,a_n$ 拼成的矩阵

$$
A = \begin{bmatrix}a_1 & a_2 & \cdots & a_n\end{bmatrix} = [a_{ij}]_{m\times n}
$$

称为 $\mathscr {A}$ 在相应的入口基和出口基下的表示

定义记号

$$
\mathscr{A}\begin{bmatrix}\varepsilon_1 & \varepsilon_2 & \cdots & \varepsilon_n\end{bmatrix}=\begin{bmatrix}\mathscr{A}(\varepsilon_1) & \mathscr{A}(\varepsilon_2) & \cdots & \mathscr{A}(\varepsilon_n)\end{bmatrix}
$$

即线性映射作用在向量组拼成的矩阵上，定义为向量组中每个向量的像按原顺序所成的向量组（简称为向量组的像）拼成的矩阵。则有下面的公式

$$
{\color{red} {\mathscr{A}\begin{bmatrix}\varepsilon_1 & \varepsilon_2 & \cdots & \varepsilon_n\end{bmatrix}=\begin{bmatrix}\eta_1 & \eta_2 & \cdots & \eta_m\end{bmatrix}A}}
$$

用文字表示，读作

$$
[线性映射][入口基矩阵]=[出口基矩阵][表示矩阵]
$$

事实上，只要确定了线性映射两个空间的**基**（例如 $(\varepsilon_1,\cdots,\varepsilon_n)$ 和 $(\beta_1,\cdots,\beta_m)$），就有唯一确定的一个矩阵 $A$ 与之对应，而且**矩阵 $A$ 的每一个列向量就是对应的原基向量映射后的坐标**；反之，如果基确定，任何一个矩阵都唯一确定了一个线性映射

> 我个人理解，线性映射其实就是将一个 $m$ 维的矩阵，转换为 $n$ 维的矩阵，而在转换过程中，需要一个 $m\times n$ 的矩阵 $A$，这类似于 PyTorch 中的 `nn.Linear(m, n, bias=False)` 函数

![](https://wmathor.com/usr/uploads/2021/04/792497264.png#shadow)

___

#### 用坐标计算线性映射

设线性映射 $\mathscr {A}:V_1\to V_2$ 在入口基 $\varepsilon_1, \varepsilon_2,...,\varepsilon_n$ 和出口基 $\eta_1, \eta_2,...,\eta_m$ 下的矩阵表示为 $A$，又设 $\alpha \in V_1$ 在入口基下的坐标为 $X \in \mathbb {F}^n$，则 $\mathscr {A}(\alpha)\in V_2$ 在出口基下的坐标为 $AX\in \mathbb {F}^m$

**证明：**也就是要证 $\mathscr {A}(\alpha)=\begin {bmatrix}\eta_1 & \eta_2 & \cdots & \eta_m\end {bmatrix}(AX)$

因为

$$
\begin{aligned}
\begin{bmatrix}\eta_1 & \eta_2 & \cdots & \eta_m\end{bmatrix}(AX)&=
(\begin{bmatrix}\eta_1 & \eta_2 & \cdots & \eta_m\end{bmatrix}A)X\\
&=(\mathscr{A}\begin{bmatrix}\varepsilon_1 & \varepsilon_2 & \cdots & \varepsilon_n\end{bmatrix})X\\
&=\mathscr{A}(\begin{bmatrix}\varepsilon_1 & \varepsilon_2 & \cdots & \varepsilon_n\end{bmatrix}X)\\
&=\mathscr{A}(\alpha)
\end{aligned}
$$

证毕

___

#### 例 2

设 $B=\begin {bmatrix} 1 & 2 \\ 1 & 1 \\ 0 & 1\end {bmatrix}$，映射 $\mathscr {A}:\mathbb {R}^2\to \mathbb {R}^3$ 由下式确定

$$
\mathscr{A}(\alpha)=B\alpha, \ \ \ \alpha \in \mathbb{R}^2
$$

试求 $\mathscr {A}$ 在基 $\alpha_1=(1, 0)^T, \alpha_2=(0,1)^T$ 与基 $\beta_1=(1,0,0)^T,\beta_2=(0,1,0)^T,\beta_3=(0,0,1)^T$ 下的矩阵表示 $A$

**解：**因为 $\mathscr {A}(\alpha_1)=(1, 1, 0)^T, \mathscr {A}(\alpha_2)=(2, 1, 1)^T$

又由 $\begin {bmatrix}\mathscr {A}(\alpha_1) & \mathscr {A}(\alpha_2)\end {bmatrix}=\begin {bmatrix}\beta_1 & \beta_2 & \beta_3\end {bmatrix} A$ 得

$$
A = \begin{bmatrix}1 & 2\\ 1 & 1\\ 0 & 1\end{bmatrix}
$$

___

#### 例 3

求线性映射 $\mathscr {A}:R [x]_{n+1}\to R [x]_n$

$$
\mathscr{A}(f(x))=\frac{d}{dx}f(x)
$$

在基 $1, x, x^2, ..., x^n$ 与基 $1, x, x^2,..., x^{n-1}$ 下的矩阵表示 $D$

**解：**因为 $\mathscr {A}(1)=0, \mathscr {A}(x)=1,...,\mathscr {A}(x^n)=nx^{n-1}$

又由 $\begin {bmatrix}\mathscr {A}(1) & \mathscr {A}(x) & \cdots & \mathscr {x^n}\end {bmatrix}=\begin {bmatrix} 1 & x & \cdots & x^{n-1}\end {bmatrix} A$ 得

$$
A = \begin{bmatrix}0 & 1 & 0 & 0 & \cdots & 0 \\ 0 & 0 & 2 & 0 & \cdots & 0 \\ 0 & 0 & 0 & 3 & \cdots & 0 \\ \vdots & \vdots & \vdots & \vdots & \cdots & \vdots \\ 0 & 0 & 0 & 0 & \cdots & n\end{bmatrix}_{n\times (n+1)}
$$

___

#### 例 4

设 $\mathscr {A}$ 是 $n$ 维线性空间 $V$ 的一个线性变换，对某个 $\xi\in V$ 有 $\mathscr {A}^{k-1}(\xi)\neq 0, \mathscr {A}^k (\xi)=0$，试证：$\xi,\mathscr {A}(\xi),\mathscr {A}^2 (\xi),...,\mathscr {A}^{k-1}(\xi)$ 线性无关

**解：**$\forall a_1,...,a_{k-1}$，使

$$
a_1\xi+a_2\mathscr{A}(\xi)+···+a_k\mathscr{A}^{k-1}(\xi)=0\quad(1)
$$

有且仅有零解，且线性无关

用 $\mathscr {A}^{k-1}$ 左乘 $(1)$ 式两端，由 $\mathscr {A}^{k}(\xi)=0$ 可得

$$
a_1\mathscr{A}^{k-1}(\xi)=0
$$

因为 $\mathscr {A}^{k-1}(\xi)\neq 0$，所以 $a_1=0$，带入 $(1)$ 式得

$$
a_2\mathscr{A}(\xi)+···+a_k\mathscr{A}^{k-1}(\xi)=0\quad(2)
$$

用 $\mathscr {A}^{k-2}$ 左乘 $(2)$ 式两端，由 $\mathscr {A}^k (\xi)=0$ 可得 $a_2=0$，以此类推，可得 $a_3=・・・=a_k=0$

所以 $\xi,\mathscr {A}(\xi),...,\mathscr {A}^{k-1}(\xi)$ 线性无关

___

#### 例 5

设 $\beta_1,\beta_2,...,\beta_m$ 线性无关，且

$$
\begin{aligned}
\xi_{i} &={a}_{1 i} {\beta}_{1}+a_{2 i}{\beta}_{2}+\cdots+a_{m i} \boldsymbol{\beta}_{m} \\
&=\left({\beta}_{1}, {\beta}_{2}, \cdots ,{\beta}_{m}\right)\left[\begin{array}{c}
a_{1 i} \\
a_{2 i} \\
\vdots \\
a_{m i}
\end{array}\right] \quad(i=1,2, \cdots, s)
\end{aligned}
$$

试证：向量组 $\xi_1,\xi_2,...,\xi_s$ 的秩 = 矩阵 $(a_{ij})_{m\times s}$ 的秩

**解：**令 $B=(\beta_1,\beta_2,...,\beta_m)$，$A=(a_{ij})_{m\times s}$，$P=(\xi_1,...,\xi_s)$，则 $P=BA$

因为 $\beta_1,...,\beta_m$ 线性无关，所以 $B$ 满秩

又因为 $\mathrm {rank}(P)=\mathrm {rank}(BA)$，所以 $\mathrm {rank}(P)=\mathrm {rank}(A)$

___

#### 线性映射的值域

![](https://wmathor.com/usr/uploads/2021/04/1339341083.png#shadow)

设 $\mathscr {A}$ 为线性空间 $V_1$ 到 $V_2$ 的线性映射，则称 $\{\mathscr {A}(\alpha)\mid \alpha \in V_1\}$ 为 $\mathscr {A}$ 的值域，记为 $\mathcal {R}(\mathscr {A})$，且 $\mathcal {R}(\mathscr {A})$ 为 $V_2$ 的子空间。$\dim (\mathcal {R (\mathscr {A})})$ 称为 $\mathscr {A}$ 的秩，记作 $\mathrm {rank}(\mathscr {A})$

**证明（$\mathcal {R}(\mathscr {A})$ 为 $V_2$ 的子空间）：**任取 $\alpha, \beta \in \mathcal {R}(\mathscr {A}), \lambda \in \mathbb {F}$，则存在 $\alpha_1, \beta_1 \in V_1$，使得 $\mathscr {A}(\alpha_1)=\alpha, \mathscr {A}(\beta_1)=\beta$，因为

$$
\begin{aligned}
\alpha + \beta = \mathscr{A}(\alpha_1) + \mathscr{A}(\beta_1)=\mathscr{A}(\alpha_1 + \beta_1) \in \mathcal{R}(\mathscr{A})\\
\lambda \alpha = \lambda \mathscr{\alpha_1}=\mathscr{\lambda \alpha_1} \in \mathcal{R}(\mathscr{A})
\end{aligned}
$$

故 $\mathcal {R}(\mathscr {A})$ 为 $V_2$ 的子空间（保加法、保数乘）

#### 值域与秩的求法（定理）

设 $\alpha_1, \alpha_2,...,\alpha_n$ 为 $V_1$ 的基，$\beta_1, \beta_2,...,\beta_m$ 为 $V_2$ 的基，$\mathscr {A}$ 为 $V_1$ 到 $V_2$ 的线性映射且在基 $\alpha_1, \alpha_2,...,\alpha_n$ 与基 $\beta_1, \beta_2,...,\beta_m$ 下的矩阵为 $A$，即

$$
(\mathscr{A}(\alpha_1),\mathscr{A}(\alpha_2),...,\mathscr{A}(\alpha_n))=(\beta_1,\beta_2,...,\beta_m)A
$$

则

-   $\mathcal{R}(\mathscr{A})=\text{span}\{\mathscr{A}(\alpha_1), \mathscr{A}(\alpha_2),...,\mathscr{A}(\alpha_n)\}$
-   $\mathrm{rank}(\mathscr{A})=\mathrm{rank}(A)$

**证明：**任取 $\alpha \in \mathcal {R}(\mathscr {A})$，则存在 $\beta \in V_1$，使得 $\mathscr {A}(\beta)=\alpha$

$$
\begin{aligned}
&\because\  \beta = k_1\alpha_1 + k_2\alpha_2 +···+k_n \alpha_n \\
&\therefore\  \alpha = \mathscr{A}(\beta) = k_1\mathscr{A}(\alpha_1) + k_2\mathscr{A}(\alpha_2) + ··· + k_n \mathscr{A}(\alpha_n) \\ 
&\Rightarrow \  \alpha \in \text{span}\{\mathscr{A}(\alpha_1), \mathscr{A}(\alpha_2),...,\mathscr{A}(\alpha_n)\} \\
&\Rightarrow \  \mathcal{R}(\mathscr{A}) \subseteq \text{span}\{\mathscr{A}(\alpha_1), \mathscr{A}(\alpha_2),...,\mathscr{A}(\alpha_n)\}
\end{aligned}
$$

任取 $\alpha \in \text {span}\{\mathscr {A}(\alpha_1), \mathscr {A}(\alpha_2),...,\mathscr {A}(\alpha_n)\}$，则

$$
\begin {aligned}
&\alpha = k_1\mathscr {A}(\alpha_1) + k_2\mathscr {A}(\alpha_2) +・・・+ k_n \mathscr {A}(\alpha_n)\\
&\because \ \mathscr {A}(\alpha_i)\in \mathcal {R}(\mathscr {A}),\mathcal {R}(\mathscr {A}) 为子空间 \\
&\therefore \ \alpha \in \mathcal {R}(\mathscr {A})\\
&\Rightarrow \ \text {span}\{\mathscr {A}(\alpha_1), \mathscr {A}(\alpha_2),...,\mathscr {A}(\alpha_n)\} \subseteq \mathcal {R}(\mathscr {A})
\end {aligned}
$$

故 $\mathcal {R}(\mathscr {A})=\text {span}\{\mathscr {A}(\alpha_1), \mathscr {A}(\alpha_2),...,\mathscr {A}(\alpha_n)\}$

___

#### 线性映射的核

![](https://wmathor.com/usr/uploads/2021/04/1838942384.png#shadow)

设 $\mathscr {A}$ 为 $V_1$ 到 $V_2$ 的线性映射，则称 $\{\alpha \mid \mathscr {A}(\alpha)=0, \alpha \in V_1\}$ 为 $\mathscr {A}$ 的核，记为 $\mathcal {N}(\mathscr {A})$，且 $\mathcal {N}(\mathscr {A})$ 为 $V_1$ 的子空间。$\dim (\mathcal {N}(\mathscr {A}))$ 称为 $\mathscr {A}$ 的零度，记为 $\text {null}(\mathscr {A})$

**证明（$\mathcal {N}(\mathscr {A})$ 为 $V_1$ 的子空间）：**任取 $\alpha, \beta \in \mathcal {N}(\mathscr {A}), \lambda \in \mathbb {F}$，则 $\mathscr {A}(\alpha) = 0, \mathscr {A}(\beta)=0$，因为

$$
\mathscr{A}(\alpha + \beta) = \mathscr{A}(\alpha) + \mathscr{A}(\beta)=0 \Rightarrow \ \alpha+\beta \in \mathcal{N}(\mathscr{A})\\
\mathscr{A}(\lambda \alpha) = \lambda \mathscr{A}(\alpha)=0 \Rightarrow \ \lambda \alpha \in \mathcal{N}(\mathscr{A})
$$

故 $\mathcal {N}(\mathscr {A})$ 为 $V_1$ 的子空间（保加法、保数乘）

#### 核与零度的求法（定理）

设 $\alpha_1, \alpha_2, ..., \alpha_n$ 为 $V_1$ 的基，$\beta_1, \beta_2,...,\beta_m$ 为 $V_2$ 的基，$\mathscr {A}$ 为 $V_1$ 到 $V_2$ 的线性映射且在 $\alpha_1, \alpha_2,...,\alpha_n$ 与基 $\beta_1, \beta_2, ...,\beta_m$ 下的矩阵为 $A$，且 $Ax=0$ 的基础解系为 $\xi_1, \xi_2,..,\xi_{n-r}$，则

-   $\mathcal {N}(\mathscr {A})=\text {span}\{\gamma_1, \gamma_2, ..., \gamma_{n-r}\}$，其中 $\gamma_i=(\alpha_1, \alpha_2,...,\alpha_n)\xi_i$
-   $\text{null}(\mathscr{A})=n-\mathrm{rank}(\mathscr{A})=n-\mathrm{rank}(A)$
-   $\dim(\mathcal{R}(\mathscr{A}))+\dim(\mathcal{N}(\mathscr{A}))=\dim(V)$

**证明：**任取 $\alpha \in \mathcal {N}(\mathscr {A})$，且 $\alpha$ 在基 $\alpha_1, \alpha_2,...,\alpha_n$ 下的坐标为 $\xi$

则 $\mathscr {A}(\alpha)=0$，且 $\mathscr {A}(\alpha)$ 在基 $\beta_1, \beta_2,...,\beta_m$ 下的坐标为 $A\xi$

$\Rightarrow A\xi=0$，即 $\xi$ 为 $Ax=0$ 的解，则有

$$
\begin{aligned}
&\xi = k_1\xi_1 + k_2\xi_2 +···+k_{n-r}\xi_{n-r}\\\\
&\Rightarrow \alpha = (\alpha_1,\alpha_2,...,\alpha_n)\xi=k_1[(\alpha_1,\alpha_2,...,\alpha_n)\xi_1]+k_2[(\alpha_1,\alpha_2,...,\alpha_n)\xi_2]\\
&+···+k_{n-r}[(\alpha_1,\alpha_2,...,\alpha_n)\xi_1]+k_2[(\alpha_1,\alpha_2,...,\alpha_n)\xi_{n-r}]\\
&=k_1\gamma_1+k_2\gamma_2+···+k_{n-r}\gamma_{n-r}\\
\\
&\Rightarrow \alpha \in \text{span}\{\gamma_1, \gamma_2,...,\gamma_{n-r}\}\Rightarrow \mathcal{N}(\mathscr{A})\subseteq \text{span}\{\gamma_1, \gamma_2,...,\gamma_{n-r}\}
\end{aligned}
$$

任取 $\alpha \in \text {span}\{\gamma_1, \gamma_2,...,\gamma_{n-r}\}$，则

$$
\begin{aligned}
\alpha&=k_1\gamma_1 + k_2\gamma_2+···+k_{n-r}\gamma_{n-r}\\
\Rightarrow \mathscr{A}(\alpha)&=k_1\mathscr{A}(\gamma_1)+k_2\mathscr{A}(\gamma_2)+···+k_{n-r}\mathscr{A}(\gamma_{n-r})\\
\because \mathscr{A}(\gamma_i)&=\mathscr{A}[(\alpha_1, \alpha_2,...,\alpha_n)\xi_i]=[\mathscr{A}(\alpha_1,\alpha_2,...,\alpha_n)]\xi_i\\
&=[(\beta_1,\beta_2,...,\beta_m)A]\xi_i=(\beta_1,\beta_2,...,\beta_m)(A\xi_i)\\
&=(\beta_1, \beta_2,...,\beta_m)0=0\\
\therefore \mathscr{A}(\alpha)&=0 \Rightarrow \in \mathcal{N}(\mathscr{A}) \Rightarrow \text{span}\{\gamma_1, \gamma_2, ..., \gamma_{n-r}\}\subseteq \mathcal{N}(\mathscr{A})
\end{aligned}
$$

故 $\mathcal {N}(\mathscr {A})=\text {span}\{\gamma_1, \gamma_2,...,\gamma_{n-r}\}$

___

#### \* 矩阵的列空间

对于一个 $m\times n$ 的矩阵 $A$，它的列空间就是 $A$ 中列向量 $(A_1,A_2,...,A_n)$ 的所有线性组合，即

$$
\text{span}\{A_1,A_2,...,A_n\}
$$

___

#### 例 6

设线性变换 $\mathscr {A}: V\to V$ 在基 $\alpha_1,\alpha_2,\alpha_3$ 下的矩阵表示为 $A=\begin {bmatrix} 1&2&0\\0&-1&1\\1&1&1\end {bmatrix}$，求 $\mathcal {R}(\mathscr {A}),\mathcal {N}(\mathscr {A})$ 的基与维数

**解：**对矩阵 $A$ 做初等行变换得

$$
A\to \begin{bmatrix}1&0&2\\0&1&-1\\0&0&0\end{bmatrix}
$$

因为 $\mathcal {R}(\mathscr {A})=\text {span}\{\mathscr {A}(\alpha_1),\mathscr {A}(\alpha_2),\mathscr {A}(\alpha_3)\}$，所以 $\mathcal {R}(\mathscr {A})$ 的基是 $(\mathscr {A}(\alpha_1),\mathscr {A}(\alpha_2),\mathscr {A}(\alpha_3))$ 的极大线性无关组

又因为

$$
(\mathscr{A}(\alpha_1),\mathscr{A}(\alpha_2),\mathscr{A}(\alpha_3))=(\alpha_1,\alpha_2,\alpha_3)A\\
$$

所以 $\mathcal {R}(\mathscr {A})$ 的基为 $(\mathscr {A}(\alpha_1),\mathscr {A}(\alpha_2))=(\alpha_1+\alpha_3,2\alpha_1-\alpha_2+\alpha_3)$，$\dim (\mathcal {R}(\mathscr {A}))=2$

$A$ 的核空间为 $AX=0$ 的解空间，即

$$
\begin{bmatrix}1&2&0\\0&-1&1\\1&1&1\end{bmatrix}\begin{bmatrix}x_1\\x_2\\x_3\end{bmatrix}=0\\
\Rightarrow \begin{cases}x_1=-2x_3\\x_2=x_3\end{cases}
$$

其基础解系为 $[-2,1,1]^T$，所以 $\mathcal {N}(\mathscr {A})$ 的基为 $-2\alpha_1+\alpha_2+\alpha_3$，且 $\dim (\mathcal {N}(\mathscr {A}))=1$

___

#### 例 7

设线性变换 $\mathscr {A}:\mathbb {F}^{2\times 2}\to \mathbb {F}^{2\times 2}$ 在基 $E_{11},E_{12},E_{21},E_{22}$ 下的定义为：

$$
\forall X=\begin{bmatrix}a&b\\c&d\end{bmatrix},\mathscr{A}(X)=\begin{bmatrix}a+b&b+c\\c+d&d+a\end{bmatrix}
$$

求 $\mathcal {R}(\mathscr {A}),\mathcal (N)(\mathscr {A})$ 的一组基与维数

**解：**

因为 $\mathcal {R}(\mathscr {A})=\text {span}\{\mathscr {A}(E_{11}),\mathscr {A}(E_{12}),\mathscr {A}(E_{21}),\mathscr {A}(E_{22})\}$，所以 $\mathcal {R}(\mathscr {A})$ 的基是 $(\mathscr {A}(E_{11}),\mathscr {A}(E_{12}),\mathscr {A}(E_{21}),\mathscr {A}(E_{22}))$ 的极大线性无关组

又因为

$$
\begin{aligned}
(\mathscr{A}(E_{11}),\mathscr{A}(E_{12}),\mathscr{A}(E_{21}),\mathscr{A}(E_{22}))&=(E_{11},E_{12},E_{21},E_{22})A\\
\Rightarrow A&= \begin{bmatrix}1&1&0&0\\0&1&1&0\\0&0&1&1\\1&0&0&1\end{bmatrix}\\
\to &\begin{bmatrix}1&0&0&1\\0&1&0&-1\\0&0&1&1\\0&0&0&0\end{bmatrix}
\end{aligned}
$$

所以 $\mathcal {R}(\mathscr {A})$ 的基为 $(\mathscr {A}(E_{11}),\mathscr {A}(E_{12}),\mathscr {A}(E_{21}))=(\begin {bmatrix} 1&0\\0&1\end {bmatrix},\begin {bmatrix} 1&1\\0&0\end {bmatrix},\begin {bmatrix} 0&1\\1&0\end {bmatrix})$，$\dim (\mathcal {R}(\mathscr {A}))=3$

> 注意：最后找基的时候，要借助原来 $A$ 矩阵的各个列向量，不能使用经过初等行变换后的矩阵

$A$ 的核空间为 $AX=0$ 的解空间，即

$$
\begin{bmatrix}1&1&0&0\\0&1&1&0\\0&0&1&1\\1&0&0&1\end{bmatrix}\begin{bmatrix}x_1\\x_2\\x_3\\x_4\end{bmatrix}=0\\
\Rightarrow \begin{cases}x_1=-x_4\\x_2=x_4\\x_3=-x_4\end{cases}
$$

其基础解系为 $[-1,1,-1,1]^T$，所以 $\mathcal {N}(\mathscr {A})$ 的基为 $-E_{11}+E_{12}-E_{21}+E_{22}$，且 $\dim (\mathcal {N}(\mathscr {A}))=1$

___

#### 例 8

求矩阵 $A=\begin {bmatrix} 1&1&6\\0&4&2\\1&1&6\end {bmatrix}$ 的值域 $\mathcal {R}(A)$ 与核空间 $\mathcal {N}(A)$

**解：**$A$ 的值域 $\mathcal {R}(A)$ 为

$$
\begin{aligned}
\mathcal{R}(A) &=\operatorname{span}\left\{[1,0,1]^{T} ,[1,4,1]^{T} ,[6,2,6]^{T}\right\} \\
&=\operatorname{span}\left\{[1,0,1]^{T} ,[1,4,1]^{T}\right\} \\
&=\operatorname{span}\left\{[1,0,1]^{T},[0,1,0]^{T}\right\}
\end{aligned}
$$

又因为 $A$ 的核空间为 $AX=0$ 的解空间，其基础解系为 $[11, 1, -2]^T$，所以

$$
\mathcal{N}(A)=\text{span}\{[11, 1, -2]^T\}
$$

___

#### 例 9

设 $B=\begin {bmatrix} 1& 2& 3 \\ 1 & 1 & 2 \\ 2& 0 & 2\\ 0 & 1& 1\end {bmatrix}$，定义 $\mathscr {A}:\mathbb {R}^3\to \mathbb {R}^4, \mathscr {A}(\alpha)=B\alpha$，$\alpha_1=\begin {bmatrix} 1 \\ 1 \\ 0\end {bmatrix}, \alpha_2=\begin {bmatrix} 0 \\ 1\\ 1\end {bmatrix}, \alpha_3 = \begin {bmatrix} 1 \\ 0 \\ 1\end {bmatrix}$ 为 $\mathbb {R}^3$ 的基，$\beta_1 = \begin {bmatrix} 1 \\ 1 \\ 0 \\ 0\end {bmatrix}, \beta_2 = \begin {bmatrix} 1 \\ 0\\ 1\\ 0\end {bmatrix}, \beta_3=\begin {bmatrix} 1\\ 0\\ 0\\ 1\end {bmatrix}, \beta_4 = \begin {bmatrix} 0 \\ 1\\ 1\\ 0\end {bmatrix}$ 为 $\mathbb {R}^4$ 的基

求：（1）$\mathscr {A}$ 在基 $\alpha_1, \alpha_2, \alpha_3$ 与基 $\beta_1, \beta_2, \beta_3, \beta_4$ 下的矩阵 $A$；（2）$\mathcal {R}(\mathscr {A})$ 与 $\mathcal {N}(\mathscr {A})$ 的基

**解：**

（1）

$$
\because \mathscr{A}(\alpha_1)=\begin{bmatrix}1&2&3\\1&1&2\\2&0&2\\0&1&1\end{bmatrix}\begin{bmatrix}1\\1\\0\end{bmatrix}=\begin{bmatrix}3\\2\\2\\1\end{bmatrix}\\
\mathscr{A}(\alpha_2)=\begin{bmatrix}5\\3\\2\\2\end{bmatrix}\\
\mathscr{A}(\alpha_3)=\begin{bmatrix}4\\3\\4\\1\end{bmatrix}\\
\therefore \mathscr{A}(\alpha_1, \alpha_2, \alpha_3)=(\mathscr{A}(\alpha_1), \mathscr{A}(\alpha_2), \mathscr{A}(\alpha_3))=\begin{bmatrix}3&5&4\\2&3&3\\2&2&4\\1&2&1\end{bmatrix}
$$

又

$$
\mathscr{A}(\alpha_1, \alpha_2, \alpha_3)=(\beta_1, \beta_2,\beta_3,\beta_4)A\\
\therefore \begin{bmatrix}3&5&4\\2&3&3\\2&2&4\\1&2&1\end{bmatrix}=\begin{bmatrix}1&1&1&0\\1&0&0&1\\0&1&0&1\\0&0&1&0\end{bmatrix}A \Rightarrow A = \begin{bmatrix}1&2&1\\1&1&2\\1&2&1\\1&1&2\end{bmatrix}
$$

（2）

$$
\begin{aligned}
AX=0\Rightarrow \begin{cases}x_1=-3x_3\\x_2=x_3\end{cases}
\end{aligned}
$$

其基础解系为 $[-3, 1,1]^T$，故线性变换的核子空间 $\mathcal {N}(\mathscr {A})$ 的维度为 1，根据维数定理可知 $\mathscr {A}$ 的值域 $\mathcal {R}(\mathscr {A})$ 的维数为 2，又

$$
\begin{aligned}
\mathcal{R}(\mathscr{A})&=\text{span}\{\mathscr{A}(\alpha_1),\mathscr{A}(\alpha_2),\mathscr{A}(\alpha_3)\}\\
&=\text{span}\{\beta_1+\beta_2+\beta_3+\beta_4,2\beta_1+\beta_2+2\beta_3+\beta_4,\\&\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \beta_1+2\beta_2+\beta_3+2\beta_4\}\\
&=\text{span}\{[3,2,2,1]^T,[5,3,2,2]^T\}
\end{aligned}
$$

所以 $\mathcal {R}(\mathscr {A})$ 的基为 $[3,2,2,1]^T,[5,3,2,2]^T$

___

#### 线性映射是单射、满射的充要条件

单射：原像空间中任意两个不同的向量经过线性映射后得到的向量也是不同的

满射：像空间中的任意一个向量，都能在原像空间中找到原向量

-   $\mathscr {A}$ 是单射 $\Leftrightarrow \mathcal {N}(\mathscr {A})={0}$
-   $\mathscr {A}$ 是满射 $\Leftrightarrow \mathcal {R}(\mathscr {A})=V_2$
-   **降维不单，升维不满**

## 矩阵等价与线性映射的最简表示

#### 矩阵等价

矩阵 $A\cong B$ 的充分必要条件是存在 $m$ 阶可逆矩阵 $P$ 及 $n$ 阶可逆矩阵 $Q$，使 $PAQ=B$

___

#### 线性映射的最简表示

在指定了空间 $V_1$ 与 $V_2$ 的基之后，便可以求得线性映射 $\mathscr {A}:V_1\to V_2$ 在指定一对基下的矩阵表示。但是空间基是不唯一的，自然应该考虑以下两个问题：

1.  线性映射在不同对基下的矩阵表示之间有什么关系？
2.  对一个线性映射，能否选择一对基，使它的矩阵表示最简单（零多）？

先回答第一个问题

设 $\mathscr {A}$ 是 $V_1\to V_2$ 的一个线性映射，$\alpha_1,\alpha_2,...,\alpha_n$ 与 $\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n$ 是 $V_1$ 的两组基，由 $\alpha_i$ 到 $\alpha^{\prime}_i$ 的过渡矩阵为 $P$。设 $\beta_1,\beta_2,...,\beta_m$ 与 $\beta^{\prime}_1,\beta^{\prime}_2,...,\beta^{\prime}_m$ 是 $V_2$ 的两组基，由 $\beta_j$ 到 $\beta^{'}_j$ 的过渡矩阵为 $Q$。线性映射 $\mathscr {A}$ 在基 $\alpha_1,\alpha_2,...,\alpha_n$ 与 $\beta_1,\beta_2,...,\beta_m$ 下的矩阵表示为 $A$，在基 $\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n$ 与 $\beta^{\prime}_1,\beta^{\prime}_2,...,\beta^{\prime}_m$ 下的矩阵表示为 $B$，则

$$
B = Q^{-1}AP
$$

**证明：**

由假设条件知

$$
\begin{gather}
\mathscr{A}(\alpha_1,\alpha_2,...,\alpha_n)=(\beta_1,\beta_2,...,\beta_m)A \tag{1}\\
\mathscr{A}(\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n)=(\beta^{\prime}_1,\beta^{\prime}_2,...,\beta^{\prime}_m)B \tag{2}\\
(\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n)=(\alpha_1,\alpha_2,...,\alpha_n)P \tag{3}\\
(\beta^{\prime}_1,\beta^{\prime}_2,...,\beta^{\prime}_m)=(\beta_1,\beta_2,...,\beta_m)Q \tag{4}
\end{gather}
$$

将式 $(3)$ 和式 $(4)$ 带入式 $(2)$ 得

$$
\begin{gather}
\mathscr{A}(\alpha_1,\alpha_2,...,\alpha_n)P=(\beta_1,\beta_2,..,\beta_m)QB \tag{5}
\end{gather}
$$

将式 $(1)$ 带入式 $(5)$ 得

$$
\begin{aligned}
(\beta_1,\beta_2,...,\beta_m)AP=(\beta_1,\beta_2,...,\beta_m)QB
\end{aligned}
$$

因为 $(\beta_1,\beta_2,...,\beta_m)$ 线性无关，故

$$
AP=QB
$$

由于 $Q$ 是满秩方阵（因为[过渡矩阵](https://wmathor.com/index.php/archives/1487/)都是满秩的），所以

$$
B = Q^{-1}AP \tag{6}
$$

回答第二个问题

大学线性代数中有这么一个结论：对于 $m\times n$ 矩阵 $A$，总可经过初等变换（行变换和列变换）把它化为标准形

$$
Q^{-1}AP=\begin{bmatrix}E_r& 0_{r\times (n-r)}\\0_{(m-r)\times r}&0_{(m-r)\times (n-r)}\end{bmatrix}_{m\times n},\  r = \mathrm{rank}(A)
$$

将式 $(6)$ 带入式 $(2)$ 得

$$
\begin{aligned}
\mathscr{A}(\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n)&=(\beta^{\prime}_1,\beta^{\prime}_2,...,\beta^{\prime}_m)Q^{-1}AP\\
&=(\beta^{\prime}_1,\beta^{\prime}_2,...,\beta^{\prime}_m)\begin{bmatrix}E_r& 0_{r\times (n-r)}\\0_{(m-r)\times r}&0_{(m-r)\times (n-r)}\end{bmatrix}_{m\times n}
\end{aligned}
$$

所以，对于一个线性映射，一定可以找到一对基，使得线性映射对应的矩阵最简单

___

#### 线性变换

接下来的线性映射 $\mathscr {A}$ 都是指线性空间 $V$ 到 $V$ 的映射，特称这样的 $\mathscr {A}$ 为线性空间 $V$ 的**线性变换**。由于线性变换时线性空间 $V$ 到它自身的映射，所以只需取 $V$ 的一组基 $\alpha_1,\alpha_2,...,\alpha_n$ 即可

设 $\alpha = \begin {bmatrix}\alpha_1,\alpha_2,...,\alpha_n\end {bmatrix}\begin {bmatrix} x_1\\x_2\\ \vdots x_n\end {bmatrix} \in V$，若

$$
\mathscr{A}(\alpha) = \begin{bmatrix}\alpha_1, \alpha_2,...,\alpha_n\end{bmatrix}\begin{bmatrix}y_1\\ y_2 \\ \vdots \\ y_n\end{bmatrix}
$$

则原像 $\alpha$ 与像 $\mathscr {A}(\alpha)$ 的坐标变换公式为

$$
\begin{bmatrix}y_1\\y_2\\ \vdots \\ y_n\end{bmatrix}=A\begin{bmatrix}x_1 \\ x_2 \\ \vdots \\ x_n\end{bmatrix} \tag{7}
$$

___

#### 例 1

设 $\mathbb {R}^3$ 中线性变换 $\mathscr {A}$ 将基

$$
\alpha_1 = \begin{bmatrix}1\\1\\-1\end{bmatrix}, \alpha_2=\begin{bmatrix}0\\2\\-1\end{bmatrix},\alpha_3=\begin{bmatrix}1\\0\\-1\end{bmatrix}
$$

变为基

$$
\alpha^{\prime}_1 = \begin{bmatrix}1\\-1\\0\end{bmatrix}, \alpha^{\prime}_2=\begin{bmatrix}0\\1\\-1\end{bmatrix},\alpha^{\prime}_3=\begin{bmatrix}0\\3\\-2\end{bmatrix}
$$

1.  求 $\mathscr {A}$ 在基 $\alpha_1,\alpha_2,\alpha_3$ 下的矩阵表示 $A$
2.  求向量 $\xi=(1,2,3)^T$ 及 $\mathscr {A}(\xi)$ 在基 $\alpha_1, \alpha_2,\alpha_3$ 下的坐标
3.  求向量 $\xi$ 及 $\mathscr {A}(\xi)$ 在基 $\alpha^{\prime}_1,\alpha^{\prime}_2,\alpha^{\prime}_3$ 下的坐标

**解：**（1）

$$
\because \mathscr{A}(\alpha_1,\alpha_2,\alpha_3)=(\alpha_1,\alpha_2,\alpha_3)A=(\alpha^{\prime}_1,\alpha^{\prime}_2,\alpha^{\prime}_3)\\
\therefore A = (\alpha_1,\alpha_2,\alpha_3)^{-1}(\alpha^{\prime}_1,\alpha^{\prime}_2,\alpha^{\prime}_3)=\begin{bmatrix}1&-1&-1\\-1&1&2\\0&1&1\end{bmatrix}
$$

（2）

设 $\xi=\begin {bmatrix}\alpha_1,\alpha_2,\alpha_3\end {bmatrix}\begin {bmatrix} k_1\\k_2\\k_3\end {bmatrix}$，即

$$
\begin{bmatrix}1\\2\\3\end{bmatrix}=\begin{bmatrix}1&0&1\\1&2&0\\-1&-1&-1\end{bmatrix}\begin{bmatrix}k_1\\k_2\\k_3\end{bmatrix}
$$

解得

$$
k_1 = 10, k_2=-4,k_3=-9
$$

所以 $\xi$ 在基 $\alpha_1,\alpha_2,\alpha_3$ 下的坐标为 $(10,-4,-9)^T$

$\mathscr {A}(\xi)$ 在基 $\alpha_1,\alpha_2,\alpha_3$ 下的坐标可由公式 $(7)$ 得

$$
\begin{bmatrix}y_1\\y_2\\y_3\end{bmatrix}=\begin{bmatrix}1&-1&-1\\-1&1&2\\0&1&1\end{bmatrix}\begin{bmatrix}10\\-4\\-9\end{bmatrix}=\begin{bmatrix}23\\-32\\-13\end{bmatrix}
$$

（3）

设 $\xi=[\alpha_1,\alpha_2,\alpha_3]\begin {bmatrix} x_1\\x_2\\x_3\end {bmatrix}$，即

$$
\begin{bmatrix}1\\2\\3\end{bmatrix}=\begin{bmatrix}1&0&0\\-1&1&3\\0&-1&-2\end{bmatrix}\begin{bmatrix}x_1\\x_2\\x_3\end{bmatrix}\Rightarrow \begin{bmatrix}x_1\\x_2\\x_3\end{bmatrix}=\begin{bmatrix}1\\-15\\6\end{bmatrix}
$$

$\mathscr {A}(\xi)$ 在基 $\alpha_1,\alpha_2,\alpha_3$ 下的坐标可由公式 $(7)$ 得

$$
\begin{bmatrix}y_1\\y_2\\y_3\end{bmatrix}=\begin{bmatrix}1&-1&-1\\-1&1&2\\0&1&1\end{bmatrix}\begin{bmatrix}1\\-15\\6\end{bmatrix}=\begin{bmatrix}10\\-4\\-9\end{bmatrix}
$$

___

#### 例 2

求线性空间 $\mathbb {R}^3$ 绕指定了正方向的固定轴旋转角度 $\theta$ 的变换 $\mathscr {A}$ 的矩阵表示

**解：**以 $O$ 为起点沿旋转轴正方向取单位长有向线段，记为 $e_z$，再取以 $O$ 为起点的另两单位长有向线段 $e_x,e_y$，使得 $e_x,e_y,e_z$ 构成线性空间 $V$ 中的右手直角坐标系。入口基和出口基都选为 $e_x,e_y,e_z$

![](https://ftp.bmp.ovh/imgs/2021/04/2998108b123a8b01.png#shadow)

$$
\mathscr{A}(e_x,e_y,e_z)=\begin{bmatrix}e_x&e_y&e_z\end{bmatrix}\begin{bmatrix}\cos\theta&-\sin\theta&0\\\sin\theta&\cos\theta&0\\0&0&1\end{bmatrix}
$$

因此 $\mathscr {A}$ 的矩阵表示为 $\begin {bmatrix}\cos\theta&-\sin\theta&0\\\sin\theta&\cos\theta&0\\0&0&1\end {bmatrix}$

___

#### 例 3

求几何空间中以 $XOY$ 面为镜面反射变换 $\mathscr {B}$ 的矩阵表示

**解：**

$$
\begin{aligned}
\mathscr{B}(e_x,e_y,e_z)&=\begin{bmatrix}e_x&e_y&-e_z\end{bmatrix}\\
&=\begin{bmatrix}e_x&e_y&e_z\end{bmatrix}\begin{bmatrix}1&0&0\\0&1&0\\0&0&-1\end{bmatrix}
\end{aligned}
$$

因此 $\mathscr {B}$ 的矩阵表示为 $\begin {bmatrix} 1&0&0\\0&1&0\\0&0&-1\end {bmatrix}$

#### 线性变换的运算

设 $\mathscr {A},\mathscr {B}$ 是线性空间 $V$ 的两个线性变换，$\lambda \in \mathbb {F}$

1.  加法：$(\mathscr {A}+\mathscr {B})(\alpha)=\mathscr {A}(\alpha)+\mathscr {B}(\alpha)$
2.  乘法：$\mathscr {AB}(\alpha)=\mathscr {A}(\mathscr {B}(\alpha))$
3.  数乘：$(\lambda\mathscr {A})(\alpha)=\lambda \mathscr {A}(\alpha)$
4.  可逆：设 $\mathscr {A}\mathscr {B}=\mathscr {B}\mathscr {A}=E$，其中 $E$ 为恒等变换，这时变换 $\mathscr {B}$ 称为 $\mathscr {A}$ 的**拟变换**，记为 $\mathscr {A}^{-1}$

**问题：**对于一般的线性映射，能否定义加法、乘法、数乘？

很明显加法和数乘都可以，乘法不行（维度不匹配）

___

#### 不同基下的矩阵关系

设 $\mathscr {A}$ 为线性空间 $V$ 上的线性变换，设 $\alpha_1,\alpha_2,...,\alpha_n$ 与 $\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n$ 为 $V$ 的基且过渡矩阵为 $P$。若 $\mathscr {A}$ 在基 $\alpha_1,\alpha_2,...,\alpha_n$ 下的矩阵表示为 $A$，在基 $\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n$ 下的矩阵表示为 $B$，则

$$
B=P^{-1}AP
$$

**证明：**

由已知得

$$
\begin{aligned}
\mathscr{A}(\alpha_1,\alpha_2,...,\alpha_n)=(\alpha_1,\alpha_2,...,\alpha_n)A \\
\mathscr{A}(\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n)=(\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n)B \\
(\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n)=(\alpha_1,\alpha_2,...,\alpha_n)P 
\end{aligned}
$$

于是有

$$
\begin{aligned}
\because (\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n)&=(\alpha_1,\alpha_2,...,\alpha_n)P\\
\therefore \mathscr{A}(\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n)&=\mathscr{A}(\alpha_1,\alpha_2,...,\alpha_n)P\\
&=(\alpha_1,\alpha_2,...,\alpha_n)AP\\
\because \mathscr{A}(\alpha^{\prime}_1,\alpha^{\prime}_2,...,\alpha^{\prime}_n)&=((\alpha_1,\alpha_2,...,\alpha_n)P)B\\
&=(\alpha_1,\alpha_2,...,\alpha_n)PB\\
\therefore AP=PB &\Rightarrow B=P^{-1}AP
\end{aligned}
$$

___

#### 相似

设 $A,B\in \mathbb {F}^{m\times n}$，若存在 $P\in \mathbb {F}^{n\times n}$，满足

$$
B=P^{-1}AP
$$

则称 $B$ 与 $A$ 相似，记为 $B\sim A$

___

#### 例 4

求线性变换 $\mathscr {A}:F_3 [x]\to F_3 [x]$，$\mathscr {A}(p (x))=p^{\prime}(x)$ 在基

$$
p_1(x)=1+x+3x^2,p_2(x)=1+x,p_3(x)=1+2x-x^2
$$

下的矩阵表示 $A$

**解：**

（方法一）按照线性变换的定义求解

$$
\begin{aligned}
(\mathscr{A}(p_1(x)),\mathscr{A}(p_2(x)),\mathscr{A}(p_3(x)))&=\begin{bmatrix}1+6x,1,2-2x\end{bmatrix}\\
&=\begin{bmatrix}1,x,x^2\end{bmatrix}\begin{bmatrix}1&1&2\\6&0&-2\\0&0&0\end{bmatrix}
\end{aligned}
$$

因为

$$
\begin{bmatrix}1+x+3x^2,1+x,1+2x-x^2\end{bmatrix}=[1,x,x^2]\begin{bmatrix}1&1&1\\1&1&2\\3&0&-1\end{bmatrix}
$$

又因为

$$
\begin{bmatrix}1+6x,1,2-2x\end{bmatrix}=\begin{bmatrix}1+x+3x^2,1+x,1+2x-x^2\end{bmatrix}A
$$

所以

$$
\begin{aligned}
\begin{bmatrix}1,x,x^2\end{bmatrix}\begin{bmatrix}1&1&2\\6&0&-2\\0&0&0\end{bmatrix}&=[1,x,x^2]\begin{bmatrix}1&1&1\\1&1&2\\3&0&-1\end{bmatrix}A\\
&\Rightarrow A = \begin{bmatrix}1&1&1\\1&1&2\\3&0&-1\end{bmatrix}^{-1}\begin{bmatrix}1&1&2\\6&0&-2\\0&0&0\end{bmatrix}\\
&\Rightarrow A=\begin{bmatrix}\frac{5}{3}&-\frac{1}{3}&-\frac{4}{3}\\-\frac{17}{3}&\frac{7}{3}&\frac{22}{3}\\5&-1&-4\end{bmatrix}
\end{aligned}
$$

___

#### 同构

设 $V_1,V_2$ 为线性空间，若存在一一映射 $\sigma:V_1\to V_2$ 满足 $\forall \alpha, \beta \in V_1, \lambda \in \mathbb {F}$，有

$$
\begin{aligned}
\sigma(\alpha+\beta)&=\sigma(\alpha)+\sigma(\beta)\\
\sigma(\lambda \alpha)&=\lambda \sigma(\alpha)
\end{aligned}
$$

则称 $V_1$ 与 $V_2$ 同构，$\sigma$ 称为同构映射

#### 同构的充要条件

数域 $\mathbb {F}$ 上两个有限维线性空间 $V_1,V_2$ 同构的充要条件是 $\dim (V_1)=\dim (V_2)$

#### 同构的性质

同构映射具有以下四个基本性质

1.  $\sigma(0)=0, \sigma(\alpha)=-\sigma(\alpha)$
2.  $\sigma(k_1\alpha_1+k_2\alpha_2+···+k_s\alpha_s)=k_1\sigma(\alpha_1)+k_2\sigma(\alpha_2)+···k_s\sigma(\alpha_s)$
3.  $V$ 中向量组 $\alpha_1,\alpha_2,...,\alpha_s$ 线性相（无）关 $\Longleftrightarrow$ 像 $\sigma (\alpha_1),\sigma (\alpha_2),...,\sigma (\alpha_s)$ 线性相（无）关
4.  如果 $V_1$ 是 $V$ 的一个子空间，则 $V_1$ 在 $\sigma$ 下的像集合 $\sigma (V_1)=\{\sigma (\alpha)\mid \alpha \in V_1\}$ 是 $\sigma (V)$ 的子空间，并且 $V_1$ 与 $\sigma (V_1)$ 维数相同

___

#### 例 5

设 $\mathscr {A}$ 是线性空间 $\mathbb {R}^3$ 的线性变换，它在 $\mathbb {R}^3$ 中基 $\alpha_1, \alpha_2,\alpha_3$ 下的矩阵表示为

$$
A = \begin{bmatrix}1&2&3\\-1&0&3\\2&1&5\end{bmatrix}
$$

（1）求 $\mathscr {A}$ 在基 $\beta_1=\alpha_1,\beta_2=\alpha_1+\alpha_2,\beta_3=\alpha_1+\alpha_2+\alpha_3$ 下的矩阵表示

（2）求 $\mathscr {A}$ 在基 $\alpha_1,\alpha_2,\alpha_3$ 下的核与值域

**解：**

（1）

$$
\begin{aligned}
\because [\beta_1,\beta_2,\beta_3]&=[\alpha_1,\alpha_2,\alpha_3]\begin{bmatrix}1&1&1\\0&1&1\\0&0&1\end{bmatrix}\\
&=[\alpha_1,\alpha_2,\alpha_3]P
\end{aligned}
$$

设 $\mathscr {A}$ 在基 $\beta_1,\beta_2,\beta_3$ 下的矩阵表示为 $B$

则

$$
\begin{aligned}
B &= P^{-1}AP\\
&=\begin{bmatrix}1&-1&0\\0&1&-1\\0&0&1\end{bmatrix}\begin{bmatrix}1&2&3\\-1&0&3\\2&1&5\end{bmatrix}\begin{bmatrix}1&1&1\\0&1&1\\0&0&1\end{bmatrix}\\
&=\begin{bmatrix}2&4&4\\-3&-4&-6\\2&3&8\end{bmatrix}
\end{aligned}
$$

（2）

由于方程组 $|A|\neq 0$，故 $AX=0$ 只有零解，所以 $\mathscr {A}$ 的核是零空间。由维数定理可知，$\mathscr {A}$ 的值域是线性空间 $\mathbb {R}^3$

___

#### 例 6

设线性变换 $\mathscr {A}$ 在基 $\alpha_1=(-1,1,1)^T,\alpha_2=(1,0,-1)^T,\alpha_3=(0,1,1)^T$ 下的矩阵表示是

$$
A = \begin{bmatrix}1&0&-1\\1&1&0\\-1&2&3\end{bmatrix}
$$

（1）求 $\mathscr {A}$ 在基 $\varepsilon_1=(1,0,0)^T,\varepsilon_2=(0,1,0)^T,\varepsilon_3=(0,1,1)^T$ 下的矩阵表示

（2）求 $\mathscr {A}$ 的核与值域

**解：**

（1）

$$
\because [\varepsilon_1,\varepsilon_2,\varepsilon_3] = [\alpha_1,\alpha_2,\alpha_3]P\\
\Rightarrow P = [\alpha_1,\alpha_2,\alpha_3]^{-1}·[\varepsilon_1,\varepsilon_2,\varepsilon_3]\\
\Rightarrow P=\begin{bmatrix}-1&1&-1\\0&1&-1\\1&0&1\end{bmatrix}
$$

设 $\mathscr {A}$ 在基 $\varepsilon_1,\varepsilon_2,\varepsilon_3$ 下的矩阵表示为为 $B$

则

$$
\begin{aligned}
B &= P^{-1}AP\\
&=\begin{bmatrix}-1&1&0\\1&-1&1\\1&0&1\end{bmatrix}\begin{bmatrix}1&0&-1\\1&1&0\\-1&2&3\end{bmatrix}\begin{bmatrix}-1&1&-1\\0&1&-1\\1&0&1\end{bmatrix}\\
&=\begin{bmatrix}1&1&0\\2&2&0\\3&0&2\end{bmatrix}
\end{aligned}
$$

（2）

由于方程组 $AX=0$ 的基础解系是 $[1,-1,1]^T$，所以 $\mathscr {A}$ 的核子空间

$$
\mathcal{N}(\mathscr{A})=\text{span}\{\alpha_1-\alpha_2+\alpha_3\}=\text{span}\{[-2,2,3]^T\}
$$

$\mathscr {A}$ 的值域

$$
\begin{aligned}
\mathcal{R}(\mathscr{A})&=\text{span}\{\mathscr{A}(\alpha_1),\mathscr{A}(\alpha_2),\mathscr{A}(\alpha_3)\}\\
&=\text{span}\{\alpha_1+\alpha_2-\alpha_3,\alpha_2+2\alpha_3,-\alpha_1+3\alpha_3\}\\
&=\text{span}\{[0,0,-1]^T,[1,2,1]^T,[1,2,2]^T\}\\
&=\text{span}\{[0,0,1]^T,[1,2,0]^T\}
\end{aligned}
$$



## 特征值与特征向量

#### 线性变换的特征值与特征向量

设 $\mathscr {A}$ 是数域 $\mathbb {F}$ 上的 $n$ 维线性空间 $V$ 的线性变换，若存在 $\alpha \neq 0, \lambda \in \mathbb {F}$，使

$$
\mathscr{A}(\alpha) = \lambda \alpha
$$

则称 $\lambda$ 为 $\mathscr {A}$ 的一个**特征值**，称 $\alpha$ 是 $\mathscr {A}$ 的属于特征值 $\lambda$ 的一个**特征向量**

用通俗的语言解释特征向量，其实就是在线性空间 $V$ 中存在某些特殊的向量，这些向量经过线性变换之后得到的向量方向不变，长度可能会进行伸缩

##### 线性变换 $\mathscr {A}$ 与矩阵表示 $A$ 的特征值和特征向量的关系

1.  $\lambda$ 是 $\mathscr {A}$ 的一个特征值 $\Leftrightarrow$ $\lambda$ 是 $A$ 的一个特征值
2.  $\alpha$ 是 $\mathscr {A}$ 的属于特征值 $\lambda$ 的一个特征向量 $\Leftrightarrow$ $\alpha$ 的坐标 $(x_1,x_2,...,x_n)^T$ 是 $A$ 的属于特征值 $\lambda$ 的特征向量

___

#### 例 1

设线性变换 $\mathscr {A}:\mathbb {C}^3\to \mathbb {C}^3$ 定义为

$$
\forall X=(x,y,z)^T,\mathscr{A}(X)=\begin{bmatrix}x+y\\x+y\\2z\end{bmatrix}
$$

求线性变换 $\mathscr {A}$ 的特征值与特征向量

**解**：由题可知，线性变换 $\mathscr {A}$ 很容易可以写成矩阵的表示形式，即

$$
\mathscr{A}(X)=\begin{bmatrix}x+y\\x+y\\2z\end{bmatrix}=AX=A\begin{bmatrix}x\\y\\z\end{bmatrix}\\
\Rightarrow A = \begin{bmatrix}1&1&0\\1&1&0\\0&0&2\end{bmatrix}
$$

于是问题转为求矩阵 $A$ 的特征值与特征向量，解得

$$
\lambda_1=\lambda_2=2,\alpha_1=(1,1,0)^T,\alpha_2=(0,0,1)^T\\
\lambda_3=0,\alpha_3=(1,-1,0)^T
$$

___

#### 不同基下线性变换的特征值与特征向量的关系

**定理：相似矩阵有相同的特征值**

线性变换在不同基下的矩阵表示的**特征值保持不变**，**特征向量不同**，但是存在关系，具体关系如下

若 $\xi=(x_1,x_2,...,x_n)^T$ 是 $n$ 阶矩阵 $A$ 属于特征值 $\lambda$ 的特征向量，$B=P^{-1} AP$，则 **$P^{-1}\xi$ 是 B 的属于特征值 $\lambda$ 的特征向量**

___

#### 特征子空间

设 $\lambda_i$ 是 $\mathscr {A}\in \mathcal {L}(V)$ 的特征向量（$\mathcal {L}(V)$ 表示线性空间 $V$ 上的全体线性变换的集合），则

$$
V_{\lambda_i}=\{\alpha\mid \mathscr{A}(\alpha)=\lambda_i\alpha\}
$$

是 $V$ 的子空间，$V_{\lambda_i}$ 称为 $\mathscr {A}$ 的特征子空间，$\dim (V_{\lambda_i})$ 称为 $\lambda_i$ 的**几何重数**

-   代数重数：设矩阵 $A$ 的特征值 $\lambda_i$ 的重根数为 $p_i$，则称 $p_i$ 为 $\lambda_i$ 的代数重数
-   几何重数：设 $\lambda_i$ 为矩阵 $A$ 的特征值，且 $\dim (V_{\lambda_i})=q$，则称 $q_i$ 为 $\lambda_i$ 的几何重数。**且有 $q_i≤p_i$**

___

#### 线性变换的不变子空间

设 $\mathscr {A}$ 是线性空间 $V$ 的线性变换，$W$ 是 $V$ 的子空间，如果对于任意向量 $\alpha \in W$ 都有 $\mathscr {A}(\alpha)\in W$，则称 $W$ 是 $\mathscr {A}$ 的不变子空间。并且 $\mathscr {A}$ 可以看作子空间 $W$ 上的一个线性变换，称为 $\mathscr {A}$ 在 $W$ 上的限制，记做 $\mathscr {A}|_W$，而且

$$
\mathscr{A}|_W(\alpha)=\mathscr{A}(\alpha), \forall \alpha \in W
$$

图示说明如下

![](https://z3.ax1x.com/2021/04/29/gF5MwQ.png#shadow)

##### 不变子空间的判定定理

$\mathscr {A}\in \mathcal {L}(V)$，$W$ 是 $V$ 的一个子空间，$\alpha_1,\alpha_2,...,\alpha_m$ 是 $W$ 的一个基，若

$$
\mathscr{A}(\alpha_i)\in W, i=1,2,...,m
$$

则 $W$ 是 $\mathscr {A}$ 的不变子空间

___

#### 方针准对角化与不变子空间的关系

tips：准对角矩阵也叫分块对角矩阵

设 $\mathscr {A}$ 是线性空间 $V$ 的线性变换，则 $V$ 可以分解为 $\mathscr {A}$ 的不变子空间的直和

$$
V = W_1 \oplus W_2
$$

的充分必要条件是 $\mathscr {A}$ 在 $V$ 的某个基下的矩阵是准对角矩阵

$$
\text{diag}\{A_1,A_2\}
$$

其中 $A_i$ 为 $\mathscr {A}|_{W_i}$ 在相应基下对应的矩阵

**证明：**

（充分性）设 $V$ 可以分解为 $\mathscr {A}$ 的不变子空间的直和 $V=W_1\oplus W_2$

取 $W_1$ 的基 $\alpha_1,\alpha_2,...,\alpha_r$，$W_2$ 的基 $\alpha_{r+1}, \alpha_{r+2}, \alpha_n$

则 $\alpha_1,\alpha_2,...,\alpha_r,\alpha_{r+1},...,\alpha_{n}$ 为 $V$ 的基

$$
\because W_i 为 \mathscr {A} 的不变子空间 \\
\therefore \mathscr {A}(\alpha_j)\in W_1,\ j=1,2,...,r\\
\mathscr {A}(\alpha_j)\in W_2,\ j=r+1,r+2,...,n\\
\Rightarrow \mathscr {A}(\alpha_j)=\sum_{i=1}^r a_{ij}\alpha_i,\ j=1,2,...,r\\
\mathscr {A}(\alpha_j)=\sum_{i=1}^r a_{ij}\alpha_i,\ j=r+1,r+2,...,n
$$

故 $\mathscr {A}$ 在基 $\alpha_1, \alpha_2,...,\alpha_r,\alpha_{r+1},...,\alpha_n$ 下的矩阵为 $\begin {bmatrix} A_1\\&A_2\end {bmatrix}$

（必要性）设 $\mathscr {A}$ 在 $V$ 的某个基 $\alpha_1,\alpha_2,...,\alpha_r,\alpha_{r+1},...,\alpha_n$ 下的矩阵为准对角矩阵 $\text {diag}\{A_1,A_2\}$

令 $W_1=\mathcal {L}\{\alpha_1,\alpha_2,...,\alpha_r\}$，$W_2=\mathcal {L}\{\alpha_{r+1}, \alpha_{r+2},...,\alpha_n\}$

则 $W_1,W_2$ 为 $\mathscr {A}$ 的不变子空间，且 $W_1+W_2=\mathcal {L}\{\alpha_1,\alpha_2,...,\alpha_r,\alpha_{r+1},...,\alpha_n\}=V$

又 $\dim (V)=\dim (W_1)+\dim (W_2)$，故 $V=W_1\oplus W_2$

注：上述定理可以推广到 $s$ 个情况

即设 $\mathscr {A}\in \mathcal {L}(V)$，则 $V$ 可以分解为 $\mathscr {A}$ 的不变子空间的直和 $V=W_1\oplus W_2\oplus・・・\oplus W_s$

##### 方阵的相似对角化

定理：矩阵 $A$ 可对角化的充要条件是 $A$ 的每一个特征值的几何重数等于代数重数

___

#### 例 2

设 $A^2=E$，试证：$A$ 的特征值只能是 $+1$ 或 $-1$

**证明：**设 $\lambda$ 是矩阵 $A$ 的任一特征值，其对应的特征向量为 $\alpha$，即有 $A\alpha=\lambda\alpha$，那么有 $A^2\alpha=\lambda^2\alpha$，又 $A^2=E$，于是可得 $(\lambda^2-1)\alpha=0$，注意到 $\alpha\neq0$，从而有 $\lambda^2=1$，因此 $A$ 的特征值只可能是 $+1$ 或 $-1$

___

#### 例 3

设 $A^2=A$，试证：$A$ 的特征值只可能是 $0$ 或 $1$

**证明：**设 $\lambda$ 是矩阵 $A$ 的任一特征值，其对应的特征向量为 $\alpha$，即有 $A\alpha=\lambda\alpha$，那么有 $A^2\alpha=\lambda^2\alpha$，又 $A^2=A$，于是可得 $(\lambda^2-\lambda)\alpha=0$，注意到 $\alpha\neq0$，从而有 $\lambda^2=\lambda$，因此 $A$ 的特征值只可能是 $0$ 或 $1$

___

#### 例 4

求矩阵 $A=\begin {bmatrix} 0&1&0\\-4&4&0\\-2&1&2\end {bmatrix}$ 的特征值与特征向量

**解：**$A$ 的特征多项式

$$
|\lambda E-A|=\begin{bmatrix}\lambda&-1&0\\4&\lambda-4&0\\2&-1&\lambda-2\end{bmatrix}=(\lambda-2)^3
$$

$A$ 的特征值 $\lambda_1=\lambda_2=\lambda_3=2$

当 $\lambda=2$ 时，特征矩阵

$$
\lambda E-A=\begin{bmatrix}2&-1&0\\4&-2&0\\2&-1&0\end{bmatrix}\to\begin{bmatrix}2&-1&0\\0&0&0\\0&0&0\end{bmatrix}
$$

对应于特征值 $\lambda=2$ 的线性无关特征向量为：$\alpha_1=[1,2,0]^T,\alpha_2=[0,0,1]^T$，于是属于特征值 $\lambda=2$ 的全部特征向量为 $k_1\alpha_1+k_2\alpha_2$，其中 $k_1,k_2$ 不全为 $0$



## $\lambda$矩阵和 Jordan 分块

#### 多项式

定义：$n$ 是非负整数，$\mathbb {F}$ 是一个数域，$a_0,a_1,...,a_n\in\mathbb {F}$

$$
f(\lambda)=a_n\lambda^n+a_{n-1}\lambda^{n-1}+···a_1\lambda+a_0
$$

称为数域上关于 $\lambda$ 的一元多项式

如果 $a_n\neq 0$，则称 $a_n\lambda^n$ 为 $f (\lambda)$ 的首项，$n$ 称为多项式的次数，记为 $\partial (f (\lambda))$，于是 $\partial (f (\lambda))=n$

如果 $a_0=a_1=・・・=a_n=0$，称该多项式为**零多项式**，规定 $\partial (f (\lambda))=-∞$

如果 $a_0\neq 0, a_1=・・・=a_n=0$，称该多项式为**零次多项式**，$\partial (f (\lambda))=0$，即该多项式为非零常数

#### 多项式的带余除法

定义：$f (\lambda),g (\lambda)\in\mathbb {F}[\lambda]$，如果 $g (\lambda)\neq 0$，则存在 $q (\lambda),r (\lambda)\in \mathbb {F}[\lambda]$，使得

$$
f(\lambda)=g(\lambda)q(\lambda)+r(\lambda)
$$

其中，要么 $r (\lambda)=0$，要么 $r (\lambda)\neq 0$ 且 $\partial (r (\lambda))<\partial (g (\lambda))$

$q (\lambda)$ 称为 $g (\lambda)$ 除 $f (\lambda)$ 的商，$r (\lambda)$ 称为余式

如果 $r (\lambda)=0$，则称 $g (\lambda)$ 整除 $f (\lambda)$，记为 $g (\lambda)|f (\lambda)$

#### 多项式的公因式，公倍式

-   $f (\lambda),g (\lambda),d (\lambda)\in \mathbb {F}[\lambda]$，如果 $d (\lambda)|f (\lambda)$ 且 $d (\lambda)|g (\lambda)$，则称 $d (\lambda)$ 为 $f (\lambda),g (\lambda)$ 的公因式
-   $f (\lambda),g (\lambda),d (\lambda)\in \mathbb {F}[\lambda]$，如果 $f (\lambda)|d (\lambda)$ 且 $g (\lambda)|d (\lambda)$，则称 $d (\lambda)$ 为 $f (\lambda),g (\lambda)$ 的公倍式
-   最大公因式 GCD：次数最大的公因式
-   最小公倍式 LCM：次数最小的公倍式

如果 $GCD (f (\lambda),g (\lambda))=1$，$f (\lambda)$ 和 $g (\lambda)$ 称为互质

#### 质因式分解

$$
f(\lambda)=(q_1(\lambda))^{r_1}(q_2(\lambda))^{r_2}···(q_s(\lambda))^{r_s}
$$

其中 $q_i (\lambda)$ 为不可约多项式，即 $q_i (\lambda)$ 不能表示成两个次数比 $q_i (\lambda)$ 低的多项式的乘积

> 类比实数域中的，任何一个合数都可以分解为几个质数的乘积

一个多项式是否可约，关键要看数域 $\mathbb {F}$，例如

$$
\mathbb {F}=\mathbb {R},\ \lambda^2+1,\ 不可约 \\
\mathbb {F}=\mathbb {C},\ \lambda^2+1=(\lambda+i)(\lambda-i),\ 可约
$$

#### 常见数域的不可约多项式

$\mathbb {R}[\lambda]$ 上不可约多项式只有两种

$$
\begin{aligned}
&a\lambda+b \ \ (a,b\in \mathbb{R}\  \&\ a\neq 0)\\
&a\lambda^2+b\lambda+c \ \ (a, b, c\in \mathbb{R} \  \& \ a\neq 0 \ \& \ b^2-4ac < 0)
\end{aligned}
$$

$\mathbb {C}[\lambda]$ 上不可约多项式只有一种

$$
a\lambda+b \ \ (a,b\in \mathbb{C}\ \&\ a\neq 0)
$$

___

#### $\lambda$ 矩阵

以多项式为元素的矩阵称为多项式矩阵，简称为 $\lambda$ 矩阵。记号 $\mathbb {F}^{m\times n}[\lambda]$ 表示所有 $m$ 行 $n$ 列的 $\lambda$ 矩阵的集合，矩阵的元素是系数在 $\mathbb {F}$ 中的 $\lambda$ 的多项式。也就是说，$A (\lambda)\in \mathbb {F}^{m\times n}[\lambda]$ 表示 $A (\lambda)=[a_{ij}(\lambda)]_{m\times n}$，其中，$a_{ij}(\lambda)\in \mathbb {F}[\lambda]$

方阵 $A$ 的特征矩阵 $\lambda I-A$ 也是 $\lambda$ 矩阵，例如

$$
A = (a_{ij})_{n\times m}\\
\lambda I-A = \begin{bmatrix}\lambda-a_{11}&-a_{12}&\cdots &-a_{1n}\\-a_{21}&\lambda-a_{22}&\cdots & -a_{2n}\\ \vdots \\-a_{n1}&-a_{n2}&\cdots & \lambda-a_{nn}\end{bmatrix}
$$

**数字矩阵是 $\lambda$ 矩阵的特例（由零多项式或零次多项式为元素构成的矩阵）**

#### 以多项式为元素的矩阵和以矩阵为系数的多项式

如

$$
A(\lambda)=\begin{bmatrix}\lambda^2+\lambda+1&\lambda-1\\2\lambda&1\end{bmatrix}
$$

可以写成

$$
A(\lambda)=\begin{bmatrix}1&0\\0&0\end{bmatrix}\lambda^2+\begin{bmatrix}1&1\\2&0\end{bmatrix}\lambda+\begin{bmatrix}1&-1\\0&1\end{bmatrix}
$$

多项式矩阵和通常矩阵的主要区别在于：其元素所在的运算系统 —— 多项式环 $\mathbb {F}[x]$—— 不是一个域，所以通常矩阵的性质中，涉及到除法的，对于多项式矩阵不再成立

#### $\lambda$ 矩阵的秩

$\lambda$ 矩阵的秩，也用 rank 表示，是指其值为非零多项式的子行列式的最大阶数。换言之，多项式矩阵的秩为 $r$ 是指：存在 $r$ 阶子行列式，其值为非零多项式；且所有阶数 $≥r+1$ 的子行列式的值均为零多项式。零矩阵的秩为 0

#### 可逆的 $\lambda$ 矩阵

一个 $n$ 阶 $\lambda$ 矩阵是可逆的，若存在多项式矩阵 $V (\lambda)\in \mathbb {F}^{n\times n}[\lambda]$ 使得

$$
U(\lambda)V(\lambda)=V(\lambda)U(\lambda)=I_n
$$

这里 $I_n$ 是 $n$ 阶单位阵，其中称为 $U (\lambda)$ 的逆矩阵，记为 $U^{-1}(\lambda)$

**定理：**一个 $n$ 阶 $\lambda$ 矩阵 $U (\lambda)$ 可逆的充要条件是 $\det U (\lambda)$ 是一个非零常数

> 注：$n$ 阶 $\lambda$ 矩阵 $U (\lambda)$ 的秩为 $n$，不等价于 $U (\lambda)$ 可逆，这是与数字矩阵不相同之处，例如 $U (\lambda)=\begin {bmatrix}\lambda &1\\1&\lambda\end {bmatrix}$ 的秩为 2，但是它不可逆

___

#### Jordan 块

定义形如 $J (\lambda_i)\begin {bmatrix}\lambda_i&1\\&\lambda_i&\ddots\\&&\ddots&1\\&&&\lambda_i\end {bmatrix}_{k\times k}$ 的矩阵称为 **Jordan 块**。Jordan 块是一个上三角矩阵，其主对角线上的元素均相等；主对角线上面一条斜线的元素均为 1；其余元素均为 0

特殊地，当 $k=1$ 时，一阶 Jordan 块是 $[\lambda_i]$

#### Jordan 形矩阵

形如 $J=\begin {bmatrix} J (\lambda_1)\\&J (\lambda_2)\\&&\ddots\\&&&J (\lambda_s)\end {bmatrix}$（其中 $J (\lambda_i)$ 均为 Jordan 块）的矩阵称为 **Jordan 形矩阵**。Jordan 形矩阵是一个分块对角阵，其中每一个小分块都是 Jordan 块

#### Jordan 标准形

若矩阵 $A$ 与 Jordan 形矩阵 $J$ 相似，则称 $J$ 是 $A$ 的 Jordan 标准形

___

#### 例 1

判断下列矩阵是否为 Jordan 形矩阵

$$
\begin{bmatrix}1&0&0\\0&2&0\\0&0&2\end{bmatrix},\begin{bmatrix}1&1&0\\0&2&1\\0&0&2\end{bmatrix},\begin{bmatrix}1&1&0\\0&2&0\\0&0&2\end{bmatrix},\begin{bmatrix}1&0&0\\0&2&1\\0&0&2\end{bmatrix}\\
\begin{bmatrix}2&1&0\\0&0&1\\0&0&0\end{bmatrix},\begin{bmatrix}2&0&0\\0&0&1\\0&0&0\end{bmatrix},\begin{bmatrix}1&0&0&0\\0&2&1&0\\0&0&2&0\\0&0&0&1\end{bmatrix}
$$

**解：**对于正确的 Jordan 形矩阵，用黑线给出了分块形式；对于错误的 Jordan 形矩阵，指出了需要修改的元素

![](https://z3.ax1x.com/2021/04/20/cH9Mo6.png#shadow)

___

#### Jordan 标准形的存在性、唯一性

**对矩阵 $A$ 的 Jordan 标准形中每个分块改变排列顺序，得到的依然是 Jordan 标准形**

若 $J=\begin {bmatrix} J_1\\&J_2\\&&\ddots\\&&&J_s\end {bmatrix}$ 是矩阵 $A$ 的 Jordan 标准形，而 $K=\begin {bmatrix} J_{i_1}\\&J_{i_2}\\&&\ddots \\&&&J_{i_s}\end {bmatrix}$，其中 $J_{i_1},J_{i_2},...,J_{i_s}$ 是 $J_1,J_2,...,J_s$ 的一个排列，则 $K$ 也是 $A$ 的 Jordan 标准形

那么所谓的 Jordan 标准形的唯一性是如何定义的呢？**除了相差 Jordan 块的次序外，矩阵的 Jordan 标准形是存在的、唯一的**

#### 性质

1.  若 $A$ 与 $J$ 相似，$\lambda_0$ 是数，则对一切正整数 $k$，$\mathrm {rank}((A-\lambda_0E)^k)=\mathrm {rank}((J-\lambda_0E)^k)$
2.  若 $n\times n$ 矩阵 $N=\begin {bmatrix} 0&1\\&0&\ddots\\&&\ddots&1\\&&&1\end {bmatrix}$，则 $\mathrm {rank}(N^{k-1})-\mathrm {rank}(N^k)=\begin {cases} 1, 若 k≤n\\0, 若 k>n\end {cases}$
3.  若 $J$ 是 Jordan 矩阵，则 $\mathrm {rank}((J-\lambda_0E)^{k-1})-\mathrm {rank}((J-\lambda_0E)^l)$ 等于 $J$ 中阶数 $≥k$ 的，以 $\lambda_0$ 为主对角元的 Jordan 块的块数

#### 定理

设 $\lambda_0$ 是矩阵 $A$ 的特征值，则 $A$ 的 Jordan 标准形中以 $\lambda_0$ 为主对角元的 $k$ 阶 Jordan 块的块数为

$$
\mathrm{rank}(B^{k-1})-2·\mathrm{rank}(B^k)+\mathrm{rank}(B^{k+1})
$$

其中，$B=A-\lambda_0E$

根据这个定理，我们只要针对矩阵 $A$ 的每一个特征值 $\lambda_0$，依次求解相应于这个特征值的每一阶 Jordan 块的块数，就可以把矩阵 $A$ 的 Jordan 标准形完全求解出来。但实际上，这一工作需要大量的计算，在实际中不会采用。我们只需要明确，**根据一个矩阵 $A$ 的特征值、$A-\lambda_0E$、阶数 $k$ 等信息就能够完全确定矩阵 $A$ 对应的 Jordan 标准形**

___

#### Jordan 标准形的求法

-   求矩阵 $A$ 的特征多项式 $|\lambda E-A| = (\lambda - \lambda_1)^{k_1}(\lambda-\lambda_2)^{k_2}...(\lambda - \lambda_s)^{k_s}$，其中 $k_i$ 是特征值 $\lambda_i$ 的**代数重数，决定了对角线上特征值 $\lambda_i$ 的个数**；
-   对 $\lambda_i$，由 $(A-\lambda_i E) X=0$，求 $A$ 的**线性无关的特征向量** $\alpha_1,\alpha_2, ...,\alpha_{t_i}$，其中 $t_i$ 是特征值 $\lambda_i$ 的**几何重数，决定了 Jordan 块的个数**；
  
    -   如果 $k_i = t_i$，即**代数重数等于几何重数**，说明 $\lambda_i$ 对应的 Jordan 块是对角阵；
    -   如果 $t_i < k_i$，就选择合适的特征向量 $\alpha_j$，利用方程 **${\color {red} {(A-\lambda_i E) = \alpha_j}}$ 求 Jordan 链**，确定每一个小 Jordan 块的阶数。
-   将所有特征值 $\lambda_i$ 对应的 Jordan 块组合起来，形成 Jordan 矩阵 $J_A$

___

#### 例 2

求矩阵 $A=\begin {bmatrix}-1&-2&6\\-1&0&3\\-1&-1&4\end {bmatrix}$ 的 Jordan 标准形

**解：**容易求得矩阵 $A$ 的特征多项式为 $C (\lambda)=(\lambda-1)^3$，所以 $A$ 的 Jordan 标准形矩阵只可能是以下三种情况

$$
\begin{bmatrix}1&0&0\\0&1&0\\0&0&1\end{bmatrix},\begin{bmatrix}1&0&0\\0&1&1\\0&0&1\end{bmatrix},\begin{bmatrix}1&1&0\\0&1&1\\0&0&1\end{bmatrix}
$$

验证第一个矩阵，若 $A$ 与 $\begin {bmatrix} 1&0&0\\0&1&0\\0&0&1\end {bmatrix}$ 相似，那么存在一个可逆矩阵 $P$，使得 $P^{-1} AP=J=E$，则 $AP=P$，即 $A=E$，与题意不符，故排除

验证第二和第三个矩阵，记第二个矩阵为 $J_2$，第三个矩阵为 $J_3$，通过计算得 $\mathrm {rank}(J_2-E)=1,\mathrm {rank}(J_3-E)=2$，因为矩阵 $A$ 相似于 $J$，所以有 $\mathrm {rank}(A-E)=\mathrm {rank}(J-E)$，通过计算得 $\mathrm {rank}(A-E)=1$，由此可知最终的 Jordan 标准形矩阵就是 $J_2$

___

#### 例 3

求矩阵 $B=\begin {bmatrix} 13&16&16\\-5&-7&-6\\-6&-8&-7\end {bmatrix}$ 的 Jordan 标准形

**解：**容易求得矩阵 $B$ 的特征多项式为 $C (\lambda)=(\lambda+3)(\lambda-1)^2$，所以 $B$ 的 Jordan 标准形只可能是以下两种情况

$$
J_1=\begin{bmatrix}-3&0&0\\0&1&0\\0&0&1\end{bmatrix}\\
J_2=\begin{bmatrix}-3&0&0\\0&1&1\\0&0&1\end{bmatrix}
$$

通过计算得 $\mathrm {rank}(J_1-E)=1,\mathrm {rank}(J_2-E)=2$，因为 $\mathrm {rank}(B-E)=2$，所以最终的 Jordan 标准形矩阵就是 $J_2$

___

#### 例 4

用初等变换把 $\lambda$ 矩阵 $\begin {bmatrix} 1-\lambda&\lambda^2&\lambda\\\lambda&\lambda&-\lambda\\1+\lambda^2&\lambda^2&\lambda\end {bmatrix}$ 化为标准形

**解：**

$$
\begin{aligned}
\begin{bmatrix}1-\lambda&\lambda^2&\lambda\\\lambda&\lambda&-\lambda\\1+\lambda^2&\lambda^2&\lambda\end{bmatrix}&\to\begin{bmatrix}1&0&\lambda\\0&\lambda+\lambda^2&-\lambda\\1+\lambda+\lambda^2&0&\lambda\end{bmatrix}\\
&\to\begin{bmatrix}1&0&\lambda\\0&\lambda+\lambda^2&-\lambda\\0&0&-\lambda^3-\lambda^2\end{bmatrix}\\
&\to\begin{bmatrix}1&0&0\\0&\lambda+\lambda^2&-\lambda\\0&0&-\lambda^3-\lambda^2\end{bmatrix}\\
&\to\begin{bmatrix}1&0&0\\0&\lambda&0\\0&0&\lambda^2(1+\lambda^2)\end{bmatrix}
\end{aligned}
$$

___

#### 例 5

证明：Jordan 块

$$
J(a)=\begin{bmatrix}a&1&0\\0&a&1\\0&0&a\end{bmatrix}
$$

相似于矩阵

$$
\begin{bmatrix}a&\epsilon &0\\0&a&\epsilon\\0&0&a\end{bmatrix}
$$

其中 $\epsilon \neq 0$ 为任意实数

**证：**由定理 **$A\sim B$ 的充要条件是 $A,B$ 有相同的不变因子**，即判断下面两个 $\lambda$ 矩阵

$$
\begin{bmatrix}\lambda -a&-1&0\\0&\lambda-a&-1\\0&0&\lambda-a\end{bmatrix},\begin{bmatrix}\lambda-a&-\epsilon&0\\0&\lambda-a&-\epsilon\\0&0&\lambda-a\end{bmatrix}
$$

是否等价，容易求出这两个 $\lambda$ 矩阵的不变因子均为 $1,1,(\lambda-a)^2$，故 $J (a)$ 与 $\begin {bmatrix} a&\epsilon &0\\0&a&\epsilon\\0&0&a\end {bmatrix}$ 相似

___

#### 例 6

已知 10 阶矩阵 $A=\begin {bmatrix} a&1\\&a&1\\&&\ddots&\ddots\\&&&\ddots &1\\&&&&a\end {bmatrix}_{10\times 10},B=\begin {bmatrix} a&1\\&a&1\\&&\ddots&\ddots\\&&&\ddots &1\\\epsilon&&&&a\end {bmatrix}_{10\times 10}$，其中 $\epsilon=10^{-10}$，证明 $A\nsim B$

**证：**只需判断 $\lambda E-A$ 与 $\lambda E-B$ 是否等价，对于 $\lambda$ 矩阵

$$
A=\begin{bmatrix}\lambda-a&-1\\&\lambda-a&-1\\&&\ddots&\ddots\\&&&\ddots &-1\\&&&&\lambda-a\end{bmatrix}_{10\times 10}
$$

其不变因子为 $1,1,...,(\lambda-a)^{10}$；对于 $\lambda$ 矩阵

$$
B=\begin{bmatrix}\lambda-a&-1\\&\lambda-a&-1\\&&\ddots&\ddots\\&&&\ddots &-1\\-\epsilon&&&&\lambda-a\end{bmatrix}_{10\times 10}
$$

其不变因子为 $1,1,...,(\lambda-a)^{10}-\epsilon$，显然 $A$ 与 $B$ 不具有相同的不变因子，从而 $A\nsim B$

___

#### 例 7

设 $A\neq 0,A^k=0\ \ (k≥2)$，证明 $A$ 不能与对角矩阵相似

**证：**用反证法，设 $A$ 可以对角化，则存在可逆矩阵 $P$ 使得

$$
P^{-1}AP=\begin{bmatrix}\lambda_1\\&\ddots\\&&\lambda_n\end{bmatrix}
$$

因为 $A^k=0$，所以

$$
A^k=(P\begin{bmatrix}\lambda_1\\&\ddots\\&&\lambda_n\end{bmatrix}P^{-1})^k=0
$$

即

$$
\begin{bmatrix}\lambda_1\\&\ddots\\&&\lambda_n\end{bmatrix}=0
$$

由此可知 $\lambda_1=\lambda_2=・・・=\lambda_n=0$，故 $P^{-1} AP=\begin {bmatrix} 0\\&\ddots\\&&0\end {bmatrix}$，这表明 $A=0$，与已知 $A\neq 0$ 矛盾，故 $A$ 不能与对角矩阵相似

___

#### 例 8

已知 $A^2=A$，证明 $A$ 相似于矩阵 $\begin {bmatrix} 1\\&\ddots\\&&1\\&&&0\\&&&&\ddots\\&&&&&0\end {bmatrix}$

**证：**设矩阵 $A$ 的 Jordan 标准形为

$$
J=\begin{bmatrix}J_1\\&J_2\\&&\ddots\\&&&J_s\end{bmatrix},J_i=\begin{bmatrix}\lambda_i&1\\&\lambda_i&1\\&&\ddots&\ddots\\&&&&1\\&&&&\lambda_i\end{bmatrix}_{n_i\times n_i}
$$

则存在可逆矩阵 $P$，使 $P^{-1} A^kP=J$

由于 $A^2=A$，所以 $J^2=(P^{-1} AP)=P^{-1} A^2P=J=P^{-1} AP$，则

$$
J_i^2=J_i,\quad{i=1,2,...,s}
$$

即

$$
\begin{bmatrix}\lambda_i^2&2\lambda_i&1&0&\cdots&0\\0&\lambda_i^2&2\lambda_i&1\\\vdots &&&\ddots&\ddots&\vdots\\&&&&&1\\&&&&&2\lambda_i\\0&&\cdots &&0 &\lambda_i^2\end{bmatrix}=\begin{bmatrix}\lambda_i&1\\&\lambda_i&1\\&&\ddots&\ddots\\&&&&1\\&&&&\lambda_i\end{bmatrix}
$$

从而 $\lambda_i=0$ 或 $\lambda_i=1$，所以 $J$ 为一个对角矩阵且主对角线上的元素只能为 1 或 0，只当调整对角线上元素的顺序，可得方阵 $\begin {bmatrix} 1\\&\ddots\\&&1\\&&&0\\&&&&\ddots\\&&&&&0\end {bmatrix}$

而且 $A$ 相似于此方阵

___

#### 例 9

求矩阵 $A=\begin {bmatrix} 1&2&0\\0&2&0\\-2&-2&1\end {bmatrix}$ 的 Jordan 标准形及其变换矩阵 $P$

**解：**因为

$$
\lambda E-A=\begin{bmatrix}\lambda-1&-2&0\\0&\lambda-2&0\\2&2&\lambda-1\end{bmatrix}\to\begin{bmatrix}1\\&1\\&&(\lambda-2)(\lambda-1)^2\end{bmatrix}
$$

所以 $A$ 的 Jordan 标准形可能为

$$
\begin{bmatrix}2&0&0\\0&1&1\\0&0&1\end{bmatrix},\begin{bmatrix}1&0&0\\0&1&0\\0&0&2\end{bmatrix}
$$

因为 $\mathrm {rank}(E-A)=2$，故 $A$ 的 Jordan 标准形只能是 $J=\begin {bmatrix} 2&0&0\\0&1&1\\0&0&1\end {bmatrix}$

故 $\exists P$，使得 $AP=PJ$，令 $P=[X_1,X_2,X_3]$，则

$$
[AX_1,AX_2,AX_3]=[X_1,X_2,X_3]\begin{bmatrix}2&0&0\\0&1&1\\0&0&1\end{bmatrix}\\
\Rightarrow \begin{cases}AX_1=2X_1\\AX_2=X_2\\AX_3=X_2+X_3\end{cases}\\
\Rightarrow \begin{cases}(2E-A)X_1=0\\(E-A)X_2=0\\(E-A)X_2=X_3\end{cases}
$$

由齐次线性方程组 $(2E-A) X_1=0$ 可得 $X_1=[2,1,-6]^T$

由齐次线性方程租 $(E-A) X_2=0$ 可得 $X_2=[0,0,1]^T$，带入 $(E-A) X_2=X_3$ 得 $X_3=[-\frac {1}{2},0,0]^T$

所以 $P=[X_1,X_2,X_3]=\begin {bmatrix} 2&0&-\frac {1}{2}\\3&0&0\\-6&1&0\end {bmatrix}$

___

#### 例 10

已知 $A=\begin {bmatrix} 2&1&0\\0&0&1\\0&1&0\end {bmatrix}$，求 $A^{100}$

**解：**

$$
\lambda E-A=\begin{bmatrix}\lambda-2&-1&0\\0&\lambda&-1\\0&-1&\lambda\end{bmatrix}\to\begin{bmatrix}1\\&1\\&(\lambda^2-1)(\lambda-2)\end{bmatrix}
$$

所以 $A$ 的 Jordan 标准形为 $J=\begin {bmatrix}-1&0&0\\0&1&0\\0&0&2\end {bmatrix}$

故 $\exists P$，使得 $AP=PJ$，令 $P=[X_1,X_2,X_3]$，则

$$
[AX_1,AX_2,AX_3]=[X_1,X_2,X_3]\begin{bmatrix}-1&0&0\\0&1&0\\0&0&2\end{bmatrix}\\
\Rightarrow \begin{cases}AX_1=-X_1\\AX_2=X_2\\AX_3=2X_3\end{cases}\\
\Rightarrow \begin{cases}(E+A)X_1=0\\(E-A)X_2=0\\(2E-A)X_3=0\end{cases}\\
\Rightarrow \begin{cases}X_1=(1,-3,3)^T\\X_2=(-1,1,1)^T\\X_3=(1,0,0)^T\end{cases}
$$

所以 $P=\begin {bmatrix} 1&-1&1\\-3&1&0\\3&1&0\end {bmatrix},P^{-1}=\begin {bmatrix} 0&-\frac {1}{6}&\frac {1}{6}\\0&\frac {1}{2}&\frac {1}{2}\\1&\frac {2}{3}&\frac {1} 3\end {bmatrix}$，则

$$
\begin{aligned}
A^{100}&=PJ^{100}P^{-1}\\
&=\begin{bmatrix}1&-1&1\\-3&1&0\\3&1&0\end{bmatrix}\begin{bmatrix}(-1)^{100}&0&0\\0&1^{100}&0\\0&0&2^{100}\end{bmatrix}\begin{bmatrix}0&-\frac{1}{6}&\frac{1}{6}\\0&\frac{1}{2}&\frac{1}{2}\\1&\frac{2}{3}&\frac{1}3\end{bmatrix}\\
&=\begin{bmatrix}1&-1&2^{100}\\-3&1&0\\3&1&0\end{bmatrix}\begin{bmatrix}0&-\frac{1}{6}&\frac{1}{6}\\0&\frac{1}{2}&\frac{1}{2}\\1&\frac{2}{3}&\frac{1}3\end{bmatrix}\\
&=\begin{bmatrix}2^{100}&\frac{2^{99}-2}{3}&\frac{2^{100}-1}{3}\\0&1&0\\0&0&1\end{bmatrix}
\end{aligned}
$$




## Gram 矩阵

#### 欧氏空间

$V$ 是 $\mathbb {R}$ 上的线性空间，定义映射

$$
\sigma: V\times V \to \mathbb{R}
$$

对于 $\alpha, \beta \in V$，将 $\sigma (\alpha, \beta)$ 记为 $\left<\alpha, \beta\right>$，若 $\sigma$ 满足：

1.  对称性：$\left<\alpha.\beta\right>=\left<\beta, \alpha\right>$
2.  （右）齐次性：$\left<\alpha, k\beta\right>=k\left<\alpha,\beta\right>$
3.  （右）可加性：$\left<\alpha, \beta+\gamma\right>=\left<\alpha,\beta\right>+\left<\alpha, \gamma\right>$
4.  非负性：$\left<\alpha,\alpha\right>≥0$，且 $\left<\alpha,\alpha\right>=0\Leftrightarrow\alpha=0$

则称 $\sigma$ 为 $V$ 上的（实）内积，**当 $V$ 是有限维时，称其为欧氏空间**（$\mathbb {R}^n$ 为标准欧氏空间）

实际上 $\alpha$ 是一个向量，$\beta$ 是一个向量，$\left<\alpha, \beta\right>$ 表示向量 $\alpha$ 与向量 $\beta$ 的内积，结果是一个实数

##### 实内积的性质

1.  （左）齐次性：$\left<k\alpha, \beta\right>=k\left<\alpha,\beta\right>$
2.  （左）可加性：$\left<\alpha+\beta, \gamma\right>=\left<\alpha,\gamma\right>+\left<\beta, \gamma\right>$
3.  $\left<k_1\alpha_1+···+k_s\alpha_s,\beta\right>=k_1\left<\alpha_1,\beta\right>+···k_s\left<\alpha_s,\beta\right>$
4.  $\left<\alpha,k_1\beta_1+···+k_s\beta_s\right>=k_1\left<\alpha,\beta_1\right>+···k_s\left<\alpha,\beta_s\right>$

___

#### 复内积

$V$ 是 $\mathbb {C}$ 上的线性空间，定义映射

$$
\sigma: V\times V \to \mathbb{C}
$$

对于 $\alpha, \beta \in V$，将 $\sigma (\alpha, \beta)$ 记为 $\left<\alpha, \beta\right>$，若 $\sigma$ 满足：

1.  共轭对称性：$\left<\alpha.\beta\right>=\overline {\left<\beta, \alpha\right>}$
2.  （右）齐次性：$\left<\alpha, k\beta\right>=k\left<\alpha,\beta\right>$
3.  （右）可加性：$\left<\alpha, \beta+\gamma\right>=\left<\alpha,\beta\right>+\left<\alpha, \gamma\right>$
4.  非负性：$\left<\alpha,\alpha\right>≥0$，且 $\left<\alpha,\alpha\right>=0\Leftrightarrow\alpha=0$

则称 $\sigma$ 为 $V$ 上的（复）内积，**当 $V$ 是有限维时，称其为酉空间**（$\mathbb {R}^n$ 为标准欧氏空间）

##### 复内积的性质

1.  （左）齐次性：$\left<k\alpha, \beta\right>=\bar {k}\left<\alpha,\beta\right>$
2.  （左）可加性：$\left<\alpha+\beta, \gamma\right>=\left<\alpha,\gamma\right>+\left<\beta, \gamma\right>$
3.  $\left<k_1\alpha_1+···+k_s\alpha_s,\beta\right>=\overline{k_1}\left<\alpha_1,\beta\right>+···\overline{k_s}\left<\alpha_s,\beta\right>$
4.  $\left<\alpha,k_1\beta_1+···+k_s\beta_s\right>=k_1\left<\alpha,\beta_1\right>+···k_s\left<\alpha,\beta_s\right>$

___

#### 线性组合的内积的矩阵表示

$\alpha_1,...,\alpha_s;\beta_1,...,\beta_t$ 是 $\mathbb {C}$ 上的内积空间 $V$ 中的两个向量组，则

$$
\begin{aligned}
\left<k_1\alpha_1+···+k_s\alpha_s,l_1\beta_1+···+l_t\beta_t\right>\\
=(\overline{k_1},...,\overline{k_s})\begin{bmatrix}\left<\alpha_1,\beta_1\right>&\cdots &\left<\alpha_1,\beta_t\right>\\ \vdots & \ddots &\vdots \\\left<\alpha_s,\beta_1\right> &\cdots & \left<\alpha_s,\beta_t\right>\end{bmatrix}\begin{bmatrix}l_1\\ \vdots \\ l_t\end{bmatrix}
\end{aligned}
$$

___

#### Gram 矩阵

$\alpha_1,...,\alpha_s;\beta_1,...,\beta_t$ 是 $\mathbb {C}$ 上的内积空间 $V$ 中的两个向量组，则

$$
\begin{bmatrix}\left<\alpha_1,\beta_1\right>&\cdots &\left<\alpha_1,\beta_t\right>\\ \vdots & \ddots &\vdots \\\left<\alpha_s,\beta_1\right> &\cdots & \left<\alpha_s,\beta_t\right>\end{bmatrix}
$$

称为 $\alpha_1,...,\alpha_s;\beta_1,...,\beta_t$ 的协 Gram 矩阵，记为 $G (\alpha_1,...,\alpha_s;\beta_1,...,\beta_t)$

$\alpha_1,...,\alpha_s$ 是 $\mathbb {C}$ 上的内积空间 $V$ 中的一个向量组，则

$$
\begin{bmatrix}\left<\alpha_1,\beta_1\right>&\cdots &\left<\alpha_1,\beta_t\right>\\ \vdots & \ddots &\vdots \\\left<\alpha_s,\beta_1\right> &\cdots & \left<\alpha_s,\beta_t\right>\end{bmatrix}
$$

称为 $\alpha_1,...,\alpha_s$ 的 Gram 矩阵，记为 $G (\alpha_1,...,\alpha_s)$

$\alpha_1,...,\alpha_s$ 是 $\mathbb {C}^n$ 中的一个向量组，记 $A=(\alpha_1,...,\alpha_s)$，则

$$
G(\alpha_1,...,\alpha_s)=A^HA
$$

其中，$A^H=(\bar {A})^T=\overline {(A^T)}$

$\alpha_1,...,\alpha_s$ 是 $\mathbb {R}^n$ 中的一个向量组，记 $A=(\alpha_1,...,\alpha_s)$，则

$$
G(\alpha_1,...,\alpha_s)=A^TA
$$

$\alpha_1,...,\alpha_s;\beta_1,...,\beta_t$ 是 $\mathbb {C}$ 上的内积空间 $V$ 中的两个向量组，如果 $\alpha_1,...,\alpha_s$ 可由 $\beta_1,...,\beta_t$ 线性表出，且

$$
(\alpha_1,...,\alpha_s)=(\beta_1,...,\beta_t)A
$$

则

$$
G(\alpha_1,...,\alpha_s)=A^HG(\beta_1,...,\beta_t)A
$$

##### Gram 矩阵的性质

1.  $\mathrm{rank}(G)=\mathrm{rank}(\alpha_1,...,\alpha_s)$
2.  Hermite 性：$G^H=G$
3.  非负性：$\forall x\in \mathbb {C}^s$，复二次型 $x^HGx≥0$，并且 $G$ 正定 $\Leftrightarrow \alpha_1,...,\alpha_s$ 线性无关



## 正交、投影、标准正交

#### 内积

定义：假设 $V$ 是数域 $\mathbb {F}$ 上的线性空间，在 $V$ 上定义了一个二元函数 $\left<\alpha, \beta\right>$，若

1.  $\forall \alpha\neq 0\in V,\left<\alpha,\alpha\right>>0$
2.  $\forall \alpha,\beta,\gamma \in V,\left<\alpha+\beta,\gamma\right>=\left<\alpha,\gamma\right>+\left<\beta,\gamma\right>$
3.  $\forall\alpha,\beta\in V,k\in \mathbb{F},\left<k\alpha,\beta\right>=k\left<\alpha,\beta\right>$
4.  $\left<\alpha,\beta\right>=\overline{\left<\beta,\alpha\right>}$

则称 $\left<\alpha,\beta\right>$ 是 $\alpha,\beta$ 的内积。定义了内积的线性空间称为内积空间

当 $\mathbb {F}=\mathbb {R}$ 时，称 $V$ 是欧式空间；当 $\mathbb {F}=\mathbb {C}$ 时，称 $V$ 是酉空间

##### 内积的性质

1.  $\left<\alpha, \beta+\gamma\right>=\left<\alpha,\beta\right>+\left<\alpha,\gamma\right>$
2.  $\left<\alpha,k\beta\right>=\overline{k}\left<\alpha,\beta\right>$
3.  $\left<\sum_{i=1}^s k_i\alpha_i, \sum_{j=1}^t l_j\beta_j\right>=\sum_{i=1}^s\sum_{j=1}^tk_i\overline{l_j}\left<\alpha_i,\beta_j\right>$
4.  $\forall \alpha\in V,\left<\alpha, 0\right>=\left<0,\alpha\right>=0$

现证明性质 (2)

$$
\begin{aligned}
\because \left<\alpha, k\beta\right>&=\overline{\left<k\beta, \alpha\right>}\\
&=\overline{k\left<\beta,\alpha\right>}\\
&=\overline{k}·\overline{\left<\beta,\alpha\right>}\\
&=\overline{k}\left<\alpha,\beta\right>
\end{aligned}
$$

___

#### 内积的简易表示 —— 度量矩阵

设 $\epsilon_1,\epsilon_2,...,\epsilon_n$ 是 $V$ 的一组基，$\alpha,\beta\in V$ 的坐标是

$$
X = (x_1,x_2,...,x_n)^T,Y=(y_1,y_2,...,y_n)^T
$$

即

$$
\alpha = (\epsilon_1,\epsilon_2,...,\epsilon_n)X\\
\beta=(\epsilon_1,\epsilon_2,...,\epsilon_n)Y
$$

则 $\left<\alpha,\beta\right>=\sum_{i=1}^n\sum_{j=1}^nx_i\overline {y_j}\left<\epsilon_i,\epsilon_j\right>=X^TA\overline {Y}$

其中，$A=\begin {bmatrix}\left<\epsilon_1,\epsilon_1\right>&\left<\epsilon_1,\epsilon_2\right>&\cdots &\left<\epsilon_1,\epsilon_n\right>\\\left<\epsilon_2,\epsilon_1\right>&\left<\epsilon_2,\epsilon_2\right>&\cdots &\left<\epsilon_2,\epsilon_1\right>\\\vdots & \vdots & \ddots & \vdots \\\left<\epsilon_n,\epsilon_1\right>&\left<\epsilon_n,\epsilon_2\right>&\cdots &\left<\epsilon_n,\epsilon_n\right>\end {bmatrix}_{n\times n}$，并称 $A$ 是 $V$ 在基 $\epsilon_1,\epsilon_2,...,\epsilon_n$ 下的**度量矩阵**

##### 度量矩阵的特点

若 $\mathbb {F}=\mathbb {R}$，则 $A=A^T$，即 $\left<\epsilon_i,\epsilon_j\right>=\left<\epsilon_j,\epsilon_i\right>$

若 $\mathbb {F}=\mathbb {C}$，则 $A=A^H$，即 $\left<\epsilon_i,\epsilon_j\right>=\overline {\left<\epsilon_j,\epsilon_i\right>}$

___

#### 内积空间的度量

$V$ 是内积空间，定义向量长度（模）为

$$
||\alpha||=\sqrt{\left<\alpha, \alpha\right>}
$$

##### 长度的性质

1.  非负性：$||\alpha||≥0$，当且仅当 $\alpha=0$ 时，$||\alpha||=0$
2.  正齐次性：$||k\alpha||=|k|・||\alpha||$，$k$ 为任意数
3.  三角不等式：$|\left<\alpha,\beta \right>|≤||\alpha||・||\beta||,\ |\left< \alpha,\beta \right>|=||\alpha||・||\beta||\Leftrightarrow\alpha,\beta$ 线性相关
4.  Cauchy-Schwarz 不等式：$|\left<\alpha,\beta\right>|≤||\alpha||・||\beta||,\ |\left< \alpha,\beta \right>|=||\alpha||・||\beta||\Leftrightarrow\alpha,\beta$ 线性相关
5.  平行四边形公式：$||\alpha+\beta||^2+||\alpha-\beta||^2=2 (||\alpha||^2+||\beta||^2)$

___

#### 距离

$V$ 是内积空间，定义向量之间的距离为

$$
d(\alpha,\beta)=||\alpha-\beta||
$$

##### 距离的性质

1.  对称性：$d (\alpha,\beta)=d (\beta, \alpha)$
2.  非负性：$d (\alpha,\beta)≥0,\ d (\alpha,\beta)=0\Leftrightarrow \alpha=\beta$
3.  三角不等式：$d (\alpha,\beta)≤d (\alpha,\gamma)+d (\gamma, \beta)$

___

#### 夹角

（对于**实内积空间**）由 Cauchy-Schwarz 不等式 $|\left<\alpha,\beta \right>|≤||\alpha||・||\beta||\Rightarrow$ 若 $\alpha \neq 0,\beta \neq 0$，则

$$
-1≤\frac{\left< \alpha,\beta \right>}{||\alpha||·||\beta||}≤1
$$

若 $\alpha \neq 0, \beta \neq 0$，定义 $\alpha,\beta$ 的夹角为 $\arccos\frac {\left< \alpha,\beta \right>}{||\alpha||・||\beta||}$

___

#### 正交

（对于**所有内积空间**）若 $\left<\alpha,\beta \right>=0$，称向量 $\alpha,\beta$ 正交（垂直），记为 $\alpha \perp \beta$，并且 $\forall \alpha \in V$，都有 $0 \perp \alpha$

设 $W$ 是 $V$ 的子空间，$\alpha \in V$，若 $\forall \beta \in W$，都有 $\alpha \perp \beta$，则称 $\alpha$ 垂直于 $W$，记为 $\alpha \perp W$

##### 勾股定理

若 $\alpha \neq 0, \beta \neq 0$，且 $\alpha \perp \beta$，则

$$
||\alpha \pm \beta||^2=||\alpha||^2+||\beta||^2
$$

___

#### 投影定理

设 $V$ 是内积空间，$W$ 是 $V$ 的一个有限维子空间，则 $\forall \alpha \in V$

1.  存在唯一的 $\beta \in W$，使得对于 $\forall \gamma \in W$，有 $d (\alpha, \beta)≤d (\alpha, \gamma)$
2.  如果 $\beta_1,...,\beta_m$ 是 $W$ 的基，则在该基下的坐标是 $G^{-1}(\beta_1,...,\beta_m) G (\beta_1,...,\beta_m;\alpha)$，其中 $G (\beta_1,...,\beta_m;\alpha)=\begin {bmatrix}\left< \beta_1,\alpha\right> \\ \left< \beta_2,\alpha \right>\\\vdots \\\left< \beta_m,\alpha \right>\end {bmatrix}$

称满足上述形式的 $\beta$ 为 $\alpha$ 在 $W$ 上的投影

**第二个定理的证明：**设 $\beta_1,...,\beta_m$ 是 $W$ 的基，$\beta$ 是 $\alpha$ 在 $W$ 上的投影，$\beta$ 在 $\beta_1,...,\beta_m$ 确定的基下的坐标为 $x=[x_1,...,x_m]^T$

$$
\begin{aligned}
\because\  &\alpha-\beta \perp W\\
\therefore\  &\alpha-\beta \perp \beta_i\ (i=1,...,m)\\
\Rightarrow\  &\left<\alpha-\beta, \beta_i\right>=0\\
\Rightarrow\ &\left<\alpha, \beta_i\right>=\left<\beta, \beta_i\right>\\
\Rightarrow\ &\left<\beta_i, \beta\right>=\left<\beta_i, \alpha\right>\\
\Rightarrow\ &x_1\left<\beta_i, \beta_1\right>+···x_m\left<\beta_i, \beta_m\right>=\left<\beta_i, \alpha\right>\\
\Rightarrow &\begin{bmatrix}\left<\beta_1, \beta_1\right>&\cdots & \left<\beta_1, \beta_m\right> \\ &\ddots &\\ \left<\beta_m, \beta_1\right>& \cdots & \left<\beta_m, \beta_m\right>\end{bmatrix}\begin{bmatrix}x_1\\ \vdots \\ x_m\end{bmatrix}= \begin{bmatrix}\left<\beta_1, \alpha\right> \\ \vdots \\\left<\beta_m, \alpha\right> \end{bmatrix}\\
\Rightarrow\ &G(\beta_1,...,\beta_m)x=G(\beta_1,...,\beta_m;\alpha)
\end{aligned}
$$

因为 $\beta_1,...,\beta_m$ 线性无关，所以 $G (\beta_1,...,\beta_m)$ 可逆，则 $x=G^{-1}(\beta_1,...,\beta_m) G (\beta_1,...,\beta_m;\alpha)$

___

#### 最小二乘问题

$x_1,...,x_n$ 是 $n$ 个自变量，$y$ 是因变量，假设 $x_1,...,x_n$ 和 $y$ 满足线性关系

$$
y\approx a_1x_1+···+a_nx_n
$$

现有观测值

$$
\begin{array}{c|ccc}
x_{1} & x_{11} & \cdots & x_{s 1} \\
\vdots & \vdots & \cdots & \vdots \\
x_{n} & x_{1 n} & \cdots & x_{s n} \\
\hline y & y_{1} & \cdots & y_{s}
\end{array}
$$

求 $a_1,...,a_n$

**解：**令 $A=\begin {bmatrix} x_{11} &\cdots &x_{1n}\\ &\ddots \\x_{s1} &\cdots &x_{sn}\end {bmatrix}\triangleq \begin {bmatrix}\alpha_1,...,\alpha_m\end {bmatrix}$

$b=\begin {bmatrix} y_1\\ \vdots \\y_s\end {bmatrix}, x=\begin {bmatrix} a_1\\ \vdots \\a_s\end {bmatrix}$，则问题转为求 $Ax=b$

$W=\text {span}\{\alpha_1,...,\alpha_n\}$ 是一个子空间，$b\in \mathbb {R}^s$

当 $b \in W$ 时，$Ax=b$ 有解；当 $b \notin W$ 时，$Ax=b$ 无解，此时问题转为求 $x$，使 $Ax=y$ 为 $b$ 在 $W$ 中的投影（如下图所示），因为这样可以使得 $d (b, Ax)$ 最小

![](https://z3.ax1x.com/2021/04/29/gF5ySx.png#shadow)

$b-y\perp W=\text {span}\{\alpha_1,...,\alpha_n\}$，所以 $b-Ax\perp \alpha_i\ (i=1,...,n)$

则

$$
\begin{aligned}
\left< \alpha_i,b-Ax \right>=0\\
\Rightarrow \left< \alpha_i,b \right>=\left< \alpha_i,Ax \right>&=\left< \alpha_i,a_1\alpha_1+···+a_n\alpha_n \right>a_n\\
&=a_1\left< \alpha_i,\alpha_1 \right>+···+a_n\left< \alpha_i,\alpha_n \right>\ (i=1,...,n)\\
\Rightarrow &\begin{bmatrix}\left< \alpha_1,\alpha_1 \right>&\cdots&\left< \alpha_1,\alpha_n \right>\\ &\ddots&\\\left< \alpha_n,\alpha_1 \right>&\cdots &\left< \alpha_n,\alpha_n \right>\end{bmatrix}\begin{bmatrix}a_1\\ \vdots \\ a_n\end{bmatrix}=\begin{bmatrix}\left< \alpha_1,b \right>\\ \vdots \\ \left< \alpha_n,b \right>\end{bmatrix}\\
\Rightarrow &G(\alpha_1,...,\alpha_n)x=G(\alpha_1,...,\alpha_n;b)
\end{aligned}
$$

由于 $\{\alpha_1,...,\alpha_n\}$ 不一定可逆，因此不能直接推出 $x=G^{-1}(\alpha_1,...,\alpha_n) G (\alpha_1,...,\alpha_n;b)$

但是

$$
\begin{aligned}
&G(\alpha_1,...,\alpha_n)x=G(\alpha_1,...,\alpha_n;b)\\
\Rightarrow \ & A^HAx=A^Hb
\end{aligned}
$$

$$
\because \mathrm {rank}(A^HA\vdots A^Hb)=\mathrm {rank}(A^H (A\vdots b))≤\mathrm {rank}(A^H)=\mathrm {rank}(A^HA)\\
\therefore A^HAx=A^Hb\ 必有解
$$

我们暂时无法求出最优解，所以到此为止

___

#### （标准）正交组

$\alpha_1,...,\alpha_s$ 是内积空间 $V$ 中的向量组，如果

1.  $||\alpha_i||=1\ (i=1,...,s)$
2.  $\left< \alpha_i,\alpha_j \right>=0\ (i\neq j)$

则称 $\alpha_1,...,\alpha_s$ 为**标准正交向量组**，若只满足条件 2，则称 $\alpha_1,...,\alpha_s$ 为**正交向量组**

##### 标准正交向量组的性质

1.  $G(\alpha_1,...,\alpha_s)=I_s$
2.  $\alpha_1,...,\alpha_s$ 线性无关

___

#### （标准）正交基

正交向量组的基称为是**正交基**，标准正交向量组的基称为是**标准正交基**

##### 标准正交基下的运算

设 $\epsilon_1,\epsilon_2,...,\epsilon_n$ 是 $V$ 的标准正交基，$\alpha,\beta\in V$ 在 $\epsilon_1,\epsilon_2,...,\epsilon_n$ 下的坐标是 $X,Y$，则

$$
\left<\alpha,\beta\right>=X^TA\overline{Y}=X^T\overline{Y}
$$

因为 $X^T\overline {Y}=Y^HX$，所以 $\left<\alpha,\beta\right>=Y^HX=\left<X,Y\right>$

##### schmidit 正交化

前面讨论拥有了标准正交向量基之后，向量之间的运算表示会得到很大的简化。因此，若给定了任意一组基，我们希望它是标准正交的

设给定的一组基 $\alpha_1,\alpha_2,...,\alpha_s\in V$ 是线性无关的，将其正交化得到的基为 $\beta_1,\beta_2,...,\beta_s$，则有

$$
\begin{aligned}
\beta_1&=\alpha_1\\
\beta_2&=\alpha_2-\frac{\left<\alpha_2,\beta_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1\\
\beta_3&=\alpha_3-\frac{\left<\alpha_3,\beta_2\right>}{\left<\beta_2,\beta_2\right>}\beta_2-\frac{\left<\alpha_3,\beta_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1\\
\vdots\\
\beta_s&=\alpha_s-\frac{\left<\alpha_s,\beta_{s-1}\right>}{\left<\beta_{s-1},\beta_{s-1}\right>}\beta_{s-1}-···-\frac{\left<\alpha_s,\beta_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1
\end{aligned}
$$

##### 单位化

$$
\gamma_i=\frac{1}{||\beta_i||}\beta_i, \quad{i=1,2,...,s}
$$

___

#### 例 1

设 $V$ 在基 $\epsilon_1,\epsilon_2$ 下的度量矩阵是 $A=\begin {bmatrix} 1&2\\2&5\end {bmatrix}$，求 $V$ 的一组标准正交基

**解：**首先正交化，令

$$
\begin{aligned}
\beta_1&=\epsilon_1\\
\beta_2&=\epsilon_2-\frac{\left<\epsilon_2,\beta_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1
\end{aligned}
$$

因为矩阵 $A$ 的第 1 行第 1 列的值表示的含义是 $\left<\epsilon_1,\epsilon_1\right>=1$，所以

$$
\beta_2=\epsilon_2-\frac{\left<\epsilon_2,\epsilon_1\right>}{\left<\epsilon_1,\epsilon_1\right>}\epsilon_1=\epsilon_2-2\epsilon_1
$$

单位化，令

$$
\begin{aligned}
\gamma_1&=\frac{1}{||\beta_1||}\beta_1=\frac{1}{\sqrt{\left<\epsilon_1,\epsilon_1\right>}}\beta_1=\beta_1=\epsilon_1\\
\gamma_2&=\frac{1}{||\beta_2||}\beta_2=\frac{1}{\sqrt{\left<\beta_2,\beta_2\right>}}\beta_2
\end{aligned}
$$

因为 $\beta_2=\epsilon_2-2\epsilon_1$ 在基 $\epsilon_1,\epsilon_2$ 下的坐标是 $\begin {bmatrix}-2\\1\end {bmatrix}$，根据度量矩阵的定义有

$$
\left<\beta_2,\beta_2\right>=\begin{bmatrix}-2&1\end{bmatrix}\begin{bmatrix}1&2\\2&5\end{bmatrix}\begin{bmatrix}-2\\1\end{bmatrix}=1
$$

故 $V$ 的一组标准正交基是 $\epsilon_1,\epsilon_2-2\epsilon_1$

___

#### 例 2

已知 $A = \begin {bmatrix} 2&1&-1&1&-3\\1&1&-1&0&1\end {bmatrix}$，求 $\mathcal {N}(A)$ 的标准正交基

**解：**根据核空间的定义可知 $\mathcal {N}(A)$ 是方程组 $\begin {bmatrix} 2&1&-1&1&-3\\1&1&-1&0&1\end {bmatrix}\begin {bmatrix} x_1\\x_2\\x_3\\x_4\\x_5\end {bmatrix}=0$ 的解空间，解得它的基础解系为

$$
\alpha_1=[0,1,1,0,0]^T\\
\alpha_2 = [-1,1,0,1,0]^T\\
\alpha_3 = [4,-5,0,0,1]^T
$$

故 $\mathcal {N}(A)=\text {span}\{\alpha_1,\alpha_2,\alpha_3\}$

首先正交化得

$$
\begin{aligned}
\beta_1 &= \alpha_1 = [0,1,1,0,0]^T\\
\beta_2 &= \alpha_2 - \frac{(\alpha_2,\beta_1)}{(\beta_1,\beta_1)}\beta_1=\alpha_2-\frac{1}{2}\beta_1\\
&=[-1,\frac{1}{2},-\frac{1}{2},1,0]^T\\
\beta_3 &=\alpha_3 - \frac{(\alpha_3,\beta_1)}{(\beta_1,\beta_1)}\beta_1-\frac{(\alpha_3,\beta_2)}{(\beta_2,\beta_2)}\beta_2\\
&=\alpha_3-\frac{-5}{2}\beta_1+\frac{13}{5}\beta_2=[\frac{7}{5}, -\frac{6}{5},\frac{6}{5},\frac{13}{5},1]^T
\end{aligned}
$$

然后将 $\beta_1,\beta_2,\beta_3$ 单位化后得

$$
\begin{aligned}
\gamma_1&=\frac{\beta_1}{||\beta_1||}=[0,\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}},0,0]^T\\
\gamma_2 &= \frac{\beta_2}{||\beta_2||}=[-\frac{\sqrt{10}}{5},\frac{\sqrt{10}}{10},-\frac{\sqrt{10}}{10},\frac{\sqrt{10}}{5},0]^T\\
\gamma_3 &= [\frac{7}{\sqrt{315}},-\frac{6}{\sqrt{315}},\frac{6}{\sqrt{315}},\frac{13}{\sqrt{315}},\frac{5}{\sqrt{315}}]^T
\end{aligned}
$$

所以 $\gamma_1,\gamma_2,\gamma_3$ 即为 $\mathcal {N}(A)$ 的标准正交基

___

#### 例 3

在 $V=R_3 [x]$ 中定义内积：$\left<f (x),g (x)\right>=\int_{-1}^1f (x) g (x) dx$，求 $V$ 在基 $\alpha_1=1,\alpha_2=x,\alpha_3=x^2$ 下的一组标准正交基

**解：**首先正交化，令

$$
\begin{aligned}
\beta_1&=\alpha_1\\
\beta_2&=\alpha_2-\frac{\left<\alpha_2,\beta_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1\\
\beta_3&=\alpha_3-\frac{\left<\alpha_3,\beta_2\right>}{\left<\beta_2,\beta_2\right>}\beta_2-\frac{\left<\alpha_3,\beta_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1
\end{aligned}
$$

因为

$$
\begin{aligned}
\left<\alpha_2,\beta_1\right>&=\int_{-1}^1x·1dx=0\\
\left<\alpha_3,\beta_2\right>&=\int_{-1}^1x^2·xdx=0\\
\left<\alpha_3,\beta_1\right>&=\int_{-1}^1x^2·1dx=\frac{2}{3}\\
\left<\beta_1,\beta_1\right>&=\int_{-1}^11·1dx=2
\end{aligned}
$$

故

$$
\begin{aligned}
\beta_1&=\alpha_1=1\\
\beta_2&=\alpha_2=x\\
\beta_3&=x^2-\frac{1}{3}\\
\end{aligned}
$$

单位化，令

$$
\gamma_1=\frac{1}{||\beta_1||}\beta_1\\
\gamma_2=\frac{1}{||\beta_2||}\beta_2\\
\gamma_3=\frac{1}{||\beta_3||}\beta_3
$$



## 酉矩阵、正交矩阵

#### 酉矩阵

若 $n$ 阶复矩阵 $A$ 满足

$$
A^HA=AA^H=E
$$

则称 $A$ 是**酉矩阵**，记为 $A\in U^{n\times n}$

设 $A\in C^{n\times n}$，则 $A$ 是酉矩阵的充要条件是 $A$ 的 $n$ 个列（或行）向量是标准正交向量组

##### 酉矩阵的性质

1.  $A^{-1}=A^H\in U^{n \times n}$
2.  $\mid \det A\mid=1$
3.  $A^T\in U^{n\times n}$
4.  $AB, BA\in U^{n\times n}$，其中 $B\in U^{n\times n}$
5.  酉矩阵的特征值的模为 1
6.  标准正交基到标准正交基的过渡矩阵是酉矩阵

##### 酉变换

设 $V$ 是 $n$ 维酉空间，$\mathscr {A}$ 是 $V$ 的线性变换，若 $\forall \alpha, \beta \in V$ 都有

$$
(\mathscr{A}(\alpha), \mathscr{A}(\beta))=(\alpha,\beta)
$$

___

#### 正交矩阵

若 $n$ 阶实矩阵 $A$ 满足

$$
A^TA=A^HA=E
$$

则称 $A$ 是正交矩阵，记为 $A\in E^{n\times n}$

设 $A\in R^{n\times n}$，则 $A$ 是正交矩阵的充要条件是 $A$ 的 $n$ 个列（或行）向量是标准正交向量组

##### 正交矩阵的性质

1.  $A^{-1}=A^T\in E^{n\times n}$
2.  $\det A=±1$
3.  $AB,BA\in E^{n\times n}$

##### 正交变换

设 $V$ 是 $n$ 维欧氏空间，若线性变换 $\mathscr {B}$ 满足 $\forall \alpha,\beta\in V$ 都有

$$
(\mathscr{B}(\alpha), \mathscr{B}(\beta))=(\alpha, \beta)
$$

设 $\mathscr {A}$ 是酉空间（或欧式空间）$V$ 的线性变换，则下列命题等价：

1.  $\mathscr {A}$ 是酉变换（或正交变换）
2.  $||\mathscr {A}(\alpha)||=||\alpha||$，其中 $\forall \alpha \in V$
3.  $\sigma$ 将 $V$ 的标准正交基变到标准正交基
4.  酉变换（或正交变换）在标准正交基下的矩阵表示是酉矩阵（或正交矩阵）

___

#### 满秩矩阵的 QR 分解

若 $n$ 阶实矩阵 $A\in \mathbb {C}^{n\times n}$ 满秩，且

$$
A = [\alpha_1,...,\alpha_n]
$$

其中 $\alpha_1,...,\alpha_n$ 是 $\mathbb {C}^{n\times n}$ 中线性无关向量组

**正交化**

令

$$
\begin{aligned}
\beta_1&=\alpha_1\\
\beta_2&=\alpha_2 - \frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1\\
\vdots\\
\beta_n &= \alpha_n - \frac{\left<\beta_n,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1-\cdots-\frac{\left<\beta_{n-1},\alpha_n\right>}{\left<\beta_{n-1},\alpha_{n-1}\right>}\beta_{n-1}
\end{aligned}
$$

变形得

$$
\begin{aligned}
\alpha_1 &= \beta_1\\
\alpha_2 &= \frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1 + \beta_2\\
\vdots \\
\alpha_n &= \frac{\left<\beta_n,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}\beta_1-\cdots-\frac{\left<\beta_{n-1},\alpha_n\right>}{\left<\beta_{n-1},\alpha_{n-1}\right>}\beta_{n-1} + \beta_n 
\end{aligned}
$$

写成矩阵形式

$$
\begin{aligned}
\begin{bmatrix}\alpha_1,\alpha_2,...,\alpha_n\end{bmatrix} &= \begin{bmatrix}\beta_1,\beta_2,...,\beta_n\end{bmatrix}\begin{bmatrix}1&\frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}&\cdots &\frac{\left<\beta_1,\alpha_n\right>}{\left<\beta_1,\beta_1\right>}\\0&1&\cdots&\frac{\left<\beta_2,\alpha_n\right>}{\left<\beta_2,\beta_2\right>}\\ &&\ddots\\0&&\cdots& 1\end{bmatrix}\\
&\triangleq B\begin{bmatrix}1&\frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}&\cdots &\frac{\left<\beta_1,\alpha_n\right>}{\left<\beta_1,\beta_1\right>}\\0&1&\cdots&\frac{\left<\beta_2,\alpha_n\right>}{\left<\beta_2,\beta_2\right>}\\ &&\ddots\\0&&\cdots& 1\end{bmatrix}
\end{aligned}
$$

**单位化**

令

$$
q_1=\frac{\beta_1}{||\beta_1||}\\
\vdots \\
q_n = \frac{\beta_n}{||\beta_n||}
$$

变形得

$$
\beta_1 = q_1||\beta_1||\\
\vdots \\
\beta_n = q_n ||\beta_n||
$$

写成矩阵形式

$$
\begin{aligned}
\begin{bmatrix}\beta_1,\beta_2,...,\beta_n\end{bmatrix} &= \begin{bmatrix}q_1,q_2,...,q_n\end{bmatrix}\begin{bmatrix}||\beta_1||&0&\cdots &0\\0&||\beta_2||&\cdots&0\\ &&\ddots\\0&&\cdots& ||\beta_n||\end{bmatrix}\\
&\triangleq Q\begin{bmatrix}||\beta_1||&0&\cdots &0\\0&||\beta_2||&\cdots&0\\ &&\ddots\\0&&\cdots& ||\beta_n||\end{bmatrix}
\end{aligned}
$$

综上，结合正交化和单位化可得

$$
\begin{aligned}
A &= B\begin{bmatrix}1&\frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}&\cdots &\frac{\left<\beta_1,\alpha_n\right>}{\left<\beta_1,\beta_1\right>}\\0&1&\cdots&\frac{\left<\beta_2,\alpha_n\right>}{\left<\beta_2,\beta_2\right>}\\ &&\ddots\\0&&\cdots& 1\end{bmatrix}\\
&=Q\begin{bmatrix}||\beta_1||&0&\cdots &0\\0&||\beta_2||&\cdots&0\\ &&\ddots\\0&&\cdots& ||\beta_n||\end{bmatrix}\begin{bmatrix}1&\frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}&\cdots &\frac{\left<\beta_1,\alpha_n\right>}{\left<\beta_1,\beta_1\right>}\\0&1&\cdots&\frac{\left<\beta_2,\alpha_n\right>}{\left<\beta_2,\beta_2\right>}\\ &&\ddots\\0&&\cdots& 1\end{bmatrix}\\
&=Q\begin{bmatrix}||\beta_1||&\frac{\left<\beta_1,\alpha_1\right>}{\left<\beta_1,\beta_1\right>}&\cdots &\frac{\left<\beta_1,\alpha_n\right>}{\left<\beta_1,\beta_1\right>}\\0&||\beta_2||&\cdots&\frac{\left<\beta_2,\alpha_n\right>}{\left<\beta_2,\beta_2\right>}\\ &&\ddots\\0&&\cdots& ||\beta_n||\end{bmatrix}\\
&\triangleq QR
\end{aligned}
$$

**QR 分解定理：**$A\in \mathbb {C}^{n\times n}$，则存在酉矩阵 $Q$ 和正线上三角阵 $R$，使

$$
A=QR
$$

且分解唯一

#### QR 分解的求法

1.  取矩阵 $A=(A_1,A_2,...,A_n)$ 的列向量，进行 **Schmidt 标准正交化**，得 $v_1,v_2,...,v_n$，有 $Q=(v_1,v_2,...,v_n)$
2.  再由 $R=Q^HA$ 得到 $R$，于是 $A=QR$

# 正规矩阵、Hermite 矩阵

#### Schur 引理

**定义：**设 $A, B \in \mathbb {C}^{n \times n}\left (\right. 或  \left.\mathbb {R}^{n \times n}\right)$，若存在 $U \in U^{n \times n}\left (\right. 或  \left.E^{n \times n}\right)$，使得

$$
{U}^{\mathrm {H}} {A} {U}={U}^{-1} {A} {U}={B}\left (\text {或 } {U}^{\mathrm {T}} {A} {U}={U}^{-1} {A} {U}={B}\right)
$$

则说 $A$ 酉相似（或正交相似）于 $B$  
**（Schur 引理）**任何一个 $n$ 阶复矩阵 $A$ 酉相似于一个上（下）三角矩阵

___

#### 例 1

已知 $A = \begin {bmatrix} 0&3&3\\-1&8&6\\2&-14&-10\end {bmatrix}$，求酉矩阵 $U$，使得 $U^HAU$ 是一个上三角矩阵

**解：**$|\lambda E-A|=\lambda (\lambda+1)^2$，当 $\lambda=0$ 时，$A$ 有单位特征向量

$$
\eta_1 = (\frac{2}{\sqrt{6}},\frac{1}{\sqrt{6}},-\frac{1}{\sqrt{6}})^T
$$

解与 $\eta_1$ 内积为零的方程 $2x_1+x_2-x_3=0$，求得一个单位解向量

$$
\eta_2=[0,\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}]^T
$$

解与 $\eta_1,\eta_2$ 内积为零的方程

$$
\begin{cases}
2x_2+x_2-x_3=0\\
x_2+x_3=0
\end{cases}
$$

又求得其一个单位解向量

$$
\eta_3 = [-\frac{1}{\sqrt{3}}, \frac{1}{\sqrt{3}},-\frac{1}{\sqrt{3}}]^T
$$

于是取

$$
U_1=\begin{bmatrix}\frac{2}{\sqrt{6}}&0&-\frac{1}{\sqrt{3}}\\\frac{1}{\sqrt{6}}&\frac{1}{\sqrt{2}}&\frac{1}{\sqrt{3}}\\-\frac{1}{\sqrt{6}}&\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{3}}\end{bmatrix}
$$

经计算得

$$
U_1^HAU_1=\begin{bmatrix}0 & \frac{50}{\sqrt{12}} & \frac{9}{\sqrt{18}} \\
0 & -5 & -\frac{3}{\sqrt{6}} \\
0 & \frac{32}{\sqrt{6}} & 3\end{bmatrix}=\left[\begin{array}{ccc}
0 & \frac{50}{\sqrt{12}} & \frac{9}{\sqrt{18}} \\
0 & \\
& & A_{1} \\
0 & &
\end{array}\right]
$$

其中

$$
A_1=\begin{bmatrix}-5 & -\frac{3}{\sqrt{6}} \\
 \frac{32}{\sqrt{6}} & 3\end{bmatrix}
$$

可得 $|\lambda E - A_1|=(\lambda +1)^2$，对于 $\lambda =-1$ 时，求得一个单位特征向量 $\gamma_1=[-\frac {3}{\sqrt {105}}, \frac {4\sqrt {6}}{\sqrt {105}}]^T$

再求得一个与 $\gamma_1$ 正交的向量 $\gamma_2=[\frac {4\sqrt {6}}{\sqrt {105}}, \frac {3}{\sqrt {105}}]^T$，令

$$
V_1 = \begin{bmatrix}-\frac{3}{\sqrt{105}} &\frac{4\sqrt{6}}{\sqrt{105}}\\ \frac{4\sqrt{6}}{\sqrt{105}}&\frac{3}{\sqrt{105}}\end{bmatrix}
$$

经计算可得

$$
V_1^HA_1V_1=\begin{bmatrix}-1&-\frac{1225\sqrt{6}}{35\sqrt{6}}\\0&-1\end{bmatrix}
$$

令

$$
U_2=\begin{bmatrix}1&0&0\\0&-\frac{3}{\sqrt{105}} &\frac{4\sqrt{6}}{\sqrt{105}}\\ 0&\frac{4\sqrt{6}}{\sqrt{105}}&\frac{3}{\sqrt{105}}\end{bmatrix}
$$

记

$$
U = U_1U_2=\begin{bmatrix}
\frac{2}{\sqrt{6}} & -\frac{4 \sqrt{2}}{\sqrt{105}} & \frac{1}{\sqrt{35}} \\
\frac{1}{\sqrt{6}} & \frac{5}{\sqrt{210}} & \frac{5}{\sqrt{35}} \\
-\frac{1}{\sqrt{6}} & -\frac{11}{\sqrt{210}} & \frac{3}{\sqrt{35}}
\end{bmatrix}
$$

则 $U^HAU=\begin {bmatrix} 0 & \frac {50}{\sqrt {12}} & \frac {9}{\sqrt {18}} \\0 & -1 & \frac {1225}{35 \sqrt {6}} \\0 & 0 & -1\end {bmatrix}$

___

#### 正规矩阵

**定理：**$\exists U\in U^{n\times n}$，使得 $U^{-1} AU$ 为对角矩阵的充分必要条件为 $A^HA=AA^H$

**定义：**如果矩阵 $A$ 满足 $A^HA=AA^H$，则称其为正规矩阵

___

#### Hermite 矩阵

**定义：**$A\in \mathbb {C}^{n\times n}$，若 $A^H=A$，则称 $A$ 为 Hermite 矩阵

**定理：**Hermite 矩阵是正规矩阵，Hermite 矩阵的特征值是实数

___

#### Rayleigh 商

**定理：**设 $A\in \mathbb {C}^{n\times n}$ 是 Hermite 矩阵，则 $\forall x\in \mathbb {C}^n$，$x^HAx$ 为实数

**定义：**$A\in \mathbb {C}^{n\times n}$ 是 Hermite 矩阵，$\forall x\in \mathbb {C}^n$，$x \neq 0$，则

$$
R(x)=\frac{x^HAx}{x^Hx}
$$

为实数，称 $R (x)$ 为矩阵 $A$ 的 Rayleigh 商

**定理：**由于 Hermite 矩阵的特征值全部为实数，不妨排列成

$$
\lambda_1 ≥ \lambda_2 ≥ ···≥ \lambda_n
$$

则

1.  $\lambda_n ≤ R(x) ≤ \lambda_1$
2.  $\lambda_1 = \mathop{\max}\limits_{x\neq 0} R(x), \lambda_n = \mathop{\min}\limits_{x\neq 0} R(x)$

> 注：本节内容实际上都是一些定义或定理，看上去并不多，然而实际上如果仔细证明每一条定理，会有相当多的内容，不过这里我觉得没有必要写上证明，读者有需要自行谷歌搜索或者翻书即可

___

#### 例 2

已知 $A=\begin {bmatrix} 3&0&8\\3&-1&6\\-2&0&-5\end {bmatrix}$，试求酉矩阵 $U$，使得 $U^HAU$ 是一个上三角矩阵

**解：**首先求出其特征多项式 $|\lambda E-A|=(\lambda +1)^3$，当 $\lambda=-1$ 时，求出属于特征值 - 1 的一个单位特征向量为

$$
\eta_1 = [-\frac{2}{\sqrt{6}},\frac{1}{\sqrt{6}},\frac{1}{\sqrt{6}}]
$$

解与 $\eta_1$ 内积为零的方程 $-2x_1+x_2+x_3=0$，求得一个单位解向量

$$
\eta_2=[\frac{\sqrt{3}}{3},\frac{\sqrt{3}}{3},\frac{\sqrt{3}}{3}]^T
$$

解与 $\eta_1,\eta_2$ 内积为零的方程

$$
\begin{cases}
-2x_2+x_2+x_3=0\\
x_1+x_2+x_3=0
\end{cases}
$$

又求得其一个单位解向量

$$
\eta_3 = [0, -\frac{\sqrt{2}}{2},\frac{\sqrt{2}}{2}]^T
$$

于是取

$$
U_1=\begin{bmatrix}-\frac{2}{\sqrt{6}}&\frac{\sqrt{3}}{3}&0\\\frac{1}{\sqrt{6}}&\frac{\sqrt{3}}{3}&-\frac{\sqrt{2}}{2}\\\frac{1}{\sqrt{6}}&\frac{\sqrt{3}}{3}&\frac{\sqrt{2}}{2}\end{bmatrix}
$$

经计算得

$$
U_1^HAU_1=\begin{bmatrix}-1 & -\frac{7 \sqrt{2}}{2} & -\frac{7 \sqrt{3}}{3} \\
0 & 4 & \frac{5 \sqrt{6}}{3} \\
0 & -\frac{5 \sqrt{6}}{2} & -6\end{bmatrix}
$$

记

$$
A_1=\begin{bmatrix}4 & \frac{5 \sqrt{6}}{3} \\
 -\frac{5 \sqrt{6}}{2} & -6\end{bmatrix}
$$

可得 $|\lambda E - A_1|=(\lambda +1)^2$，对于 $\lambda =-1$ 时，求得一个单位特征向量 $\gamma_1=[-\frac {\sqrt {10}}{5}, \frac {\sqrt {15}}{5}]^T$

再求得一个与 $\gamma_1$ 正交的向量 $\gamma_2=[\frac {\sqrt {15}}{5}, \frac {\sqrt {10}}{5}]^T$，令

$$
V_1 = \begin{bmatrix}-\frac{\sqrt{10}}{5} &\frac{\sqrt{15}}{5}\\ \frac{\sqrt{15}}{5}&\frac{\sqrt{10}}{5}\end{bmatrix}
$$

经计算可得

$$
V_1^HA_1V_1=\begin{bmatrix}-1&-\frac{25\sqrt{6}}{6}\\0&-1\end{bmatrix}
$$

令

$$
U_2=\begin{bmatrix}1&0&0\\0&-\frac{\sqrt{10}}{5} &\frac{\sqrt{15}}{5}\\0&\frac{\sqrt{15}}{5}&\frac{\sqrt{10}}{5}\end{bmatrix}
$$

记

$$
U = U_1U_2=\begin{bmatrix}-\frac{2}{\sqrt{6}} & -\frac{\sqrt{30}}{15} & \frac{\sqrt{5}}{5} \\
\frac{1}{\sqrt{6}} & -\frac{\sqrt{30}}{6} & 0 \\
\frac{1}{\sqrt{6}} & \frac{\sqrt{30}}{30} & \frac{2 \sqrt{5}}{5}\end{bmatrix}
$$

则 $U^HAU=\begin {bmatrix}-1 & \frac {\sqrt {30}}{15} & -\frac {7 \sqrt {15}}{20} \\ 0 & -1 & -\frac {25 \sqrt {6}}{6} \\ 0 & 0 & -1\end {bmatrix}$

___

#### 例 3

验证矩阵 $A=\begin {bmatrix}\frac {1}{3}&-\frac {1}{3\sqrt {2}}&-\frac {1}{\sqrt {6}}\\-\frac {1}{3\sqrt {2}}&\frac {1}{6}&-\frac {1}{2\sqrt {3}}\\-\frac {1}{\sqrt {6}}&-\frac {1}{2\sqrt {3}}&\frac {1}{2}\end {bmatrix}$ 是正规矩阵，并求酉矩阵 $U$，使得 $U^HAU$ 为对角矩阵

**解：**$A^H=\begin {bmatrix}\frac {1}{3}&-\frac {1}{3\sqrt {2}}&-\frac {1}{\sqrt {6}}\\-\frac {1}{3\sqrt {2}}&\frac {1}{6}&-\frac {1}{2\sqrt {3}}\\-\frac {1}{\sqrt {6}}&-\frac {1}{2\sqrt {3}}&\frac {1}{2}\end {bmatrix}$，因为 $AA^H=A^HA$，所以 $A$ 是正规矩阵。求得其特征值为

$$
\lambda_1=\lambda_2=0,\lambda_3=1
$$

对于特征值 $\lambda_1=\lambda_2=0$，求得两个线性无关的特征向量

$$
X_1= [\frac{\sqrt{2}}{2}, 1, 0]^T, X_2=[\frac{\sqrt{6}}{2}\mathrm{i}, 0, 1]^T
$$

对于特征值 $\lambda_3=1$，求得一个线性无关的特征向量 $X_3 = [-\frac {\sqrt {6}}{3}\mathrm {i}, \frac {\sqrt {3}}{3}\mathrm {i}, 1]^T$，将 $X_1,X_2$ 正交化与单位化得

$$
\alpha_1 = [\frac{\sqrt{3}}{3}, \frac{\sqrt{6}}{3}, 0]^T\\
\alpha_2 = [\frac{\sqrt{3}}{3}\mathrm{i}, -\frac{\sqrt{6}}{6}\mathrm{i}, \frac{\sqrt{2}}{2}]^T
$$

将 $X_3$ 单位化得 $\alpha_3 = [-\frac {\sqrt {3}}{3} i, \frac {\sqrt {6}}{6} i, \frac {\sqrt {2}}{2}]^T$，于是取

$$
U = \begin{bmatrix}\frac{\sqrt{3}}{3} & \frac{\sqrt{3}}{3} \mathrm{i} & -\frac{\sqrt{3}}{3} \mathrm{i} \\
\frac{\sqrt{6}}{3} & -\frac{\sqrt{6}}{6} \mathrm{i} & \frac{\sqrt{6}}{6} \mathrm{i} \\
0 & \frac{\sqrt{2}}{2} & \frac{\sqrt{2}}{2}\end{bmatrix}
$$

而且有

$$
U^HAU = \begin{bmatrix}0&0&0\\0&0&0\\0&0&1\end{bmatrix}
$$

___

#### 例 4

已知 $A=\begin {bmatrix} 2&-2&0\\-2&1&-2\\0&-2&0\end {bmatrix}$，求正交矩阵 $Q$，使 $Q^TAQ$ 为对角矩阵

**解：**计算 $A$ 的特征值与（单位化）特征向量得

$$
\lambda_1 = -2, \alpha_1 = [\frac{1}{3}, \frac{2}{3}, \frac{2}{3}]^T\\
\lambda_2 = 4, \alpha_2 = [\frac{2}{3}, -\frac{2}{3}, \frac{1}{3}]^T\\
\lambda_3 = 1, \alpha_3 = [\frac{2}{3}, \frac{1}{3}, -\frac{2}{3}]^T
$$

于是取

$$
Q = \begin{bmatrix}\frac{1}{3} & \frac{2}{3} & \frac{2}{3} \\
\frac{2}{3} & -\frac{2}{3} & \frac{1}{3} \\
\frac{2}{3} & \frac{1}{3} & -\frac{2}{3}\end{bmatrix}
$$

那么有

$$
Q^TAQ = \begin{bmatrix}-2&0&0\\0&4&0\\0&0&1\end{bmatrix}
$$


## 矩阵分解

#### 矩阵的满秩分解

设 $A\in \mathbb {C}_r^{m\times n}$，则存在 $B\in \mathbb {C}_r^{m\times r}, C\in \mathbb {C}_r^{r\times n}$，满足

$$
A = BC
$$

> $\mathbb {C}_r$ 表示矩阵的秩为 $r$

实际上上述定理用文字描述就是，一个亏秩的矩阵可以分解成一个列满秩与行满秩矩阵的乘积

**证明：**因为 $\mathrm {rank}(A)=r$，所以一定可以找到与 $A$ 相似的一个矩阵

$$
A \simeq \begin{bmatrix}E_r&0_{r\times (n-r)}\\0_{(m-r)\times r}&0_{(m-r)\times (n-r)}\end{bmatrix}=\begin{bmatrix}E_r\\0_{(m-r)\times r}\end{bmatrix}\begin{bmatrix}E_r&0_{r\times (n-r)}\end{bmatrix}
$$

因此存在两个可逆矩阵 $P,Q$，使 $PAQ=\begin {bmatrix} E_r&0\\0&0\end {bmatrix}$，则

$$
\begin{aligned}
A &= P^{-1}\begin{bmatrix}E_r\\0\end{bmatrix}\begin{bmatrix}E_r&0\end{bmatrix}Q^{-1}\\
&\triangleq BC
\end{aligned}
$$

因为 $P^{-1}$ 是可逆矩阵，$\begin {bmatrix} E_r\\0\end {bmatrix}$ 是一个列满秩矩阵，所以 $B=P^{-1}\begin {bmatrix} E_r\\0\end {bmatrix}$ 仍是一个列满秩矩阵；同理，$C=\begin {bmatrix} E_r&0\end {bmatrix} Q^{-1}$ 是一个行满秩矩阵

#### 矩阵满秩分解的计算

如何在给定矩阵 $A$ 的情况下，求出矩阵 $B,C$ 呢？

设

$$
A = [\alpha_1,\alpha_2,...,\alpha_n]\\
B = [\beta_1,\beta_2,...,\beta_r], 其中 \beta_1,...,\beta_r 线性无关
$$

所以

$$
\begin{aligned}
&A=BC\\
&\Rightarrow[\alpha_1,\alpha_2,...,\alpha_n]=[\beta_1,...,\beta_r]\begin{bmatrix}c_{11}&\cdots &c_{1n}\\\vdots &\ddots&\vdots\\c_{r1}&\cdots &c_{rn}\end{bmatrix}
\end{aligned}
$$

实际上我们可以取 $\beta_1,...,\beta_r$ 为 $\alpha_1,...,\alpha_n$ 的一个极大线性无关组，因此 $B$ 就是矩阵 $A$ 列向量组的一个极大线性无关组，$C$ 就是用该线性无关组去表示 $A$ 时的系数

___

#### 例 1

求矩阵 $A=\begin {bmatrix} 1&4&-1&5&6\\2&0&0&0&-14\\-1&2&-4&0&1\\2&6&-5&5&-7\end {bmatrix}$ 的满秩分解

**解：**对矩阵 $A$ 只作初等行变换

$$
A=\begin{bmatrix}1&4&-1&5&6\\2&0&0&0&-14\\-1&2&-4&0&1\\2&6&-5&5&-7\end{bmatrix}\to ···\to\begin{bmatrix}1&0&0&0&-7\\0&1&0&\frac{10}{7}&\frac{29}{7}\\0&0&1&\frac{5}{7}&\frac{25}{7}\\0&0&0&0&0\end{bmatrix}
$$

$A$ 的秩为 3，且前三个列向量线性无关，故

$$
B = \begin{bmatrix}1&4&-1\\2&0&0\\-1&2&-4\\2&6&-5\end{bmatrix}，C=\begin{bmatrix}1&0&0&0&-7\\0&1&0&\frac{10}{7}&\frac{29}{7}\\0&0&1&\frac{5}{7}&\frac{25}{7}\end{bmatrix}
$$

___

#### 例 2

求矩阵 $A=\begin {bmatrix} 2&1&-2&3&1\\2&5&-1&4&1\\1&3&-1&2&1\end {bmatrix}$ 的满秩分解

**解：**对矩阵 $A$ 只作初等行变换

$$
A=\begin{bmatrix}2&1&-2&3&1\\2&5&-1&4&1\\1&3&-1&2&1\end{bmatrix}\to ···\to \begin{bmatrix}1&0&0&\frac{8}{5}&-\frac{2}{5}\\0&1&0&\frac{1}{5}&\frac{1}{5}\\0&0&1&\frac{1}{5}&-\frac{4}{5}\end{bmatrix}
$$

$A$ 的秩为 3，且前三个列向量线性无关，故

$$
B = \begin{bmatrix}2&1&-2\\2&5&-1\\1&3&-1\end{bmatrix},C = \begin{bmatrix}1&0&0&\frac{8}{5}&-\frac{2}{5}\\0&1&0&\frac{1}{5}&\frac{1}{5}\\0&0&1&\frac{1}{5}&-\frac{4}{5}\end{bmatrix}
$$

___

#### QR 分解的应用

QR 分解的内容请看[矩阵分析（十一）](https://wmathor.com/index.php/archives/1515/)

请用 $QR$ 分解的方法解方程组 $Ax=b$，实际上 $A$ 可逆的情况下，$x=A^{-1} b$，但是由于直接求 $A^{-1}$ 过于复杂或者当 $A$ 不可逆时，我们可以利用 QR 分解，将其转换为求 $QRx=b$，于是就是求

$$
\begin{cases}
Qy=b\\
Rx=y
\end{cases}
$$

因为 $Q$ 是酉矩阵，所以 $Q^{-1}=Q^H$，因此 $y=Q^Hb$

由于 $R$ 是正线上三角矩阵，不妨设 $R = \begin {bmatrix} r_{11}&\cdots \\&r_{22}&\cdots \\&&\ddots\\&&&r_{nn}\end {bmatrix}$，则有

$$
\begin{bmatrix}r_{11}&\cdots \\&r_{22}&\cdots \\&&\ddots\\&&&r_{nn}\end{bmatrix}\begin{bmatrix}x_1\\\vdots \\x_n\end{bmatrix}=\begin{bmatrix}y_1\\\vdots \\y_n\end{bmatrix}\\
\Rightarrow \begin{cases}x_n=\frac{y_n}{r_{nn}}\\x_{n-1}=\frac{y_{n-1}-r_{nn}x_n}{r_{n-1,n-1}}\\\vdots\end{cases}
$$

___

#### 例 3

用 $QR$ 分解的方法解方程组 $Ax=b$，其中 $A=\begin {bmatrix}-3&1&2\\1&1&1\\1&-1&0\\1&-1&1\end {bmatrix},b=\begin {bmatrix} 1\\0\\-2\\1\end {bmatrix}$

**解：**将 $A=(\alpha_1,\alpha_2,\alpha_3)$ 的列向量 $\alpha_1,\alpha_2,\alpha_3$ 用 Schmidt 方法标准正交化得

$$
\begin{aligned}
v_1 &= (-\frac{3}{\sqrt{12}},\frac{1}{\sqrt{12}},\frac{1}{\sqrt{12}},\frac{1}{\sqrt{12}})^T\\
v_2&=(0,\frac{2}{\sqrt{6}},-\frac{1}{\sqrt{6}},-\frac{1}{\sqrt{6}})^T\\
v_3&=(0,0,-\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}})^T
\end{aligned}
$$

令 $Q=(v_1,v_2,v_3)$，则

$$
\begin{aligned}
&R=Q^HA=\begin{bmatrix}2\sqrt{3}&-\frac{2}{3}&\frac{4}{\sqrt{3}}\\0&\frac{4}{\sqrt{6}}&\frac{1}{\sqrt{6}}\\0&0&\frac{1}{\sqrt{2}}\end{bmatrix}\\
&R^{-1}=\begin{bmatrix}\frac{\sqrt{3}}{6} & \frac{\sqrt{6}}{12} & -\frac{3 \sqrt{2}}{4} \\
0 & \frac{\sqrt{6}}{4} & -\frac{\sqrt{2}}{4} \\
0 & 0 & \sqrt{2}\end{bmatrix}
\end{aligned}
$$

所以

$$
x = R^{-1}Q^Hb=\begin{bmatrix}-\frac{1}{4} & \frac{1}{4} & \frac{3}{4} & -\frac{3}{4} \\
0 & \frac{1}{2} & 0 & -\frac{1}{2} \\
0 & 0 & -1 & 1\end{bmatrix}\begin{bmatrix}
1 \\
0 \\
-2 \\
1
\end{bmatrix}=\begin{bmatrix}
-\frac{5}{2} \\
-\frac{1}{2} \\
3
\end{bmatrix}
$$

___

#### 矩阵的 LU 分解

LU 分解（LU Decomposition）是矩阵分解的一种，可以将一个矩阵分解为一个单位下三角矩阵和一个上三角矩阵的乘积，以四阶矩阵为例

$$
L = \begin{bmatrix}1&0&0&0\\*&1&0&0\\*&*&1&0\\*&*&*&1\end{bmatrix}, U=\begin{bmatrix}*&*&*&*\\0&*&*&*\\0&0&*&*\\0&0&0&*\end{bmatrix}
$$

LU 矩阵是否一定存在？答案是否，具体看下面的例子

设 $\begin {bmatrix} 0&1\\1&0\end {bmatrix}=\begin {bmatrix} a&0\\b&c\end {bmatrix}\begin {bmatrix} l&m\\0&n\end {bmatrix}$，则应该满足如下 4 个式子

$$
\begin{cases}
al=0\\
am=1\\
bl=1\\
bm+cn=0
\end{cases}
$$

由 $al=0$ 得 $a=0$ 或 $l=0$，但实际上这两种情况带入上面的式子都会推出矛盾，因此不是所有情况 LU 分解都存在

**LU 分解定理：**设 $A\in \mathbb {C}_n^{n\times n}$，$A$ 有唯一的 LU 分解 $\Leftrightarrow A$ 的各阶顺序主子式 $\Delta k \neq 0,\ k=1,2...,n$

> $k$ 阶顺序主子式指的是矩阵左上角 $k\times k$ 个元素组成的行列式

将矩阵 $A$ 分解为 $L$ 和 $U$ 之后，解方程组 $Ax=b$ 就变得简单了，因为 $A=LU$，所以 $(LU) x=b\Rightarrow L (Ux)=b\Rightarrow \begin {cases} Ly=b\\Ux=y\end {cases}$

所以 $x=U^{-1} y=U^{-1} L^{-1} b$

#### LU 矩阵的求法

实际上 LU 矩阵有非常多的求法，这里我举一种比较简单的待定系数法

设 $A = \begin {bmatrix} 2&3&4\\1&1&9\\1&2&-6\end {bmatrix}$，求矩阵 $A$ 的 LU 分解矩阵 $L$ 和 $U$

**解：**令

$$
L=\begin{bmatrix}1&0&0\\l_1&1&0\\l_2&l_3&1\end{bmatrix},U = \begin{bmatrix}u_1&u_2&u_3\\0&u_4&u_5\\0&0&u_6\end{bmatrix}
$$

由于 $A=LU$，所以有

$$
\begin{cases}
u_1=2\\
u_2=3\\
u_3=4\\
l_1u_1=1\\
l_1u_2+u_4=1\\
l_1u_3+u_5=9\\
l_2u_1=1\\
l_2u_2+l_3u_4=2\\
l_2u_3+l_3u_5+u_6=-6
\end{cases}
$$

上面的方程组非常容易解，最后求出

$$
L = \begin{bmatrix}1&0&0\\\frac{1}{2}&1&0\\\frac{1}{2}&-1&1\end{bmatrix},U=\begin{bmatrix}2&3&4\\0&-\frac{1}{2}&7\\0&0&-1\end{bmatrix}
$$

___

#### 矩阵的 SVD 分解

**SVD 分解定理：**设 $A\in \mathbb {C}_r^{m\times n}$，则

1.  对 $\mathrm {rank}(A)=r$ 的矩阵 $A$，矩阵 $A^HA$ 的**非零特征值**有 $\lambda_1 \geqslant \lambda_2 \geqslant・・・\geqslant \lambda_r >0$，则称**正数** $\sigma_i = \sqrt {\lambda_i}$ 为矩阵 $A$ 的奇异值
2.  存在酉矩阵 $U,V$ 使 $U^{-1} AV = \Sigma = \left [ \begin {array}{c c c|c} \sigma_1\\ &\ddots \\&& \sigma_n& 0 \\ \hline  0&&& 0 \end {array} \right]_{m\times n}$，其中 $\sigma_1≥\sigma_2≥・・・≥\sigma_r>0$

#### SVD 分解的求法

1.  由特征多项式 $|\lambda E - A^HA| = 0$ 求得特征值 $\lambda_1 \geqslant \lambda_2 \geqslant .. \geqslant \lambda_n$（**务必按照从大到小排列**），以及每个特征值对应的特征向量 $(\alpha_1, \alpha_2, ..., \alpha_n)$

-   对特征向量进行施密特正交化和单位化，得到单位正交向量组 $V = (v_1, v_2, ..,v_n)$
-   对于非零特征值 $\lambda_1, ..., \lambda_r$ 对应奇异值 $\sigma_1, ... , \sigma_r$，于是有 **${\color{red} {u_i = \frac{1}{\sigma_i}Av_i}}$**，这样得到了 $r$ 个列向量，剩余的 $u_{r+1},...,u_{n}$ 通过方程 $u_i^T x = 0$ 求得（$u_i$ 必须是标准正交的）
-   于是得到 $A=U \Sigma V^H$

> 实际上 $A^HA$ 是一个**半正定矩阵**，其特征值一定**非负**

___

#### 例 4

已知 $A = \begin {bmatrix} 1&2\\0&0\\0&0\end {bmatrix}$，求 $A$ 的奇异值

**解：**因为 $A^HA=\begin {bmatrix} 5&0&0\\0&0&0\\0&0&0\end {bmatrix}$，$A^HA$ 的特征值为 $5,0,0$，故 $A$ 的奇异值为 $\sqrt {5}$

___

#### 例 5

已知 $A = \begin {bmatrix} 1&1\\0&0\\1&1\end {bmatrix}$，求 $A$ 的 SVD 分解矩阵 $U$ 和 $V$

**解：**$A^HA = \begin {bmatrix} 2&2\\2&2\end {bmatrix}$，求得 $A^HA$ 的特征值为 $\lambda_1=4,\lambda_2=0$，且对应的特征向量分别为 $\alpha_1=\begin {bmatrix} 1,1\end {bmatrix}^T,\alpha_2=[-1,1]^T$，将其单位正交化后得

$$
\begin{aligned}
v_1&=\begin{bmatrix}\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}\end{bmatrix}^T\\
v_2&=\begin{bmatrix}-\frac{1}{\sqrt{2}},\frac{1}{\sqrt{2}}\end{bmatrix}^T
\end{aligned}
$$

于是有

$$
V = \begin{bmatrix}\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}}&\frac{1}{\sqrt{2}}\end{bmatrix}
$$

因为 $u_1=\frac {1}{2} Av_1=\begin {bmatrix}\frac {1}{\sqrt {2}}\\0\\\frac {1}{\sqrt {2}}\end {bmatrix}$，解方程组 $u_1^Tx=0$ 得

$$
\begin{aligned}
x_1 &= u_2 = \begin{bmatrix}\frac{1}{\sqrt{2}}\\0\\-\frac{1}{\sqrt{2}}\end{bmatrix}\\
x_2 &= u_3 = \begin{bmatrix}0\\1\\0\end{bmatrix}
\end{aligned}
$$

故

$$
U = \begin{bmatrix}\frac{1}{\sqrt{2}}&\frac{1}{\sqrt{2}}&0\\0&0&1\\\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{2}}&0\end{bmatrix}
$$

验算可得 $U^{-1} AV=\Sigma$

___

#### 例 6

求 $A=\begin {bmatrix} 1&1&1\\1&1&1\end {bmatrix}$ 的奇异值分解

**解：**$A^HA = \begin {bmatrix} 2&2&2\\2&2&2\\2&2&2\end {bmatrix}$，求得 $A^HA$ 的特征值为 $\lambda_1=6,\lambda_2=\lambda_3=0$，且对应的特征向量分别为 $\alpha_1=\begin {bmatrix} 1,1,1\end {bmatrix}^T,\alpha_2=[1, 0,-1]^T,\alpha_3 = [0,1,-1]^T$，将其单位正交化后得

$$
\begin{aligned}
v_1&=\begin{bmatrix}\frac{1}{\sqrt{3}},\frac{1}{\sqrt{3}}, \frac{1}{\sqrt{3}}\end{bmatrix}^T\\
v_2&=\begin{bmatrix}\frac{1}{\sqrt{2}},0,-\frac{1}{\sqrt{2}}\end{bmatrix}^T\\
v_3&=\begin{bmatrix}-\frac{1}{\sqrt{6}}, \frac{\sqrt{6}}{3},-\frac{1}{\sqrt{6}}\end{bmatrix}^T
\end{aligned}
$$

于是有

$$
V = \begin{bmatrix}\frac{1}{\sqrt{3}}&\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{6}}\\\frac{1}{\sqrt{3}}&0&\frac{\sqrt{6}}{3}\\\frac{1}{\sqrt{3}}&-\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{6}}\end{bmatrix}
$$

因为 $u_1=\frac {1}{\sqrt {6}} Av_1=\begin {bmatrix}\frac {1}{\sqrt {2}}\\\frac {1}{\sqrt {2}}\end {bmatrix}$，解方程组 $u_1^Tx=0$ 得

$$
\begin{aligned}
x_1 &= u_2 = \begin{bmatrix}\frac{1}{\sqrt{2}}\\-\frac{1}{\sqrt{2}}\end{bmatrix}\\
\end{aligned}
$$

故

$$
U = \begin{bmatrix}\frac{1}{\sqrt{2}}&\frac{1}{\sqrt{2}}\\\frac{1}{\sqrt{2}}&-\frac{1}{\sqrt{2}}\end{bmatrix}
$$

验算可得 $U^{-1} AV=\Sigma$

## 矩阵的广义逆

#### 矩阵的广义逆

若 $A\in \mathbb {C}^{n\times n}$，且 $A$ 为可逆矩阵，则有

1.  $AA^{-1}A=A$
2.  $A^{-1}AA^{-1}=A^{-1}$
3.  $(AA^{-1})^H=AA^{-1}$
4.  $(A^{-1}A)^H=A^{-1}A$

若 $A\in \mathbb {C}^{m\times n}, X\in \mathbb {C}^{m\times m}$，以下矩阵方程称为 Penrose 方程

1.  $AXA=A$
2.  $XAX=X$
3.  $(AX)^H=AX$
4.  $(XA)^H=XA$

满足 Penrose 方程中一个或多个的 $X\in \mathbb {C}^{n\times m}$ 称为 $A$ 的**一种**广义逆矩阵。最广泛的广义逆矩阵有以下两个

-   仅满足条件 $1$ 的广义逆矩阵称为减号逆，记为 $A^{-}$
-   满足条件 $1,2,3,4$ 的广义逆矩阵称为加号逆，记为 $A^+$

___

#### 矩阵的减号逆

**（减号逆存在性定理）**$A\in \mathbb {C}^{m\times n}$，矩阵方程 $AXA=A$ 恒有解，并且称 $X$ 是 $A$ 的一个减号逆

**证明：**设 $\mathrm {rank}(A)=r≤\min (m,n)$，存在可逆矩阵 $P,Q$ 使得

$$
A = P\begin{bmatrix}E_r&0\\0&0\end{bmatrix}Q
$$

取 $X = Q^{-1}\begin {bmatrix} E_r&B_{r\times (n-r)}\\C_{(m-r)\times r}&D_{(m-r)\times (n-r)}\end {bmatrix} P^{-1}$，$B,C,D$ 为**任意**的满足分块要求的矩阵，则

$$
\begin{aligned}
AX A &= P\begin{bmatrix}E_r&0\\0&0\end{bmatrix}QQ^{-1}\begin{bmatrix}E_r&B\\C&D\end{bmatrix}P^{-1}P\begin{bmatrix}E_r&0\\0&0\end{bmatrix}Q\\
&=P\begin{bmatrix}E_r&0\\0&0\end{bmatrix}Q\\
&=A
\end{aligned}
$$

很明显，减号逆是不唯一的

#### $A^{-}$ 的求法

对 $\mathrm {rank}(A)=r$ 的矩阵 $A$，做增广矩阵 $\begin {bmatrix} A & E_m\\ E_n & 0 \end {bmatrix}$ 进行初等变换将 $A$ 化为最简形，得到 $\left [\begin {array}{rr|rr} E_r& 0  & P  \\ 0 & 0 & \\ \hline \\ Q &  & 0 &\end {array}\right]$，则有 $X = Q\begin {bmatrix} E_r&B\\C&D\end {bmatrix} P$，其中 $B,C,D$ 是满足固定阶次的任意矩阵

___

#### 例 1

求矩阵 $A= \begin {bmatrix} 0&-1&3&0\\2&-4&1&5\\-4&5&7&-10\end {bmatrix}$ 的减号逆

**解：**

$$
\begin{aligned}
\left[\begin{array}{c|c}
A & E_{m} \\ \hline
E_{n} & 0
\end{array}\right]&=\left[\begin{array}{rrrr|rrr}
0 & -1 & 3 & 0 & 1 & 0 & 0 \\ 
2 & -4 & 1 & 5 & 0 & 1 & 0 \\
-4 & 5 & 7 & -10 & 0 & 0 & 1 \\ \hline
1 & 0 & 0 & 0 & & \\
0 & 1 & 0 & 0 & & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1 & &
\end{array}\right]\\
&\to \left[\begin{array}{cccc|ccc}
1 & 0 & 0 & 0 & -2 & \frac{1}{2} & 0 \\
0 & 1 & 0 & 0 & -1 & 0 & 0 \\
0 & 0 & 0 & 0 & -3 & 2 & 1 \\ \hline
1 & 0 & \frac{11}{2} & -\frac{5}{2} & & \\
0 & 1 & 3 & 0 & 0 & \\
0 & 0 & 1 & 0 & & \\
0 & 0 & 0 & 1 & &
\end{array}\right]
\end{aligned}
$$

于是

$$
{P}=\left[\begin{array}{ccc}
-2 & \frac{1}{2} & 0 \\
-1 & 0 & 0 \\
-3 & 2 & 1
\end{array}\right], \quad {Q}=\begin{bmatrix}
1 & 0 & \frac{11}{2} & -\frac{5}{2} \\
0 & 1 & 3 & 0 \\
0 & 0 & 1 & 0 \\
0 & 0 & 0 & 1
\end{bmatrix}
$$

所以

$$
A^-=Q\begin{bmatrix}E_2&B\\C&D\end{bmatrix}P
$$

其中 $B\in \mathbb {C}^{2\times 1}, C\in \mathbb {C}^{2\times 2},D\in \mathbb {C}^{2\times 1}$

___

#### 例 2

求矩阵 $A=\begin {bmatrix} 2\mathrm {i}&\mathrm {i}&0\\0&0&-3\\2&1&1\end {bmatrix}$ 的减号逆矩阵通式

**解：**

$$
\begin{aligned}
\left[\begin{array}{c|c}
A & E_{m} \\ \hline
E_{n} & 0
\end{array}\right]&=\left[\begin{array}{rrr|rrr}
2\mathrm{i} & \mathrm{i} & 0&1&0&0 \\ 
0&0&-3&0&1&0 \\
2&1&1 &0&0&1\\ \hline
1 & 0 & 0  & & \\
0 & 1 & 0 & & 0 \\
0 & 0 & 1
\end{array}\right]\\
&\to \left[\begin{array}{rrr|rrr}
1 & 0 & 0&1&0&0 \\ 
0&1&0&0&1&0 \\
0&0&0 &\mathrm{i}&\frac{1}{3}&1\\ \hline
-\frac{1}{2}\mathrm{i} & 0&-\frac{1}{2}  & & \\
0 & 0 & 1 & & 0 \\
0 & -\frac{1}{3} & 0
\end{array}\right]
\end{aligned}
$$

于是

$$
{P}=\left[\begin{array}{ccc}
1 & 0 & 0 \\
0 & 1 & 0 \\
\mathrm{i}&\frac{1}{3}&1
\end{array}\right], \quad {Q}=\begin{bmatrix}
-\frac{1}{2}\mathrm{i} & 0&-\frac{1}{2} \\
0 & 0 & 1 \\
0 & -\frac{1}{3} & 0
\end{bmatrix}
$$

所以

$$
A^-=Q\begin{bmatrix}E_2&B\\C&D\end{bmatrix}P
$$

其中 $B\in \mathbb {C}^{2\times 1}, C\in \mathbb {C}^{2\times 2},D\in \mathbb {C}^{2\times 1}$

___

#### 非齐次线性方程组的相容性

**（定理）**$A\in \mathbb {C}^{n\times n},Ax=b$ 有解 $\Leftrightarrow b=AA^-b$

#### 非齐次线性方程组解的结构

**（定理）**$A\in \mathbb {C}^{m\times n}$，若 $Ax=b$ 有解，则通解为

$$
x=A^{+}b+(E_n-A^+A)t
$$

其中 $t\in \mathbb {C}^{n}$。若相容，则上式为通解；若不相容，则上式为最小二乘的通解

___

#### 矩阵的左逆、右逆

设 $A \in \mathbb {C}^{m \times n}, B \in \mathbb {C}^{n \times m}$，若有 $BA=E_n$，则称 $B$ 是 $A$ 的一个**左逆**，记为 $A_L^{-1}$

> 等价条件：

-   $A$ 的零空间 $N (A)={0}$
-   $m \geqslant n, \; \mathrm {rank}(A)= n$，即 $A$ 是**列满秩的**
-   $A^H A$ 可逆

设 $A \in \mathbb {C}^{m \times n}, C \in \mathbb {C}^{n \times m}$，有 $AC = E_m$，则称 $C$ 是 $A$ 的一个**右逆**，记为 $A_R^{-1}$

> 等价条件：

-   $A$ 的列空间 $R (A)=C^m$
-   $m \leqslant n, \; \mathrm {rank}(A)=m$，即 $A$ 是**行满秩的**
-   $AA^H$ 可逆

___

#### 矩阵的加号逆

**定义：**对于矩阵 $A \in \mathbb {C}^{m \times n}$，$A=BC$ 是 $A$ 的一个**满秩分解**，则

$$
A^+ = \underbrace{C^H(CC^H)^{-1}}_{C_R^{-1}}\underbrace{(B^HB)^{-1}B^H}_{B_L^{-1}}
$$

是 $A$ 的加号逆，且加号逆唯一

**性质：**

-   $\mathrm{rank}(A) = \mathrm{rank}(A^+)$
-   $\mathrm{rank}(A^+A) = \mathrm{rank}(AA^+) = \mathrm{rank}(A)$

#### $A^+$ 的求法

实际上加号逆的定义就是一个求法，另外还可以通过 SVD 分解进行求解：

对矩阵 $A$ 进行**奇异值分解**，得到 $A = U \begin {bmatrix}\Delta &0 \\ 0 & 0\end {bmatrix} V^H$，则 **$\color{red}{A^+ = V \begin{bmatrix}\Delta^{-1} & 0\\ 0 & 0\end{bmatrix}U^H}$**

___

#### 例 2

分别求矩阵 $A=\left [\begin {array}{lllll} 1 & 1 & 0 & 1 & 0 \\0 & 1 & 1 & 1 & 1 \\1 & 0 & 1 & 1 & 0\end {array}\right],B = \begin {bmatrix} 0&1&0&1\\0&1&0&1\\2&0&1&1\end {bmatrix}$ 的加号逆

**解：**

对矩阵 $A$ 只作初等行变换

$$
A=\left[\begin{array}{lllll}
1 & 1 & 0 & 1 & 0 \\
0 & 1 & 1 & 1 & 1 \\
1 & 0 & 1 & 1 & 0
\end{array}\right]\to ···\to \begin{bmatrix}1&0&0&\frac{1}{2}&-\frac{1}{2}\\0&1&0&\frac{1}{2}&\frac{1}{2}\\0&0&1&\frac{1}{2}&\frac{1}{2}\end{bmatrix}
$$

故可将 $A$ 进行满秩分解为 $A=CD$，且

$$
C = \begin{bmatrix}1&1&0\\0&1&1\\1&0&1\end{bmatrix},D = \begin{bmatrix}1&0&0&\frac{1}{2}&-\frac{1}{2}\\0&1&0&\frac{1}{2}&\frac{1}{2}\\0&0&1&\frac{1}{2}&\frac{1}{2}\end{bmatrix}
$$

则

$$
A^+=\begin{bmatrix}\frac{1}{3}&-\frac{1}{3}&\frac{1}{3}\\\frac{1}{2}&\frac{1}{4}&-\frac{1}{2}\\-\frac{1}{2}&\frac{1}{4}&\frac{1}{2}\\\frac{1}{6}&\frac{1}{12}&\frac{1}{6}\\-\frac{1}{6}&\frac{5}{12}&-\frac{1}{6}\end{bmatrix}
$$

对矩阵 $B$ 只作初等行变换

$$
B = \begin{bmatrix}0&1&0&1\\0&1&0&1\\2&0&1&1\end{bmatrix}\to ···\to \begin{bmatrix}1&0&\frac{1}{2}&\frac{1}{2}\\0&1&0&1\\0&0&0&0\end{bmatrix}
$$

故可将 $B$ 进行满秩分解为 $B=EF$，且

$$
E = \begin{bmatrix}0&1\\0&1\\2&0\end{bmatrix},F = \begin{bmatrix}1&0&\frac{1}{2}&\frac{1}{2}\\0&1&0&1\end{bmatrix}
$$

则

$$
B^+=\begin{bmatrix}-\frac{1}{11}&-\frac{1}{11}&\frac{4}{11}\\\frac{3}{11}&\frac{3}{11}&-\frac{1}{11}\\-\frac{1}{22}&-\frac{1}{22}&\frac{2}{11}\\\frac{5}{22}&\frac{5}{22}&\frac{1}{11}\end{bmatrix}
$$

### 复习

#### 线性空间

设 $\alpha$ 为线性空间 $V (\mathbb {F})$ 中非零向量，若 $\mathbb {F}$ 中数 $k_1$ 与 $k_2$ 不相等，试证：$k_1\alpha\neq k_2\alpha$

**证：**假设 $k_1\alpha =k_2\alpha$，则

$$
\begin{aligned}
k_1\alpha-k_2\alpha=0 \\
\Rightarrow (k_1-k_2)\alpha=0
\end{aligned}
$$

因为 $\alpha \neq 0$，所以 $k_1-k_2=0$，则 $k_1=k_2$，这与题意矛盾，故 $k_1\alpha \neq k_2\alpha$

___

#### 线性空间基与维数

求下列线性空间的维数及其一组基：

（1）$\mathbb {F}^{2\times 2}$ 中全体对称矩阵所构成的 $\mathbb {F}$ 上的线性空间

（2）$\mathbb {C}^{2\times 2}$ 中全体上三角矩阵所构成的 $\mathbb {C}$ 上的线性空间

（3）$V(\mathbb{F})=\{(x_1,x_2,...,x_{2n-1},x_{2n})\mid x_2=x_4=···=x_{2n}, \forall x_i\in \mathbb{F}\}$

（4）$A = \text {diag}(1, w, w^2)$，其中 $w^3=1$，但 $w \neq 1$，且 $V (\mathbb {R})=\{f (A)\mid \forall f (x) \in \mathbb {R}[x]\}$

**解：**

> 线性空间的一组基要满足：**线性无关**，**空间中任意一个向量都能由这组基表示**

（1）$\mathbb {F}^{2\times 2}$ 中矩阵的一般形式为 $\begin {bmatrix} x&z\\z&y\end {bmatrix}$，因此很容易得 $\mathbb {F}^{2\times 2}$ 中全体对称矩阵所构成的 $\mathbb {F}$ 上的线性空间的一组基为

$$
\begin{bmatrix}1&0\\0&0\end{bmatrix},\begin{bmatrix}0&0\\0&1\end{bmatrix},\begin{bmatrix}0&1\\1&0\end{bmatrix}
$$

维数为 3

（2）$\mathbb {C}^{2\times 2}$ 中上三角矩阵的一般形式为 $\begin {bmatrix} x&z\\0&y\end {bmatrix}$，因此很容易得其基为

$$
\begin{bmatrix}1&0\\0&0\end{bmatrix},\begin{bmatrix}0&1\\0&0\end{bmatrix},\begin{bmatrix}0&0\\0&1\end{bmatrix}
$$

维数为 3

（3）$V (\mathbb {F})$ 中向量的一般形式为 $(x_1, y,x_3,y,x_5, y,.....,x_{2n-1},y)$，因此很容易得其基为

$$
\begin{aligned}
&(1, 0,0,...,0)\\
&(0,0,1,...,0)\\
&\ \ \ \ \ \ \ \  \ \ \vdots\\
&(0,1,0,1,...,0,1)
\end{aligned}
$$

维数为 $n+1$

（4）因为 $f (A) = a_0E+a_1A+a_2A^2+・・・+a_nA^n$，又因为

$$
A = \begin{bmatrix}1&0&0\\0&w&0\\0&0&w^2\end{bmatrix}\\
A^2 = \begin{bmatrix}1&0&0\\0&w^2&0\\0&0&1\end{bmatrix}\\
A^3 = \begin{bmatrix}1&0&0\\0&1&0\\0&0&1\end{bmatrix}\\
A^4 = \begin{bmatrix}1&0&0\\0&w&0\\0&0&w^2\end{bmatrix}
$$

所以实际上 $f (A)=a_0E+a_1A+a_2A^2+a_3E+a_4A+a_5A^2+・・・+a_nA^n$，其中

$$
A^n=\begin{cases}E,\quad{n \%3=0}\\A,\quad{(n-1)\%3=0}\\A^2, \quad{(n+1)\%3=0}\end{cases}
$$

容易得 $E,A,A^2$ 就是该线性空间的一组基，维数为 3

___

#### 子空间

设 $A\in \mathbb {C}^{n\times n}$

（1）$V = \{B\mid AB=BA, B\in \mathbb {C}^{n\times n}\}$，证明 $V$ 是 $\mathbb {C}^{n\times n}$ 的子空间

（2）若 $A=E$，求（1）中 $V$

（3）若 $A=\text {diag}(1, 2, ..., n)$，求（1）中 $V$

（4）若 $n=3,A=\begin {bmatrix} 3&0&0\\0&1&0\\0&1&2\end {bmatrix}$，求（1）中 $V$

**解：**

> 要验证某个线性空间是子空间，只需要判断其**加法**和**数乘**是否封闭

（1）首先验证对于加法是否封闭

$$
\forall B_1,B_2 \in V\\
\because A (B_1+B_2)=AB_1+AB_2\\
又 \because AB_1 = B_1A,AB_2=B_2A\\
\therefore AB_1+AB_2=B_1A+B_2A\Rightarrow A (B_1+B_2)=(B_1+B_2) A\\
\therefore B_1+B_2 \in V
$$

其次验证对于数乘是否封闭

$$
\forall B\in V, k\in \mathbb{C}\\
\because A(kB)=k(AB)=k(BA)=(kB)A\\
\therefore kB\in V
$$

所以 $V$ 是 $\mathbb {C}^{n\times n}$ 的子空间

（2）因为单位矩阵和任何矩阵相乘，都等于那个矩阵本身，所以 $V=\mathbb {C}^{n\times n}$

（3）设 $B=(a_{ij})_{n\times n}$，则

$$
AB = \begin{bmatrix}a_{11}\\&2a_{22}\\&&\ddots \\&&&na_{nn}\end{bmatrix}\\
BA = \begin{bmatrix}a_{11}&2a_{12}&\cdots & na_{1n}\\a_{21}&2a_{22}&\cdots &na_{2n}\\\vdots &&&\vdots\\a_{n1}&2a_{n2}&\cdots &na_{nn}\end{bmatrix}
$$

若要满足 $AB=BA$，则需要 $a_{12}=・・・a_{1n}=・・・a_{21}=・・・a_{nn-1}=0$，故此时 $V$ 是一个 $n\times n$ 的对角阵构成的集合

（4）设 $B=\begin {bmatrix} x_1&x_2&x_3\\y_1&y_2&y_3\\z_1&z_2&z_3\end {bmatrix}$，则

$$
\begin{aligned}
AB &= \begin{bmatrix}3x_1&3x_2&3x_3\\y_1&y_2&y_3\\y_1+2z_1&y_2+2z_3&y_3+2z_3\end{bmatrix}\\
BA &= \begin{bmatrix}3x_1&x_2+x_3&2x_3\\3y_1&y_2+y_3&2y_3\\3z_1&z_2+z_3&2z_3\end{bmatrix}
\end{aligned}
$$

由于 $AB=BA$，则有

$$
\begin{cases}
x_2=0\\
x_3=0\\
y_1=0\\
y_2=z_3\\
y_3=0\\
z_1=0\\
z_3=0
\end{cases}
$$

故 $B=\begin {bmatrix} x_1&0&0\\0&y_2&0\\0&z_2&y_2\end {bmatrix}$，其中 $x_1,y_2,z_2\in \mathbb {C}$

___

#### 和空间与交空间

已知 $\alpha_1=(1, 2, 1,0), \alpha_2=(-1, 1, 1, 1), \beta_1=(2, -1, 0, 1), \beta_2=(1, -1, 3, 7)$，$V_1=\text {span}\{\alpha_1, \alpha_2\},V_2=\text {span}\{\beta_1,\beta_2\}$，分别求 $V_1+V_2,V_1\cap V_2$ 的一组基

**解：**

> $\color{red}{V_1+V_2=\text{span}\{\alpha_1,\alpha_2,\beta_1,\beta_2\}}$

因为

$$
\begin {aligned}
(\alpha_1^T,\alpha_2^T,\beta_1^T,\beta_2^T)&=\begin {bmatrix} 1&-1&2&1\\2&1&-1&-1\\1&1&0&3\\0&1&1&7\end {bmatrix}\\
&\stackrel {初等行变换}{\longrightarrow} \begin {bmatrix} 1&0&0&-1\\0&1&0&4\\0&0&1&3\\0&0&0&0\end {bmatrix}
\end {aligned}
$$

由于初等行变换后前三列为非零首元，所以在原矩阵中前三列是线性无关的，故列向量组 $(\alpha_1^T,\alpha_2^T,\beta_1^T,\beta_2^T)$ 的极大线性无关组为 $(\alpha_1^T,\alpha_2^T,\beta_1^T)$，所以 $V_1+V_2$ 的一组基是 $(\alpha_1,\alpha_2,\beta_1)$

> $$
> \color {red}
> {\begin {aligned}
> {\eta\in V_1\cap V_2}\Leftrightarrow &\exists k_1, k_2 使 \eta=k_1\alpha_1+k_2\alpha_2\\
> &\exists l_1,l_2 使 \eta=l_1\beta_1+l_2\beta_2
> \end {aligned}}
> $$

设 $k_1\alpha_1+k_1\alpha_2=l_1\beta_1+l_2\beta_2$，则 $k_1\alpha_1+k_1\alpha_2-l_1\beta_1-l_2\beta_2=0$，即

$$
\begin{cases}
k_1-k_2-2l_1-l_2=0\\
2k_1+k_2+l_1+l_2=0\\
k_1+k_2-3l_2=0\\
k_2-l_1-7l_2=0
\end{cases}
$$

解得

$$
\begin {cases}
k_1=-l_2\\
k_2=4l_2\\
l_1=-3l_2\\
l_2 自由
\end {cases}
$$

不妨令 $l_2=1$，则 $k_1=-1,k_2=4,l_1=-3$，于是 $V_1\cap V_2=\{k (-\alpha_1+4\alpha_2)\}$ 或 $V_1\cap V_2=\{l (-3\beta_1+\beta_2)\}$

故 $V_1\cap V_2$ 的一组基是 $-\alpha_1+4\alpha_2$（或 $-3\beta_1+\beta_2$）

> 上面带有 "或" 字样的，写一个即可，考试时并不需要全部写出来

___

#### 直和

设 $V_1=\{A\mid A^T=A, A\in \mathbb {C}^{n\times n}\}, V_2=\{A\mid A^T=-A, A\in \mathbb {C}^{n\times n}\}$，试证：$\mathbb {C}^{n\times n}=V_1\oplus V_2$

**证：**

> 要证明某个线性空间 $V$ 是两个子空间 $V_1,V_2$ 的直和，需要证明以下两点：
>
> 1.  $V = V_1+V_2$，要证明相等，实际上就是证明左包含以及右包含
> 2.  $V_1+V_2$ 是直和

由 $V_1,V_2$ 的定义明显可得 $V_1+V_2\subseteq \mathbb {C}^{n\times n}$；要证明 $\mathbb {C}^{n\times n}\subseteq V_1+V_2$，实际上就是要证明

$$
\forall A\in \mathbb{C}^{n\times n} , A_1\in V_1, A_2\in V_2 \Rightarrow A = A_1+A_2
$$

因为 $\frac {1}{2}(A+A^T)\in V_1, \frac {1}{2}(A-A^T)\in V_2$，且 $A = \frac {1}{2}(A+A^T)+\frac {1}{2}(A-A^T)$，所以 $\mathbb {C}^{n\times n}\subseteq V_1+V_2$

综上所述 $\mathbb {C}^{n\times n}=V_1+V_2$

要证明 $V_1+V_2$ 是直和，只需要证明 $V_1 \cap V_2=\{0\}$。任取 $A\in V_1\cap V_2$，则有

$$
A = A^T （因为 A\in V_1）\\
A^T = -A （因为 A\in V_2）
$$

综上，$A\equiv 0$，所以 $V_1+V_2$ 是直和，即 $\mathbb {C}^{n\times n}=V_1\oplus V_2$

___

#### 直和

设 $A, B\in \mathbb {F}^{n\times n}$，且 $AB=0, B^2=B$， $V_1=\{X\mid AX=0, X\in \mathbb {F}^n\}, V_2=\{X\mid BX=0, X\in \mathbb {F}^n\}$，证明：

（1）$\mathbb{F}^n=V_1+V_2$

（2）$\mathbb{F}^n=V_1\oplus V_2 \Leftrightarrow r(A)+r(B)=n$

**证：**

（1）由 $V_1,V_2$ 的定义明显可得 $V_1+V_2\subseteq \mathbb {F}^{n}$；要证明 $\mathbb {F}^{n}\subseteq V_1+V_2$，实际上就是要证明

$$
\forall X\in \mathbb{F}^{n} , X_1\in V_1, X_2\in V_2 \Rightarrow X = X_1+X_2
$$

因为 $X = BX+(X-BX)$，下判断 $BX\in V_1, (X-BX)\in V_2$

$$
\because A(BX)=(AB)X=0\\
\therefore BX\in V_1\\
\because B(X-BX)=BX-B^2X=BX-BX=0\\
\therefore (X-BX)\in V_2
$$

所以 $\mathbb {F}^{n}\subseteq V_1+V_2$，综上所述 $\mathbb {F}^{n}= V_1+V_2$

（2）将 $V_1,V_2$ 看做是齐次线性方程组的解空间，则有

$$
\dim (V_1)=n-r(A)\\
\dim (V_2)=n-r(B)
$$

要证明 $\mathbb {F}^{n}= V_1\oplus V_2$ 实际上就是要证 $\mathbb {F}^{n}= V_1+V_2$ 且 $V_1+V_2$ 是直和，第一问已经证明 $\mathbb {F}^{n}= V_1+V_2$，所以问题就转为证明

$$
V_1+V_2 是直和 \Leftrightarrow r (A)+r (B)=n
$$

因为

$$
\begin {aligned}
V_1+V_2 是直和 &\Leftrightarrow \dim (V_1+V_2)=\dim (V_1) + \dim (V_2)\\
&\Leftrightarrow \dim (\mathbb {F})=\dim (V_1)+\dim (V_2)\\
&\Leftrightarrow n = (n-r (A)) + (n-r (B))\\
&\Leftrightarrow r (A) + r (B) = n
\end {aligned}
$$

证毕

___

#### 线性变换

在 $\mathbb {F}^{2\times 2}$ 中定义线性变换 $\mathscr {A}(X)=\begin {bmatrix} a&b\\c&d\end {bmatrix} X, \forall X\in \mathbb {F}^{2\times 2}$，分别求 $\mathscr {A}$ 在基 $E_{11}, E_{12}, E_{21}, E_{22}$ 与基 $E_{11}, E_{21}, E_{12}, E_{22}$ 下的矩阵

**解：**

> 对于基为矩阵的形式，可以将所有的矩阵转为列向量进行处理

根据定义有

$$
\begin{aligned}
&(\mathscr{A}(E_{11}), \mathscr{A}(E_{12}), \mathscr{A}(E_{21}), \mathscr{A}(E_{22}))=(E_{11}, E_{12}, E_{21}, E_{22})A\\
&\Rightarrow \begin{bmatrix}a&0&b&0\\0&a&0&b\\c&0&d&0\\0&c&0&d\end{bmatrix}=\begin{bmatrix}1&0&0&0\\0&1&0&0\\0&0&1&0\\0&0&0&1\end{bmatrix}A\\
&\Rightarrow A = \begin{bmatrix}a&0&b&0\\0&a&0&b\\c&0&d&0\\0&c&0&d\end{bmatrix}
\end{aligned}
$$

同理

$$
\begin{aligned}
&(\mathscr{A}(E_{11}), \mathscr{A}(E_{21}), \mathscr{A}(E_{12}), \mathscr{A}(E_{22}))=(E_{11}, E_{21}, E_{12}, E_{22})B\\
&\Rightarrow \begin{bmatrix}a&b&0&0\\0&0&a&b\\c&d&0&0\\0&0&c&d\end{bmatrix}=\begin{bmatrix}1&0&0&0\\0&0&1&0\\0&1&0&0\\0&0&0&1\end{bmatrix}B\\
&\Rightarrow B = \begin{bmatrix}a&0&b&0\\0&a&0&b\\c&0&d&0\\0&c&0&d\end{bmatrix}
\end{aligned}
$$

___

#### 正交矩阵

设 $A, B$ 都是正交阵，且 $|AB|=-1$，证明 $|A+B|=0$

**证：**

> 正交矩阵的性质：$\color {red} {A^T=A^{-1}}$

因为 $|AB|=-1$，所以 $|A|・|B|=-1$，又因为

$$
\begin{aligned}
A+B&=A(E+A^{-1}B)\\
&=A(E+A^TB)\\
&=A(B^T+A^T)B\\
&=A(A+B)^TB
\end{aligned}
$$

则有 $|A+B|=|A|・|(A+B)^T|・|B|=-|A+B|$，故 $|A+B|=0$

___

#### Jordan 标准形（排除法）

试求矩阵的 Jordan 标准形

（1）$A = \begin{bmatrix}3&0&8\\3&-1&6\\-2&0&-5\end{bmatrix}$

（2）$B = \begin{bmatrix}0&3&3\\-1&8&6\\2&-14&-10\end{bmatrix}$

**解：**

> 关于 Jordan 标准形的两种求法，请看本文最后附录

（1）容易求得 $|\lambda E -A| = (\lambda + 1)^3$，所以 $A$ 的 Jordan 标准形矩阵只可能是以下三种情况

$$
L=\begin{bmatrix}-1&0&0\\0&-1&0\\0&0&-1\end{bmatrix}\\
M=\begin{bmatrix}-1&0&0\\0&-1&1\\0&0&-1\end{bmatrix}\\
N=\begin{bmatrix}-1&1&0\\0&-1&1\\0&0&-1\end{bmatrix}
$$

因为 $A$ 与 Jordan 标准形 $J$ 相似，则 $\mathrm {rank}(A-(-1) E)=\mathrm {rank}(J-(-1) E)$，因为 $\mathrm {rank}(A-(-1) E)=1$，且

$$
\mathrm{rank}(L-(-1)E)=0\\
\mathrm{rank}(M-(-1)E)=1\\
\mathrm{rank}(N-(-1)E)=2
$$

所以 $A$ 的 Jordan 标准形为 $\begin {bmatrix}-1&0&0\\0&-1&1\\0&0&-1\end {bmatrix}$

（2）容易求得 $|\lambda E -B| = \lambda (\lambda + 1)^2$，所以 $B$ 的 Jordan 标准形矩阵只可能是以下两种情况

$$
L=\begin{bmatrix}0&0&0\\0&-1&0\\0&0&-1\end{bmatrix}\\
M=\begin{bmatrix}0&0&0\\0&-1&1\\0&0&-1\end{bmatrix}\\
$$

因为 $B$ 与 Jordan 标准形 $J$ 相似，则 $\mathrm {rank}(B-(-1) E)=\mathrm {rank}(J-(-1) E)$，因为 $\mathrm {rank}(B-(-1) E)=2$，且

$$
\mathrm{rank}(L-(-1)E)=1\\
\mathrm{rank}(M-(-1)E)=2\\
$$

所以 $B$ 的 Jordan 标准形为 $\begin {bmatrix} 0&0&0\\0&-1&1\\0&0&-1\end {bmatrix}$

___

#### Jordan 标准形（推论）

将矩阵

$$
\begin{align} 
A=\begin{bmatrix} 2 & 6 & -15 \\ 1 & 1 & -5 \\ 1 & 2 & -6 \end{bmatrix} 
\end{align}
$$

化为 Jordan 标准形

**解：**矩阵 $A$ 的特征多项式为

$$
\begin{align} 
\lvert \lambda E-A \rvert =\begin{bmatrix} \lambda-2 & -6 & 15 \\ -1 & \lambda-1 & 5 \\ -1 & -2 & \lambda+6 \end{bmatrix} =(\lambda+1)^3 
\end{align}
$$

所以它只有一个特征值 $\lambda_1=-1$，代数重数为 3

对 $\lambda=-1$，令

$$
\begin{align} 
B=A-\lambda_1 E = A+E &=\begin{bmatrix} 3 &  6 & -15 \\ 1 & 2 & -5 \\ 1 & 2 & -5 \end{bmatrix} \qquad  \mathrm{rank}(B)=1\\
B^2&=\begin{bmatrix}0&0&0\\0&0&0\\0&0&0\end{bmatrix} \qquad \mathrm{rank}(B^2)=0
\end{align}
$$

则以 $\lambda_1$ 为特征值且阶为 1 的 Jordan 块的个数为

$$
\begin{align} 
w_1(A,\lambda_1)-w_2(A,\lambda_1)=[n-r_1(A,\lambda_1)]  - [r_1(A,\lambda_1)-r_2(A,\lambda_1)]  = [3-1]-[1-0]=1 
\end{align}
$$

同理，以 $\lambda_1$ 为特征值且阶为 2 的 Jordan 块的个数为

$$
\begin{align} 
w_2(A,\lambda_1)-w_3(A,\lambda_1)=[r_1(A,\lambda_1)-r_2(A,\lambda_1)]  - [r_2(A,\lambda_1)-r_3(A,\lambda_1)]  = [1-0]-[0-0]=1 
\end{align}
$$

上面两个 Jordan 块阶数之和为 3，等于 $\lambda_1$ 的代数重数，因而不存在以 $\lambda_1$ 为特征值的其它 Jordan 块，且矩阵 $A$ 没有其它特征值，故 Jordan 块求解完毕，矩阵 $A$ 的 Jordan 标准形为

$$
\begin{align} 
J=\begin{bmatrix} -1 & 0 & 0 \\ 0 & -1 & 1 \\ 0 & 0 & -1\end{bmatrix} 
\end{align}
$$

___

#### Jordan 标准形（推论）

将矩阵

$$
\begin{align} 
A=\begin{bmatrix} 3 & -4 & 0 & 2 \\ 4 & -5 & -2 & 4 \\ 0 & 0 & 3 & -2 \\ 0 & 0 & 2 & -1  \end{bmatrix} 
\end{align}
$$

化为 Jordan 标准形

**解：**矩阵 $A$ 的特征多项式为

$$
\begin{align} 
\lvert \lambda E-A \rvert =\begin{bmatrix} \lambda-3 & 4 & 0 & -2 \\ -4 & \lambda+5 & 2 & -4 \\ 0 & 0 & \lambda-3 & 2 \\ 0 & 0 & -2 & \lambda+1  \end{bmatrix} =(\lambda+1)^2(\lambda-1)^2 
\end{align}
$$

所以它有两个特征值 $\lambda_1=-1,\lambda_2=1$，代数重数都为 2

对 $\lambda_1=-1$，令

$$
\begin{align} 
B_1=A-\lambda_1 E = A+E &=\begin{bmatrix} 4 & -4 & 0 & 2 \\ 4 & -4 & -2 & 4 \\ 0 & 0 & 4 & -2 \\ 0 & 0 & 2 & 0  \end{bmatrix}    \qquad \mathrm{rank}(B_1)=3   \\ 
B_1^2 &=\begin{bmatrix} 0 & 0 &12 & -8 \\ 0 & 0 & 8 & -4 \\ 0 & 0 & 12 & -8 \\ 0 & 0 & 8 & -4  \end{bmatrix} \qquad \mathrm{rank}(B_1^2)=2   \\ 
B_1^3 &=\begin{bmatrix} 0 & 0 & 32 & -24 \\ 0 & 0 & 24 & -16 \\ 0 & 0 & 32 & -24 \\ 0 & 0 & 24 & -16  \end{bmatrix} \qquad \mathrm{rank}(B_1^3)=2 
\end{align}
$$

则以 $\lambda_1$ 为特征值且阶为 1 的 Jordan 块的个数为

$$
\begin{align} 
w_1(A,\lambda_1)-w_2(A,\lambda_1)=[n-r_1(A,\lambda_1)]  - [r_1(A,\lambda_1)-r_2(A,\lambda_1)]  = [4-3]-[3-2]=0 
\end{align}
$$

以 $\lambda_1$ 为特征值且阶为 2 的 Jordan 块的个数为

$$
\begin{align} 
w_2(A,\lambda_1)-w_3(A,\lambda_1)=[r_1(A,\lambda_1)-r_2(A,\lambda_1)]  - [r_2(A,\lambda_1)-r_3(A,\lambda_1)]  = [3-2]-[2-2]=1 
\end{align}
$$

上面第二个 Jordan 块阶数为 2，等于 $\lambda_1$ 的代数重数，所以以 $\lambda_1$ 为特征值的 Jordan 块求解完毕

对 $\lambda_2=1$，令

$$
\begin{align} 
B_2=A-\lambda_2 E = A-E &=\begin{bmatrix} 2 & -4 & 0 & 2 \\ 4 & -6 & -2 & 4 \\ 0 & 0 & 2 & -2 \\ 0 & 0 & 2 & -2  \end{bmatrix}    \qquad \mathrm{rank}(B_2)=3   \\ 
B_2^2 &=\begin{bmatrix} -12 & 16 & 12 & -16 \\ -16 & 20 & 16 & -20 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0  \end{bmatrix} \qquad \mathrm{rank}(B_2^2)=2   \\ 
B_2^3 &=\begin{bmatrix} 40 & -48 & -40 & 48 \\ 48 & -56 & -48 & 56 \\ 0 & 0 & 0 & 0 \\ 0 & 0 & 0 & 0  \end{bmatrix} \qquad \mathrm{rank}(B_2^3)=2 
\end{align}
$$

则以 $\lambda_2$ 为特征值且阶为 1 的 Jordan 块的个数为

$$
\begin{align} 
w_1(A,\lambda_2)-w_2(A,\lambda_2)=[n-r_1(A,\lambda_2)]  - [r_1(A,\lambda_2)-r_2(A,\lambda_2)]  = [4-3]-[3-2]=0 
\end{align}
$$

以 $\lambda_2$ 为特征值且阶为 2 的 Jordan 块的个数为

$$
\begin{align} 
w_2(A,\lambda_2)-w_3(A,\lambda_2)=[r_1(A,\lambda_2)-r_2(A,\lambda_2)]  - [r_2(A,\lambda_2)-r_3(A,\lambda_2)]  = [3-2]-[2-2]=1 
\end{align}
$$

上面第二个 Jordan 块阶数为 2，等于 $\lambda_2$ 的重数，所以以 $\lambda_2$ 为特征值的 Jordan 块求解完毕

以 $\lambda_1=-1$ 和 $\lambda_2=1$ 为特征值的 Jordan 块均是 2 阶的，所以矩阵 $A$ 的 Jordan 标准形为

$$
\begin{align} 
J=\begin{bmatrix} -1 & 1 & 0 & 0 \\ 0 & -1 & 0  & 0 \\ 0 & 0 & 1 & 1 \\ 0&0&0& 1\end{bmatrix} 
\end{align}
$$

___

#### $A^n$

已知 $A=\begin {bmatrix} 17&0&-25\\0&1&0\\9&0&-13\end {bmatrix}$，求 $A^{10}$

**解：**矩阵 $A$ 做不了相似对角化，但一定可以化为 Jordan 标准形（这里省略求 Jordan 标准形的步骤）

$$
J = \begin{bmatrix}1&0&0\\0&2&1\\0&0&2\end{bmatrix}
$$

设 $P=(X_1,X_2,X_3)$，由 $AP=PJ$ 得

$$
\begin{aligned}
&(AX_1, AX_2, AX_3)=(X_1, 2X_2, X_2+2X_3)\\
&\Rightarrow \begin{cases}(E-A)X_1 = 0\\(2E-A)X_2=0\\(2E-A)X_3=-X_2\end{cases}
\end{aligned}
$$

解得

$$
X_1 = \begin{bmatrix}0\\1\\0\end{bmatrix}, X_2 = \begin{bmatrix}5\\0\\3\end{bmatrix}, X_3 = \begin{bmatrix}2\\0\\1\end{bmatrix}
$$

所以 $P=\begin {bmatrix} 0&5&2\\1&0&0\\0&3&1\end {bmatrix}$，则

$$
\begin{aligned}
A^{10} &=\left(P J P^{-1}\right)^{10} \\
&=P J^{10} P^{-1} \\
&=\begin{bmatrix}
0 & 5 & 2 \\
1 & 0 & 0 \\
0 & 3 & 1
\end{bmatrix}\begin{bmatrix}
1 & 0 & 0 \\
0 & 2 & 1 \\
0 & 0 & 2
\end{bmatrix}^{10}\begin{bmatrix}
0 & 5 & 2 \\
1 & 0 & 0 \\
0 & 3 & 1
\end{bmatrix}^{-1} \\
&=\begin{bmatrix}
0 & 5 & 2 \\
1 & 0 & 0 \\
0 & 3 & 1
\end{bmatrix}
\begin{bmatrix}
1 & 0 & 0 \\
0 & 2^{10} & 10 \cdot 2^{9} \\
0 & 0 & 2^{10}
\end{bmatrix}
\begin{bmatrix}
0 & 1 & 0 \\
-1 & 0 & 2 \\
3 & 0 & -5
\end{bmatrix} \\
&=\begin{bmatrix}
76·2^{10} & 0 & -125·2^{10} \\
 0 & 1 & 0 \\
 45 · 2^{10}& 0 & -74·2^{10}
\end{bmatrix}
\end{aligned}
$$

___

#### 矩阵广义逆

设 $A\in \mathbb {C}^{s\times n}, r (A)=1$，试证：$A^+=(tr (A^HA))^{-1} A^H$

**证：**对 $A$ 进行满秩分解得 $A = B_{s\times 1} C_{1\times n}$，因为

$$
A^+ = C^H(CC^H)^{-1}(B^HB)^{-1}B^H
$$

又因为 $CC^H$ 和 $B^HB$ 都是数，所以

$$
\begin{aligned}
A^+ &= \frac{1}{(B^HB)(CC^H)}·C^HB^H\\
&=\frac{1}{(B^HB)(CC^H)}(BC)^H\\
&=\frac{1}{(B^HB)(CC^H)}A^H
\end{aligned}
$$

因为

$$
\begin {aligned}
A^HA &= (BC)^H (BC)\\
&=C^HB^HBC\\
&=(B^HB)(C^HC)\quad (因为 B^HB 是一个数)
\end {aligned}
$$

所以

$$
\begin{aligned}
tr(A^HA) &= B^HB·\text{tr}(C^HC)\\
&=B^HB · \text{tr}(CC^H)\\
&=B^HB·CC^H
\end{aligned}
$$

证毕

___

#### 矩阵广义逆

用适当的方式求下列矩阵的广义逆

（1）$A = \begin {bmatrix} 0&c\\a&0\\b&0\end {bmatrix}$，其中复数 $a,b,c$ 满足 $c\neq 0, |a|^2+|b|^2\neq 0$

（2）$A = \begin{bmatrix}1&0&-1\\2&0&-2\end{bmatrix}$

**解：**

（1）实际上有分块广义逆的性质：$B = \begin {bmatrix} 0&M\\N&0\end {bmatrix}\Rightarrow B^+=\begin {bmatrix} 0&N^+\\M^+&0\end {bmatrix}$，于是将 $A$ 进行分块得

$$
A^+ = \left[\begin{array}{c|c}0 & \begin{bmatrix}a\\b\end{bmatrix}^+ \\ \hline \frac{1}{c} & 0\end{array}\right]
$$

对 $\begin {bmatrix} a\\b\end {bmatrix}^+$ 进行满秩分解得 $\begin {bmatrix} a\\b\end {bmatrix}=B_{2\times 1} C_{1\times 1}$，不妨令 $B=\begin {bmatrix} a\\b\end {bmatrix},C=1$，则

$$
\begin{bmatrix}a\\b\end{bmatrix}^+=(B^HB)^{-1}B^H=\frac{1}{|a|^2+|b|^2}·[\bar{a}, \bar{b}]
$$

所以

$$
A^{+}=\begin{bmatrix}0&\frac{\bar{a}}{|a|^2+|b|^2}&\frac{\bar{b}}{|a|^2+|b|^2}\\\frac{1}{c}&0&0\end{bmatrix}
$$

（2）对 $A$ 做初等行变换得 $A\to \begin {bmatrix} 1&0&-1\\0&0&0\end {bmatrix}$，所以满秩分解 $A=BC$，其中 $B=\begin {bmatrix} 1\\2\end {bmatrix},C=\begin {bmatrix} 1&0&-1\end {bmatrix}$，由 $A^{+} = C^H (CC^H)^{-1}(B^HB)^{-1} B^H$ 得

$$
A =\begin{bmatrix}\frac{1}{10}&\frac{1}{5}\\0&0\\-\frac{1}{10}&-\frac{1}{5}\end{bmatrix}
$$

___

### 附

#### Jordan 标准形的两种求法

##### 排除法（适用于低阶矩阵）

1.  通过矩阵 $A$ 的特征多项式 $|\lambda E-A|$ 求得特征值 $\lambda_1,\lambda_2,...,\lambda_r$
2.  根据特征值列出所有可能的 Jordan 标准形矩阵 $J$
3.  由于矩阵 $A$ 与 Jordan 标准形 $J$ 相似，所以可通过 $\mathrm {rank}(A-\lambda_iE)=\mathrm {rank}(J-\lambda_iE)$ 进行排除，筛选出最终的 Jordan 标准形

##### Jordan 标准形定理的推论

首先定义

$$
\begin{align} 
r_k(A,\lambda)=\mathrm{rank} \, (A-\lambda E)^k, \quad r_0(A,\lambda)=n 
\end{align}
$$

又定义

$$
\begin{align} 
w_k(A,\lambda)=r_{k-1}(A,\lambda)-r_k(A,\lambda), \quad w_1(A,\lambda)=n-r_1(A,\lambda) 
\end{align}
$$

将矩阵化为 Jordan 标准形需要三步：

1.  求出矩阵 $A$ 所有**不同**的特征值 $\lambda_1,\lambda_2,...\lambda_t$
2.  Jordan 标准形定理的推论告诉我们：$w_k (A,\lambda)-w_{k+1}(A,\lambda)=m$ 表示以 $\lambda$ 为特征值且阶为 $k$ 的 Jordan 块有 $m$ 个。利用这个公式计算出以 $\lambda$ 为特征值，阶为 $l=1,2,...$ 的个数，直到以 $\lambda$ 为特征值的 Jordan 块阶数之和等于特征值 $\lambda$ 的代数重数
3.  将所获得的 Jordan 块按任意次序排列成 Jordan 矩阵

#### $A^n$ 求法

设矩阵 $A$ 的 Jordan 标准形为 $J$，且 $P=(X_1,X_2,X_3)$，由 $AP=PJ$ 求出 $P$，于是 $A^n=(PJP^{-1})^n=PJ^nP^{-1}$，其中

$$
J^n=\begin{bmatrix}J_1\\&J_2\\&&\ddots \\&&&J_m\end{bmatrix}^n=\begin{bmatrix}J_1^n\\&J_2^n\\&&\ddots \\&&&J_m^n\end{bmatrix}
$$

显然当其中某一个 Jordan 块 $J_i$ 阶数 $k$ 较大时，求幂次略显复杂

$$
\begin{bmatrix}\lambda &1\\&\lambda &1\\&&\lambda &\ddots  \\&&&\ddots&1\\&&&&\lambda\end{bmatrix}^n=\begin{bmatrix}\lambda^{n} & C_{n}^{1} \lambda^{n-1} & C_{n}^{2} \lambda^{n-2} & \cdots & C_{n}^{k-1} \lambda^{n-(k-1)} \\
& \lambda^{n} & C_{n}^{1} \lambda^{n-1} & \cdots & C_{n}^{k-2} \lambda^{n-(k-2)} \\
& & \lambda^{n} & \cdots & C_{n}^{k-3} \lambda^{n-(k-3)} \\
& & & \ddots & \vdots \\
& & & & \lambda^{n}\end{bmatrix}
$$

其中

$$
\begin{aligned}
C_n^{m}=\begin{cases}\frac{n!}{m!(n-m)!},&\quad {0≤m≤n}\\0, &\quad \text{others}\end{cases}
\end{aligned}
$$
