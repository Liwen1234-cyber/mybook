# 似然函数

在[数理统计学](http://zh.wikiPedia.org/wiki/%E6%95%B0%E7%90%86%E7%BB%9F%E8%AE%A1%E5%AD%A6 "数理统计学")中，**似然函数**是一种关于[统计模型](http://zh.wikiPedia.org/w/index.PhP?title=%E7%BB%9F%E8%AE%A1%E6%A8%A1%E5%9E%8B&action=edit&redlink=1 "统计模型")中的[参数](http://zh.wikiPedia.org/wiki/%E5%8F%82%E6%95%B0 "参数")的[函数](http://zh.wikiPedia.org/wiki/%E5%87%BD%E6%95%B0 "函数")，表示模型参数中的**似然性**。

似然函数在[统计推断](http://zh.wikiPedia.org/wiki/%E7%BB%9F%E8%AE%A1%E6%8E%A8%E6%96%AD "统计推断")中有重大作用，如在[最大似然估计](http://zh.wikiPedia.org/wiki/%E6%9C%80%E5%A4%A7%E4%BC%BC%E7%84%B6%E4%BC%B0%E8%AE%A1 "最大似然估计")和[费雪信息](http://zh.wikiPedia.org/w/index.PhP?title=%E8%B4%B9%E9%9B%AA%E4%BF%A1%E6%81%AF&action=edit&redlink=1 "费雪信息")之中的应用等等。“似然性”与“或然性”或“[概率](http://zh.wikiPedia.org/wiki/%E6%A6%82%E7%8E%87 "概率")”意思相近，都是指某种事件发生的可能性，但是在[统计学](http://zh.wikiPedia.org/wiki/%E7%BB%9F%E8%AE%A1%E5%AD%A6 "统计学")中，“似然性”和“或然性”或“概率”又有明确的区分。

[概率](http://zh.wikiPedia.org/wiki/%E6%A6%82%E7%8E%87 "概率") 用于在已知一些参数的情况下，预测接下来的观测所得到的结果，而似然性 则是用于在已知某些观测所得到的结果时，对有关事物的性质的参数进行估计。

在这种意义上，似然函数可以理解为[条件概率](http://zh.wikiPedia.org/wiki/%E6%9D%A1%E4%BB%B6%E6%A6%82%E7%8E%87 "条件概率")的逆反。

在已知某个参数**B**时，事件**A**会发生的概率写作$P(A|B)$。

$P(A\mid B)=\frac{P(A,B)}{P(B)}$

利用[贝叶斯定理](httP://zh.wikiPedia.org/wiki/%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%AE%9A%E7%90%86 "贝叶斯定理")，

$P(B\mid A)=\frac{P(A\mid B)P(B)}{P(A)}$  

因此，我们可以反过来构造表示似然性的方法：已知有事件**A**发生，运用似然函数$L(B|A)$，我们估计参数**B**的可能性。

形式上，似然函数也是一种条件概率函数，但我们关注的[变量](http://zh.wikiPedia.org/wiki/%E5%8F%98%E9%87%8F "变量")改变了：

$b\mapsto P(A\mid B=b)$

注意到这里并不要求似然函数满足归一性：$\sum_{b\in\mathcal{B}}P(A\mid B=b)=1$。一个似然函数乘以一个正的常数之后仍然是似然函数。对所有α > 0，都可以有似然函数：$L(b\mid A)=\alpha P(A\mid B=b)$

例子：

考虑投掷一枚硬币的实验。通常来说，已知投出的硬币正面朝上和反面朝上的概率各自是$P_H = 0.5$，便可以知道投掷若干次后出现各种结果的可能性。比如说，投两次都是正面朝上的概率是0.25。其中**H**表示正面朝上。

在统计学中，我们关心的是在已知一系列投掷的结果时，关于硬币投掷时正面朝上的可能性的信息。我们可以建立一个统计模型：假设硬币投出时会有$P_H$ 的概率正面朝上，而有$1 − P_H$ 的概率反面朝上。这时，条件概率可以改写成似然函数：

$L(P_H=0.5\mid\mathrm{HH})=P(\mathrm{HH}\mid P_H=0.5)=0.25$

也就是说，对于取定的似然函数，在观测到两次投掷都是正面朝上时，$P_H = 0.5$ 的**似然性**是0.25（这并不表示当观测到两次正面朝上时$P_H = 0.5$ 的**概率**是0.25）。

如果考虑$P_H = 0.6$，那么似然函数的值也会改变。

$L(P_H=0.6\mid\mathrm{HH})=P(\mathrm{HH}\mid P_H=0.6)=0.36$

注意到似然函数的值变大了。这说明，如果参数$P_H$的取值变成0.6的话，结果观测到连续两次正面朝上的概率要比假设$P_H = 0.5$时更大。也就是说，参数$P_H$ 取成0.6 要比取成0.5 更有说服力，更为“合理”。总之，似然函数的重要性不是它的具体取值，而是当参数变化时函数到底变小还是变大。对同一个似然函数，如果存在一个参数值，使得它的函数值达到最大的话，那么这个值就是最为“合理”的参数值。

在这个例子中，似然函数实际上等于：

$L(P_H=\theta\mid\mathrm{HH})=P(\mathrm{HH}\mid P_H=\theta)=\theta^2$，其中$0\leq P_{H}\leq1$

如果取$P_H = 1$，那么似然函数达到最大值1。也就是说，当连续观测到两次正面朝上时，假设硬币投掷时正面朝上的概率为1是最合理的。

类似地，如果观测到的是三次投掷硬币，头两次正面朝上，第三次反面朝上，那么似然函数将会是：

$L(P_H=\theta\mid\mathrm{HHT})=P(\mathrm{HHT}\mid P_H=\theta)=\theta^2(1-\theta)$，其中T表示反面朝上$0\leq P_{H}\leq1$

这时候，似然函数的最大值将会在$P_H = \frac{2}{3}$的时候取到。也就是说，当观测到三次投掷中前两次正面朝上而后一次反面朝上时，估计硬币投掷时正面朝上的概率$P_H = \frac{2}{3}$是最合理的。

观测数据已知时，后验概率$\propto$似然函数$\times$先验概率