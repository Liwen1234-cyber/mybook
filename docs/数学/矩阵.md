## 矩阵求导
- $\frac{{\partial ({x^T}a)}}{{\partial x}} = \frac{{\partial ({a^T}x)}}{{\partial x}} = a$
- $\frac{{\partial ({x^T}x)}}{{\partial x}} = 2x$
- $\frac{{\partial ({x^T}Ax)}}{{\partial x}} = Ax + {A^T}x,{A_{n \times n}} = ({a_{ij}})_{i = 1,j = 1}^{n,n}$
- $\frac{{\partial ({a^T}x{x^T}b)}}{{\partial x}} = a{b^T}x + b{a^T}x,a = {({a_1},{a_2},...,{a_n})^T},b = {({b_1},{b_2},...,{b_n})^T}$
- $\frac{{\partial ({a^T}xb)}}{{\partial x}} = a{b^T},{a_{m \times 1}},{b_{n \times 1}},{x_{m \times n}}$
- $\frac{{\partial ({a^T}{x^T}b)}}{{\partial x}} = b{a^T},{a_{m \times 1}},{b_{n \times 1}},{x_{m \times n}}$
- $\frac{{\partial ({a^T}x{x^T}b)}}{{\partial x}} = a{b^T}x + b{a^T}x,{a_{m \times 1}},{b_{m \times 1}},{x_{m \times m}}$
- $\frac{{\partial ({a^T}{x^T}xb)}}{{\partial x}} = xa{b^T} + xb{a^T},{a_{m \times 1}},{b_{m \times 1}},{x_{m \times m}}$

**矩阵的迹** tr(A)与一阶实矩阵微分dX
$$
A = \left[ {\left. {\begin{array}{*{20}{c}}
  {{a_{11}}}&{{a_{12}}}&{...}&{{a_{1n}}} \\ 
  {{a_{21}}}&{{a_{22}}}&{...}&{{a_{2n}}} \\ 
  {...}&{...}&{...}&{...} \\ 
  {{a_{n1}}}&{{a_{n2}}}&{...}&{{a_{nn}}} 
\end{array}} \right]} \right.
$$
矩阵的迹：$tr(A) = {a_{11}} + {a_{22}} +  \cdot  \cdot  \cdot  + {a_{nn}} = \sum\limits_{i = 1}^n {{a_{ii}}}$
只有**方阵**才有迹
交换律：$tr(AB) = tr(BA),{A_{m \times n}},{B_{n \times m}}$

**矩阵变元**的**实值标量函数**的**全微分**
$df(X) = tr(\frac{{\partial f(X)}}{{\partial {X^T}}}dX)$，$\frac{{\partial f(X)}}{{\partial {X^T}}} = {(\frac{{\partial f(X)}}{{\partial X}})^T}$
矩阵变元或向量变元的实值标量函数的**矩阵求导**的结果，都可以通过上式求解

使用**矩阵微分**求导：
对于实值标量函数$f(X),tr(f(X))=f(X),df(X)=tr(df(X))$,所以有$df(X)=tr(df(X))=d(trf(X))$
如果实值标量函数本身就是某个**矩阵函数**${F_{p \times p}}(X)$的迹，如$reF(X)$，则由全微分的线性法则得：
$d(tr{F_{p \times p}}(X)) = d(\sum\limits_{i = 1}^p {{f_{ii}}(X)} ) = \sum\limits_{i = 1}^p {d({f_{ii}}(X)) = tr(d{F_{p \times p}}(X))}$

常用的结论：
证明：$d\left| X \right| = \left| X \right|tr({X^{ - 1}}dX)$
$$
\begin{gathered}
  \left| X \right| = {x_{i1}}{A_{i1}} + {x_{i2}}{A_{i2}} + ... + {x_{in}}{A_{in}} \hfill \\
  \frac{{\partial \left| X \right|}}{{\partial {x_{ij}}}} = {A_{ij}} \hfill \\
  \frac{{\partial \left| X \right|}}{{\partial {X^T}}} = \left[ {\left. {\begin{array}{*{20}{c}}
  {{A_{11}}}&{{A_{21}}}&{...}&{{A_{n1}}} \\ 
  {{A_{12}}}&{{A_{22}}}&{...}&{{A_{n2}}} \\ 
  {...}&{...}&{...}&{...} \\ 
  {{A_{1n}}}&{{A_{2n}}}&{...}&{{A_{nn}}} 
\end{array}} \right]} \right. = {X^*} = \left| X \right|{X^{ - 1}} \hfill \\
  d\left| X \right| = tr(\frac{{\partial \left| X \right|}}{{\partial {X^T}}}dX) = tr(\left| X \right|{X^{ - 1}}dX) \hfill \\ 
\end{gathered} 
$$
$d({X^{ - 1}}) =  - {X^{ - 1}}dX({X^{ - 1}})$

## Hadamard哈达玛积(矩阵点乘)(Hadamard Product)
哈达玛积就是两个矩阵**对应位置的元素**相乘，布局不变。俗称**矩阵点乘**，符号是空心圆 ∘，两个矩阵的形状必须一样。

令A为在**不考虑**矩阵变元X是对称矩阵的前提下，得到的 Jacobian 矩阵
$$A = {\left[ {\left. {\matrix{
   {{{\partial f} \over {\partial {x_{11}}}}} & {{{\partial f} \over {\partial {x_{21}}}}} & {...} & {{{\partial f} \over {\partial {x_{n1}}}}}  \cr 
   {{{\partial f} \over {\partial {x_{12}}}}} & {{{\partial f} \over {\partial {x_{22}}}}} & {...} & {{{\partial f} \over {\partial {x_{n2}}}}}  \cr 
   {...} & {...} & {...} & {...}  \cr 
   {{{\partial f} \over {\partial {x_{1n}}}}} & {{{\partial f} \over {\partial {x_{2n}}}}} & {...} & {{{\partial f} \over {\partial {x_{nn}}}}}  \cr 

 } } \right]} \right._{n \times n}}$$
**对称矩阵变元的实值标量函数**的求导公式
$\frac{{\partial f(X)}}{{\partial {X_{n \times n}}}} = \frac{{\partial f(X)}}{{\partial X_{n \times n}^T}} = {A^T} + A - (A \circ E)$


设$x \sim {N_p}(\mu ,\sum ),\sum  > 0$，$\sum$为**正定**的协方差矩阵，则x的概率密度函数为
$f(x) = \frac{1}{{{{(2\pi )}^{\frac{p}{2}}}{{\left| \sum  \right|}^{\frac{1}{2}}}}}{e^{ - \frac{1}{2}{{(x - \mu )}^T}{\sum ^{ - 1}}(x - \mu )}}$
对数似然函数：$\ln L(\mu ,\sum ) = \ln [\prod\limits_{i = 1}^n {f({x_i})} ] =  - \frac{p}{2}n\ln (2\pi ) - \frac{1}{2}n\ln \left| \sum  \right| - \frac{1}{2}\sum\limits_{i = 1}^n {[{{({x_i} - \mu )}^T}{\sum ^{ - 1}}({x_i} - \mu )]}$
求导：$\frac{{\partial (\ln L(\mu ,\sum ))}}{{\partial \mu }} = {\sum ^{ - 1}}\sum\limits_{i = 1}^n {({x_i} - \mu )}$
$\frac{{\partial (\ln L(\mu ,\sum ))}}{{\partial \sum }} = {\sum ^{ - 1}}(\sum\limits_{i = 1}^n {[({x_i} - \mu ){{({x_i} - \mu )}^T}]} ){\sum ^{ - 1}} - n{\sum ^{ - 1}} - \{ [\frac{1}{2}({\sum ^{ - 1}}(\sum\limits_{i = 1}^n {[({x_i} - \mu ){{({x_i} - \mu )}^T}]} ){\sum ^{ - 1}} - n{\sum ^{ - 1}}] \circ E\}$
令导数为零，得：
$$
\begin{gathered}
  \mu  = \overline x  = \frac{1}{n}\sum\limits_{i = 1}^n {{x_i}}  \hfill \\
  \sum  = \frac{1}{n}\sum\limits_{i = 1}^n {[({x_i} - } \overline x ){({x_i} - \overline x )^T}] \hfill \\ 
\end{gathered} 
$$

## 矩阵内积 (Inner Product of Matrices)
符号：⟨ . , . ⟩
目的：度量长度。
定义：列向量a \mathbf{a}a与行向量b \mathbf{b}b的内积是指：组成a \mathbf{a}a的第一个元素与组成b \mathbf{b}b的第一个元素的乘积，依次，m个这样的乘积的加和。例如，
$$
<\mathbf{a}，\mathbf{b}>=a_{1}b_{1}+a_{2}b_{2}​
$$
 

矩阵$\mathbf{A}$与矩阵$\mathbf{B}$的内积是指：组成$\mathbf{A}$的第一个向量与组成$\mathbf{B}$的第一个向量的内积，依次，m个这样的内积的加和。
$$<\mathbf{A}，\mathbf{B}>=\sum^n_{i=1}\sum^n_{j=1}a_{ij}*b_{ij}$$

克罗内克积（Kronecker Product ）
符号：⊗
LeTex: \\otimes
定义：克罗内克积是两个任意大小的矩阵间的运算，它是张量积的特殊形式。给定$\boldsymbol{A}$和$\boldsymbol{B}$，则$\boldsymbol{A}$和$\boldsymbol{B}$的克罗内克积是一个在空间$\mathbb{R}^{\mathrm{mp}\times\mathrm{nq}}$的分块矩阵：
$$
\left.A\otimes B=\left[\begin{array}{ccc}\mathrm{a}_{11}B&\cdots&\mathrm{a}_{1\mathrm{n}}B\\\vdots&\ddots&\vdots\\\mathrm{a}_{\mathrm{m}1}B&\cdots&\mathrm{a}_{\mathrm{mn}}B\end{array}\right.\right]
$$
