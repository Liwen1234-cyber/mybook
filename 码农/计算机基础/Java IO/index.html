<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-码农/计算机基础/Java IO" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.7.0">
<title data-rh="true">Java IO | Coisini</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://doc.middiy.top/码农/计算机基础/Java IO/"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Java IO | Coisini"><meta data-rh="true" name="description" content="* Java IO"><meta data-rh="true" property="og:description" content="* Java IO"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://doc.middiy.top/码农/计算机基础/Java IO/"><link data-rh="true" rel="alternate" href="https://doc.middiy.top/码农/计算机基础/Java IO/" hreflang="en"><link data-rh="true" rel="alternate" href="https://doc.middiy.top/码农/计算机基础/Java IO/" hreflang="x-default"><meta name="google-site-verification" content="1FUPX6Qo4y3ecU623ShEurhgnjhSTjK49rRMhEDlzFA">
<link rel="stylesheet" href="/katex/katex.min.css">
<script src="/js/matomo.js" async defer="defer"></script><link rel="stylesheet" href="/assets/css/styles.53ea8373.css">
<script src="/assets/js/runtime~main.5917763a.js" defer="defer"></script>
<script src="/assets/js/main.130e24e2.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/img/logo.svg" alt="Chialisp Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div><b class="navbar__title text--truncate">Coisini</b></a></div><div class="navbar__items navbar__items--right"><a href="https://minddiy.top" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Main site<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite" aria-pressed="false"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"><div class="navbar__search searchBarContainer_NW3z" dir="ltr"><input placeholder="Search" aria-label="Search" class="navbar__search-input" value=""><div class="loadingRing_RJI3 searchBarLoadingRing_YnHq"><div></div><div></div><div></div><div></div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><main class="docMainContainer_TBSr docMainContainerEnhanced_lQrH"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Java IO</h1></header>
<ul>
<li><a href="#java-io">Java IO</a>
<ul>
<li><a href="#%E4%B8%80%E6%A6%82%E8%A7%88">一、概览</a></li>
<li><a href="#%E4%BA%8C%E7%A3%81%E7%9B%98%E6%93%8D%E4%BD%9C">二、磁盘操作</a></li>
<li><a href="#%E4%B8%89%E5%AD%97%E8%8A%82%E6%93%8D%E4%BD%9C">三、字节操作</a>
<ul>
<li><a href="#%E5%AE%9E%E7%8E%B0%E6%96%87%E4%BB%B6%E5%A4%8D%E5%88%B6">实现文件复制</a></li>
<li><a href="#%E8%A3%85%E9%A5%B0%E8%80%85%E6%A8%A1%E5%BC%8F">装饰者模式</a></li>
</ul>
</li>
<li><a href="#%E5%9B%9B%E5%AD%97%E7%AC%A6%E6%93%8D%E4%BD%9C">四、字符操作</a>
<ul>
<li><a href="#%E7%BC%96%E7%A0%81%E4%B8%8E%E8%A7%A3%E7%A0%81">编码与解码</a></li>
<li><a href="#string-%E7%9A%84%E7%BC%96%E7%A0%81%E6%96%B9%E5%BC%8F">String 的编码方式</a></li>
<li><a href="#reader-%E4%B8%8E-writer">Reader 与 Writer</a></li>
<li><a href="#%E5%AE%9E%E7%8E%B0%E9%80%90%E8%A1%8C%E8%BE%93%E5%87%BA%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E7%9A%84%E5%86%85%E5%AE%B9">实现逐行输出文本文件的内容</a></li>
</ul>
</li>
<li><a href="#%E4%BA%94%E5%AF%B9%E8%B1%A1%E6%93%8D%E4%BD%9C">五、对象操作</a>
<ul>
<li><a href="#%E5%BA%8F%E5%88%97%E5%8C%96">序列化</a></li>
<li><a href="#serializable">Serializable</a></li>
<li><a href="#transient">transient</a></li>
</ul>
</li>
<li><a href="#%E5%85%AD%E7%BD%91%E7%BB%9C%E6%93%8D%E4%BD%9C">六、网络操作</a>
<ul>
<li><a href="#inetaddress">InetAddress</a></li>
<li><a href="#url">URL</a></li>
<li><a href="#sockets">Sockets</a></li>
<li><a href="#datagram">Datagram</a></li>
</ul>
</li>
<li><a href="#%E4%B8%83nio">七、NIO</a>
<ul>
<li><a href="#%E6%B5%81%E4%B8%8E%E5%9D%97">流与块</a></li>
<li><a href="#%E9%80%9A%E9%81%93%E4%B8%8E%E7%BC%93%E5%86%B2%E5%8C%BA">通道与缓冲区</a></li>
<li><a href="#%E7%BC%93%E5%86%B2%E5%8C%BA%E7%8A%B6%E6%80%81%E5%8F%98%E9%87%8F">缓冲区状态变量</a></li>
<li><a href="#%E6%96%87%E4%BB%B6-nio-%E5%AE%9E%E4%BE%8B">文件 NIO 实例</a></li>
<li><a href="#%E9%80%89%E6%8B%A9%E5%99%A8">选择器</a></li>
<li><a href="#%E5%A5%97%E6%8E%A5%E5%AD%97-nio-%E5%AE%9E%E4%BE%8B">套接字 NIO 实例</a></li>
<li><a href="#%E5%86%85%E5%AD%98%E6%98%A0%E5%B0%84%E6%96%87%E4%BB%B6">内存映射文件</a></li>
<li><a href="#%E5%AF%B9%E6%AF%94">对比</a></li>
</ul>
</li>
<li><a href="#%E5%85%AB%E5%8F%82%E8%80%83%E8%B5%84%E6%96%99">八、参考资料</a></li>
</ul>
</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="一概览">一、概览<a href="#一概览" class="hash-link" aria-label="Direct link to 一、概览" title="Direct link to 一、概览">​</a></h2>
<p>Java 的 I/O 大概可以分成以下几类：</p>
<ul>
<li>磁盘操作：File</li>
<li>字节操作：InputStream 和 OutputStream</li>
<li>字符操作：Reader 和 Writer</li>
<li>对象操作：Serializable</li>
<li>网络操作：Socket</li>
<li>新的输入/输出：NIO</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="二磁盘操作">二、磁盘操作<a href="#二磁盘操作" class="hash-link" aria-label="Direct link to 二、磁盘操作" title="Direct link to 二、磁盘操作">​</a></h2>
<p>File 类可以用于表示文件和目录的信息，但是它不表示文件的内容。</p>
<p>递归地列出一个目录下所有文件：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public static void listAllFiles(File dir) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    if (dir == null || !dir.exists()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    if (dir.isFile()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        System.out.println(dir.getName());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    for (File file : dir.listFiles()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        listAllFiles(file);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>从 Java7 开始，可以使用 Paths 和 Files 代替 File。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="三字节操作">三、字节操作<a href="#三字节操作" class="hash-link" aria-label="Direct link to 三、字节操作" title="Direct link to 三、字节操作">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实现文件复制">实现文件复制<a href="#实现文件复制" class="hash-link" aria-label="Direct link to 实现文件复制" title="Direct link to 实现文件复制">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public static void copyFile(String src, String dist) throws IOException {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    FileInputStream in = new FileInputStream(src);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    FileOutputStream out = new FileOutputStream(dist);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    byte[] buffer = new byte[20 * 1024];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    int cnt;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // read() 最多读取 buffer.length 个字节</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // 返回的是实际读取的个数</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // 返回 -1 的时候表示读到 eof，即文件尾</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    while ((cnt = in.read(buffer, 0, buffer.length)) != -1) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        out.write(buffer, 0, cnt);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    in.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    out.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="装饰者模式">装饰者模式<a href="#装饰者模式" class="hash-link" aria-label="Direct link to 装饰者模式" title="Direct link to 装饰者模式">​</a></h3>
<p>Java I/O 使用了装饰者模式来实现。以 InputStream 为例，</p>
<ul>
<li>InputStream 是抽象组件；</li>
<li>FileInputStream 是 InputStream 的子类，属于具体组件，提供了字节流的输入操作；</li>
<li>FilterInputStream 属于抽象装饰者，装饰者用于装饰组件，为组件提供额外的功能。例如 BufferedInputStream 为 FileInputStream 提供缓存的功能。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/9709694b-db05-4cce-8d2f-1c8b09f4d921-aca6bf08c608019a05f6f5b9985f71ba.png" width="1225" height="499" class="img_ev3q"></p>
<p>实例化一个具有缓存功能的字节流对象时，只需要在 FileInputStream 对象上再套一层 BufferedInputStream 对象即可。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">FileInputStream fileInputStream = new FileInputStream(filePath);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">BufferedInputStream bufferedInputStream = new BufferedInputStream(fileInputStream);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>DataInputStream 装饰者提供了对更多数据类型进行输入的操作，比如 int、double 等基本类型。</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="四字符操作">四、字符操作<a href="#四字符操作" class="hash-link" aria-label="Direct link to 四、字符操作" title="Direct link to 四、字符操作">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="编码与解码">编码与解码<a href="#编码与解码" class="hash-link" aria-label="Direct link to 编码与解码" title="Direct link to 编码与解码">​</a></h3>
<p>编码就是把字符转换为字节，而解码是把字节重新组合成字符。</p>
<p>如果编码和解码过程使用不同的编码方式那么就出现了乱码。</p>
<ul>
<li>GBK 编码中，中文字符占 2 个字节，英文字符占 1 个字节；</li>
<li>UTF-8 编码中，中文字符占 3 个字节，英文字符占 1 个字节；</li>
<li>UTF-16be 编码中，中文字符和英文字符都占 2 个字节。</li>
</ul>
<p>UTF-16be 中的 be 指的是 Big Endian，也就是大端。相应地也有 UTF-16le，le 指的是 Little Endian，也就是小端。</p>
<p>Java 的内存编码使用双字节编码 UTF-16be，这不是指 Java 只支持这一种编码方式，而是说 char 这种类型使用 UTF-16be 进行编码。char 类型占 16 位，也就是两个字节，Java 使用这种双字节编码是为了让一个中文或者一个英文都能使用一个 char 来存储。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="string-的编码方式">String 的编码方式<a href="#string-的编码方式" class="hash-link" aria-label="Direct link to String 的编码方式" title="Direct link to String 的编码方式">​</a></h3>
<p>String 可以看成一个字符序列，可以指定一个编码方式将它编码为字节序列，也可以指定一个编码方式将一个字节序列解码为 String。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">String str1 = &quot;中文&quot;;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">byte[] bytes = str1.getBytes(&quot;UTF-8&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">String str2 = new String(bytes, &quot;UTF-8&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">System.out.println(str2);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>在调用无参数 getBytes() 方法时，默认的编码方式不是 UTF-16be。双字节编码的好处是可以使用一个 char 存储中文和英文，而将 String 转为 bytes[] 字节数组就不再需要这个好处，因此也就不再需要双字节编码。getBytes() 的默认编码方式与平台有关，一般为 UTF-8。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">byte[] bytes = str1.getBytes();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="reader-与-writer">Reader 与 Writer<a href="#reader-与-writer" class="hash-link" aria-label="Direct link to Reader 与 Writer" title="Direct link to Reader 与 Writer">​</a></h3>
<p>不管是磁盘还是网络传输，最小的存储单元都是字节，而不是字符。但是在程序中操作的通常是字符形式的数据，因此需要提供对字符进行操作的方法。</p>
<ul>
<li>InputStreamReader 实现从字节流解码成字符流；</li>
<li>OutputStreamWriter 实现字符流编码成为字节流。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="实现逐行输出文本文件的内容">实现逐行输出文本文件的内容<a href="#实现逐行输出文本文件的内容" class="hash-link" aria-label="Direct link to 实现逐行输出文本文件的内容" title="Direct link to 实现逐行输出文本文件的内容">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public static void readFileContent(String filePath) throws IOException {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    FileReader fileReader = new FileReader(filePath);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    BufferedReader bufferedReader = new BufferedReader(fileReader);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    String line;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    while ((line = bufferedReader.readLine()) != null) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        System.out.println(line);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // 装饰者模式使得 BufferedReader 组合了一个 Reader 对象</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // 在调用 BufferedReader 的 close() 方法时会去调用 Reader 的 close() 方法</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    // 因此只要一个 close() 调用即可</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    bufferedReader.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="五对象操作">五、对象操作<a href="#五对象操作" class="hash-link" aria-label="Direct link to 五、对象操作" title="Direct link to 五、对象操作">​</a></h2>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="序列化">序列化<a href="#序列化" class="hash-link" aria-label="Direct link to 序列化" title="Direct link to 序列化">​</a></h3>
<p>序列化就是将一个对象转换成字节序列，方便存储和传输。</p>
<ul>
<li>序列化：ObjectOutputStream.writeObject()</li>
<li>反序列化：ObjectInputStream.readObject()</li>
</ul>
<p>不会对静态变量进行序列化，因为序列化只是保存对象的状态，静态变量属于类的状态。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="serializable">Serializable<a href="#serializable" class="hash-link" aria-label="Direct link to Serializable" title="Direct link to Serializable">​</a></h3>
<p>序列化的类需要实现 Serializable 接口，它只是一个标准，没有任何方法需要实现，但是如果不去实现它的话而进行序列化，会抛出异常。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public static void main(String[] args) throws IOException, ClassNotFoundException {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    A a1 = new A(123, &quot;abc&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    String objectFile = &quot;file/a1&quot;;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ObjectOutputStream objectOutputStream = new ObjectOutputStream(new FileOutputStream(objectFile));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    objectOutputStream.writeObject(a1);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    objectOutputStream.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ObjectInputStream objectInputStream = new ObjectInputStream(new FileInputStream(objectFile));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    A a2 = (A) objectInputStream.readObject();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    objectInputStream.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    System.out.println(a2);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">private static class A implements Serializable {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private int x;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private String y;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    A(int x, String y) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        this.x = x;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        this.y = y;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    @Override</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public String toString() {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return &quot;x = &quot; + x + &quot;  &quot; + &quot;y = &quot; + y;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="transient">transient<a href="#transient" class="hash-link" aria-label="Direct link to transient" title="Direct link to transient">​</a></h3>
<p>transient 关键字可以使一些属性不会被序列化。</p>
<p>ArrayList 中存储数据的数组 elementData 是用 transient 修饰的，因为这个数组是动态扩展的，并不是所有的空间都被使用，因此就不需要所有的内容都被序列化。通过重写序列化和反序列化方法，使得可以只序列化数组中有内容的那部分数据。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">private transient Object[] elementData;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="六网络操作">六、网络操作<a href="#六网络操作" class="hash-link" aria-label="Direct link to 六、网络操作" title="Direct link to 六、网络操作">​</a></h2>
<p>Java 中的网络支持：</p>
<ul>
<li>InetAddress：用于表示网络上的硬件资源，即 IP 地址；</li>
<li>URL：统一资源定位符；</li>
<li>Sockets：使用 TCP 协议实现网络通信；</li>
<li>Datagram：使用 UDP 协议实现网络通信。</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="inetaddress">InetAddress<a href="#inetaddress" class="hash-link" aria-label="Direct link to InetAddress" title="Direct link to InetAddress">​</a></h3>
<p>没有公有的构造函数，只能通过静态方法来创建实例。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">InetAddress.getByName(String host);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">InetAddress.getByAddress(byte[] address);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="url">URL<a href="#url" class="hash-link" aria-label="Direct link to URL" title="Direct link to URL">​</a></h3>
<p>可以直接从 URL 中读取字节流数据。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    URL url = new URL(&quot;http://www.baidu.com&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /* 字节流 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    InputStream is = url.openStream();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /* 字符流 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    InputStreamReader isr = new InputStreamReader(is, &quot;utf-8&quot;);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /* 提供缓存功能 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    BufferedReader br = new BufferedReader(isr);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    String line;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    while ((line = br.readLine()) != null) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        System.out.println(line);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    br.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="sockets">Sockets<a href="#sockets" class="hash-link" aria-label="Direct link to Sockets" title="Direct link to Sockets">​</a></h3>
<ul>
<li>ServerSocket：服务器端类</li>
<li>Socket：客户端类</li>
<li>服务器和客户端通过 InputStream 和 OutputStream 进行输入输出。</li>
</ul>
<p><img decoding="async" loading="lazy" src="/assets/images/1e6affc4-18e5-4596-96ef-fb84c63bf88a-28e2ec8bd27990623048ccf31bc0e33e.png" width="897" height="561" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="datagram">Datagram<a href="#datagram" class="hash-link" aria-label="Direct link to Datagram" title="Direct link to Datagram">​</a></h3>
<ul>
<li>DatagramSocket：通信类</li>
<li>DatagramPacket：数据包类</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="七nio">七、NIO<a href="#七nio" class="hash-link" aria-label="Direct link to 七、NIO" title="Direct link to 七、NIO">​</a></h2>
<p>新的输入/输出 (NIO) 库是在 JDK 1.4 中引入的，弥补了原来的 I/O 的不足，提供了高速的、面向块的 I/O。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="流与块">流与块<a href="#流与块" class="hash-link" aria-label="Direct link to 流与块" title="Direct link to 流与块">​</a></h3>
<p>I/O 与 NIO 最重要的区别是数据打包和传输的方式，I/O 以流的方式处理数据，而 NIO 以块的方式处理数据。</p>
<p>面向流的 I/O 一次处理一个字节数据：一个输入流产生一个字节数据，一个输出流消费一个字节数据。为流式数据创建过滤器非常容易，链接几个过滤器，以便每个过滤器只负责复杂处理机制的一部分。不利的一面是，面向流的 I/O 通常相当慢。</p>
<p>面向块的 I/O 一次处理一个数据块，按块处理数据比按流处理数据要快得多。但是面向块的 I/O 缺少一些面向流的 I/O 所具有的优雅性和简单性。</p>
<p>I/O 包和 NIO 已经很好地集成了，java.io.* 已经以 NIO 为基础重新实现了，所以现在它可以利用 NIO 的一些特性。例如，java.io.* 包中的一些类包含以块的形式读写数据的方法，这使得即使在面向流的系统中，处理速度也会更快。</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="通道与缓冲区">通道与缓冲区<a href="#通道与缓冲区" class="hash-link" aria-label="Direct link to 通道与缓冲区" title="Direct link to 通道与缓冲区">​</a></h3>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-通道">1. 通道<a href="#1-通道" class="hash-link" aria-label="Direct link to 1. 通道" title="Direct link to 1. 通道">​</a></h4>
<p>通道 Channel 是对原 I/O 包中的流的模拟，可以通过它读取和写入数据。</p>
<p>通道与流的不同之处在于，流只能在一个方向上移动(一个流必须是 InputStream 或者 OutputStream 的子类)，而通道是双向的，可以用于读、写或者同时用于读写。</p>
<p>通道包括以下类型：</p>
<ul>
<li>FileChannel：从文件中读写数据；</li>
<li>DatagramChannel：通过 UDP 读写网络中数据；</li>
<li>SocketChannel：通过 TCP 读写网络中数据；</li>
<li>ServerSocketChannel：可以监听新进来的 TCP 连接，对每一个新进来的连接都会创建一个 SocketChannel。</li>
</ul>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-缓冲区">2. 缓冲区<a href="#2-缓冲区" class="hash-link" aria-label="Direct link to 2. 缓冲区" title="Direct link to 2. 缓冲区">​</a></h4>
<p>发送给一个通道的所有数据都必须首先放到缓冲区中，同样地，从通道中读取的任何数据都要先读到缓冲区中。也就是说，不会直接对通道进行读写数据，而是要先经过缓冲区。</p>
<p>缓冲区实质上是一个数组，但它不仅仅是一个数组。缓冲区提供了对数据的结构化访问，而且还可以跟踪系统的读/写进程。</p>
<p>缓冲区包括以下类型：</p>
<ul>
<li>ByteBuffer</li>
<li>CharBuffer</li>
<li>ShortBuffer</li>
<li>IntBuffer</li>
<li>LongBuffer</li>
<li>FloatBuffer</li>
<li>DoubleBuffer</li>
</ul>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="缓冲区状态变量">缓冲区状态变量<a href="#缓冲区状态变量" class="hash-link" aria-label="Direct link to 缓冲区状态变量" title="Direct link to 缓冲区状态变量">​</a></h3>
<ul>
<li>capacity：最大容量；</li>
<li>position：当前已经读写的字节数；</li>
<li>limit：还可以读写的字节数。</li>
</ul>
<p>状态变量的改变过程举例：</p>
<p>① 新建一个大小为 8 个字节的缓冲区，此时 position 为 0，而 limit = capacity = 8。capacity 变量不会改变，下面的讨论会忽略它。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="552" height="186" class="img_ev3q"></p>
<p>② 从输入通道中读取 5 个字节数据写入缓冲区中，此时 position 为 5，limit 保持不变。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="496" height="148" class="img_ev3q"></p>
<p>③ 在将缓冲区的数据写到输出通道之前，需要先调用 flip() 方法，这个方法将 limit 设置为当前 position，并将 position 设置为 0。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="549" height="146" class="img_ev3q"></p>
<p>④ 从缓冲区中取 4 个字节到输出缓冲中，此时 position 设为 4。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="527" height="158" class="img_ev3q"></p>
<p>⑤ 最后需要调用 clear() 方法来清空缓冲区，此时 position 和 limit 都被设置为最初位置。</p>
<p><img decoding="async" loading="lazy" src="data:image/png;base64,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" width="462" height="151" class="img_ev3q"></p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="文件-nio-实例">文件 NIO 实例<a href="#文件-nio-实例" class="hash-link" aria-label="Direct link to 文件 NIO 实例" title="Direct link to 文件 NIO 实例">​</a></h3>
<p>以下展示了使用 NIO 快速复制文件的实例：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public static void fastCopy(String src, String dist) throws IOException {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /* 获得源文件的输入字节流 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    FileInputStream fin = new FileInputStream(src);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /* 获取输入字节流的文件通道 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    FileChannel fcin = fin.getChannel();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /* 获取目标文件的输出字节流 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    FileOutputStream fout = new FileOutputStream(dist);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /* 获取输出字节流的文件通道 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    FileChannel fcout = fout.getChannel();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    /* 为缓冲区分配 1024 个字节 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    ByteBuffer buffer = ByteBuffer.allocateDirect(1024);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    while (true) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /* 从输入通道中读取数据到缓冲区中 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        int r = fcin.read(buffer);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /* read() 返回 -1 表示 EOF */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if (r == -1) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            break;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /* 切换读写 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        buffer.flip();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /* 把缓冲区的内容写入输出文件中 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        fcout.write(buffer);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        /* 清空缓冲区 */</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        buffer.clear();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="选择器">选择器<a href="#选择器" class="hash-link" aria-label="Direct link to 选择器" title="Direct link to 选择器">​</a></h3>
<p>NIO 常常被叫做非阻塞 IO，主要是因为 NIO 在网络通信中的非阻塞特性被广泛使用。</p>
<p>NIO 实现了 IO 多路复用中的 Reactor 模型，一个线程 Thread 使用一个选择器 Selector 通过轮询的方式去监听多个通道 Channel 上的事件，从而让一个线程就可以处理多个事件。</p>
<p>通过配置监听的通道 Channel 为非阻塞，那么当 Channel 上的 IO 事件还未到达时，就不会进入阻塞状态一直等待，而是继续轮询其它 Channel，找到 IO 事件已经到达的 Channel 执行。</p>
<p>因为创建和切换线程的开销很大，因此使用一个线程来处理多个事件而不是一个线程处理一个事件，对于 IO 密集型的应用具有很好地性能。</p>
<p>应该注意的是，只有套接字 Channel 才能配置为非阻塞，而 FileChannel 不能，为 FileChannel 配置非阻塞也没有意义。</p>
<p><img decoding="async" loading="lazy" src="/assets/images/093f9e57-429c-413a-83ee-c689ba596cef-4a04c62c7efa5052c73c47dbcd5ec095.png" width="620" height="430" class="img_ev3q"></p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="1-创建选择器">1. 创建选择器<a href="#1-创建选择器" class="hash-link" aria-label="Direct link to 1. 创建选择器" title="Direct link to 1. 创建选择器">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Selector selector = Selector.open();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="2-将通道注册到选择器上">2. 将通道注册到选择器上<a href="#2-将通道注册到选择器上" class="hash-link" aria-label="Direct link to 2. 将通道注册到选择器上" title="Direct link to 2. 将通道注册到选择器上">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ServerSocketChannel ssChannel = ServerSocketChannel.open();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ssChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">ssChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>通道必须配置为非阻塞模式，否则使用选择器就没有任何意义了，因为如果通道在某个事件上被阻塞，那么服务器就不能响应其它事件，必须等待这个事件处理完毕才能去处理其它事件，显然这和选择器的作用背道而驰。</p>
<p>在将通道注册到选择器上时，还需要指定要注册的具体事件，主要有以下几类：</p>
<ul>
<li>SelectionKey.OP_CONNECT</li>
<li>SelectionKey.OP_ACCEPT</li>
<li>SelectionKey.OP_READ</li>
<li>SelectionKey.OP_WRITE</li>
</ul>
<p>它们在 SelectionKey 的定义如下：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public static final int OP_READ = 1 &lt;&lt; 0;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public static final int OP_WRITE = 1 &lt;&lt; 2;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public static final int OP_CONNECT = 1 &lt;&lt; 3;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public static final int OP_ACCEPT = 1 &lt;&lt; 4;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>可以看出每个事件可以被当成一个位域，从而组成事件集整数。例如：</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">int interestSet = SelectionKey.OP_READ | SelectionKey.OP_WRITE;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="3-监听事件">3. 监听事件<a href="#3-监听事件" class="hash-link" aria-label="Direct link to 3. 监听事件" title="Direct link to 3. 监听事件">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">int num = selector.select();</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<p>使用 select() 来监听到达的事件，它会一直阻塞直到有至少一个事件到达。</p>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="4-获取到达的事件">4. 获取到达的事件<a href="#4-获取到达的事件" class="hash-link" aria-label="Direct link to 4. 获取到达的事件" title="Direct link to 4. 获取到达的事件">​</a></h4>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Set&lt;SelectionKey&gt; keys = selector.selectedKeys();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">Iterator&lt;SelectionKey&gt; keyIterator = keys.iterator();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">while (keyIterator.hasNext()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    SelectionKey key = keyIterator.next();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    if (key.isAcceptable()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        // ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    } else if (key.isReadable()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        // ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    keyIterator.remove();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h4 class="anchor anchorWithStickyNavbar_LWe7" id="5-事件循环">5. 事件循环<a href="#5-事件循环" class="hash-link" aria-label="Direct link to 5. 事件循环" title="Direct link to 5. 事件循环">​</a></h4>
<p>因为一次 select() 调用不能处理完所有的事件，并且服务器端有可能需要一直监听事件，因此服务器端处理事件的代码一般会放在一个死循环内。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">while (true) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    int num = selector.select();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    Set&lt;SelectionKey&gt; keys = selector.selectedKeys();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    Iterator&lt;SelectionKey&gt; keyIterator = keys.iterator();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    while (keyIterator.hasNext()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        SelectionKey key = keyIterator.next();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        if (key.isAcceptable()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            // ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        } else if (key.isReadable()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            // ...</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        keyIterator.remove();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="套接字-nio-实例">套接字 NIO 实例<a href="#套接字-nio-实例" class="hash-link" aria-label="Direct link to 套接字 NIO 实例" title="Direct link to 套接字 NIO 实例">​</a></h3>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class NIOServer {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Selector selector = Selector.open();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        ServerSocketChannel ssChannel = ServerSocketChannel.open();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        ssChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        ssChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        ServerSocket serverSocket = ssChannel.socket();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        InetSocketAddress address = new InetSocketAddress(&quot;127.0.0.1&quot;, 8888);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        serverSocket.bind(address);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            selector.select();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            Set&lt;SelectionKey&gt; keys = selector.selectedKeys();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            Iterator&lt;SelectionKey&gt; keyIterator = keys.iterator();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            while (keyIterator.hasNext()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                SelectionKey key = keyIterator.next();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                if (key.isAcceptable()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    ServerSocketChannel ssChannel1 = (ServerSocketChannel) key.channel();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    // 服务器会为每个新连接创建一个 SocketChannel</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    SocketChannel sChannel = ssChannel1.accept();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    sChannel.configureBlocking(false);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    // 这个新连接主要用于从客户端读取数据</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    sChannel.register(selector, SelectionKey.OP_READ);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                } else if (key.isReadable()) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    SocketChannel sChannel = (SocketChannel) key.channel();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    System.out.println(readDataFromSocketChannel(sChannel));</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                    sChannel.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                keyIterator.remove();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    private static String readDataFromSocketChannel(SocketChannel sChannel) throws IOException {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        ByteBuffer buffer = ByteBuffer.allocate(1024);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        StringBuilder data = new StringBuilder();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        while (true) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            buffer.clear();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            int n = sChannel.read(buffer);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            if (n == -1) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                break;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            buffer.flip();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            int limit = buffer.limit();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            char[] dst = new char[limit];</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            for (int i = 0; i &lt; limit; i++) {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">                dst[i] = (char) buffer.get(i);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            data.append(dst);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">            buffer.clear();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        return data.toString();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">public class NIOClient {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    public static void main(String[] args) throws IOException {</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        Socket socket = new Socket(&quot;127.0.0.1&quot;, 8888);</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        OutputStream out = socket.getOutputStream();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        String s = &quot;hello world&quot;;</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        out.write(s.getBytes());</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">        out.close();</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">    }</span><br></span><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="内存映射文件">内存映射文件<a href="#内存映射文件" class="hash-link" aria-label="Direct link to 内存映射文件" title="Direct link to 内存映射文件">​</a></h3>
<p>内存映射文件 I/O 是一种读和写文件数据的方法，它可以比常规的基于流或者基于通道的 I/O 快得多。</p>
<p>向内存映射文件写入可能是危险的，只是改变数组的单个元素这样的简单操作，就可能会直接修改磁盘上的文件。修改数据与将数据保存到磁盘是没有分开的。</p>
<p>下面代码行将文件的前 1024 个字节映射到内存中，map() 方法返回一个 MappedByteBuffer，它是 ByteBuffer 的子类。因此，可以像使用其他任何 ByteBuffer 一样使用新映射的缓冲区，操作系统会在需要时负责执行映射。</p>
<div class="language-java codeBlockContainer_Ckt0 theme-code-block" style="--prism-background-color:hsl(230, 1%, 98%);--prism-color:hsl(230, 8%, 24%)"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-java codeBlock_bY9V thin-scrollbar" style="background-color:hsl(230, 1%, 98%);color:hsl(230, 8%, 24%)"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:hsl(230, 8%, 24%)"><span class="token plain">MappedByteBuffer mbb = fc.map(FileChannel.MapMode.READ_WRITE, 0, 1024);</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg viewBox="0 0 24 24" class="copyButtonIcon_y97N"><path fill="currentColor" d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg viewBox="0 0 24 24" class="copyButtonSuccessIcon_LjdS"><path fill="currentColor" d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="对比">对比<a href="#对比" class="hash-link" aria-label="Direct link to 对比" title="Direct link to 对比">​</a></h3>
<p>NIO 与普通 I/O 的区别主要有以下两点：</p>
<ul>
<li>NIO 是非阻塞的；</li>
<li>NIO 面向块，I/O 面向流。</li>
</ul>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="八参考资料">八、参考资料<a href="#八参考资料" class="hash-link" aria-label="Direct link to 八、参考资料" title="Direct link to 八、参考资料">​</a></h2>
<ul>
<li>Eckel B, 埃克尔, 昊鹏, 等. Java 编程思想 [M]. 机械工业出版社, 2002.</li>
<li><a href="https://www.ibm.com/developerworks/cn/education/java/j-nio/j-nio.html" target="_blank" rel="noopener noreferrer">IBM: NIO 入门</a></li>
<li><a href="http://tutorials.jenkov.com/java-nio/index.html" target="_blank" rel="noopener noreferrer">Java NIO Tutorial</a></li>
<li><a href="https://tech.meituan.com/nio.html" target="_blank" rel="noopener noreferrer">Java NIO 浅析</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-javaio/index.html" target="_blank" rel="noopener noreferrer">IBM: 深入分析 Java I/O 的工作机制</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-chinesecoding/index.html" target="_blank" rel="noopener noreferrer">IBM: 深入分析 Java 中的中文编码问题</a></li>
<li><a href="https://www.ibm.com/developerworks/cn/java/j-lo-serial/index.html" target="_blank" rel="noopener noreferrer">IBM: Java 序列化的高级认识</a></li>
<li><a href="http://blog.csdn.net/shimiso/article/details/24990499" target="_blank" rel="noopener noreferrer">NIO 与传统 IO 的区别</a></li>
<li><a href="http://stg-tud.github.io/sedc/Lecture/ws13-14/5.3-Decorator.html#mode=document" target="_blank" rel="noopener noreferrer">Decorator Design Pattern</a></li>
<li><a href="http://labojava.blogspot.com/2012/12/socket-multicast.html" target="_blank" rel="noopener noreferrer">Socket Multicast</a></li>
</ul></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#一概览" class="table-of-contents__link toc-highlight">一、概览</a></li><li><a href="#二磁盘操作" class="table-of-contents__link toc-highlight">二、磁盘操作</a></li><li><a href="#三字节操作" class="table-of-contents__link toc-highlight">三、字节操作</a><ul><li><a href="#实现文件复制" class="table-of-contents__link toc-highlight">实现文件复制</a></li><li><a href="#装饰者模式" class="table-of-contents__link toc-highlight">装饰者模式</a></li></ul></li><li><a href="#四字符操作" class="table-of-contents__link toc-highlight">四、字符操作</a><ul><li><a href="#编码与解码" class="table-of-contents__link toc-highlight">编码与解码</a></li><li><a href="#string-的编码方式" class="table-of-contents__link toc-highlight">String 的编码方式</a></li><li><a href="#reader-与-writer" class="table-of-contents__link toc-highlight">Reader 与 Writer</a></li><li><a href="#实现逐行输出文本文件的内容" class="table-of-contents__link toc-highlight">实现逐行输出文本文件的内容</a></li></ul></li><li><a href="#五对象操作" class="table-of-contents__link toc-highlight">五、对象操作</a><ul><li><a href="#序列化" class="table-of-contents__link toc-highlight">序列化</a></li><li><a href="#serializable" class="table-of-contents__link toc-highlight">Serializable</a></li><li><a href="#transient" class="table-of-contents__link toc-highlight">transient</a></li></ul></li><li><a href="#六网络操作" class="table-of-contents__link toc-highlight">六、网络操作</a><ul><li><a href="#inetaddress" class="table-of-contents__link toc-highlight">InetAddress</a></li><li><a href="#url" class="table-of-contents__link toc-highlight">URL</a></li><li><a href="#sockets" class="table-of-contents__link toc-highlight">Sockets</a></li><li><a href="#datagram" class="table-of-contents__link toc-highlight">Datagram</a></li></ul></li><li><a href="#七nio" class="table-of-contents__link toc-highlight">七、NIO</a><ul><li><a href="#流与块" class="table-of-contents__link toc-highlight">流与块</a></li><li><a href="#通道与缓冲区" class="table-of-contents__link toc-highlight">通道与缓冲区</a></li><li><a href="#缓冲区状态变量" class="table-of-contents__link toc-highlight">缓冲区状态变量</a></li><li><a href="#文件-nio-实例" class="table-of-contents__link toc-highlight">文件 NIO 实例</a></li><li><a href="#选择器" class="table-of-contents__link toc-highlight">选择器</a></li><li><a href="#套接字-nio-实例" class="table-of-contents__link toc-highlight">套接字 NIO 实例</a></li><li><a href="#内存映射文件" class="table-of-contents__link toc-highlight">内存映射文件</a></li><li><a href="#对比" class="table-of-contents__link toc-highlight">对比</a></li></ul></li><li><a href="#八参考资料" class="table-of-contents__link toc-highlight">八、参考资料</a></li></ul></div></div></div></div></main></div></div></div></div>
</body>
</html>